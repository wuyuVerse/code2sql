# 20250714 - 增加调试模式参数

## 任务描述
在 `code2sql_reward.py` 和 `qwen2_14b_rf.yaml` 中增加一个参数，只有当该参数开启时才输出详细的 print 信息，避免在生产环境中产生过多的日志输出。

## 修改内容

### 1. 配置文件修改
**文件**: `config/rl/qwen/qwen2_14b_rf.yaml`

在 `custom_reward_function` 部分添加了调试模式开关：
```yaml
custom_reward_function:
  path: "/home/wuyu/code2sql/model/rl/code2sql_reward.py"
  name: "code2sql_reward"
  # 调试模式开关，true时输出详细日志，false时只输出关键信息
  debug_mode: false
```

### 2. 奖励函数修改
**文件**: `model/rl/code2sql_reward.py`

#### 2.1 添加调试模式支持
- 新增 `debug_print()` 函数，只有在调试模式下才输出日志
- 新增 `load_rl_config()` 函数，用于加载RL配置文件中的调试模式参数

#### 2.2 修改所有相关函数
为以下函数添加了 `debug_mode` 参数支持：
- `extract_tables_and_columns_with_llm()`
- `compare_extraction_results()`
- `evaluate_llm_extraction_reward()`
- `evaluate_sql_validity()`
- `format_and_llm_reward()`
- `compute_score()`
- `compute_score_batch()`
- `code2sql_reward()`

#### 2.3 替换所有print语句
将所有的 `print()` 和 `debug_print()` 调用都修改为支持调试模式参数，确保只有在 `debug_mode=True` 时才输出详细日志。

## 技术实现

### 调试模式控制机制
1. **配置加载**: 通过 `load_rl_config()` 函数从YAML配置文件中读取 `debug_mode` 参数
2. **参数传递**: 从主入口函数 `code2sql_reward()` 开始，将调试模式参数逐级传递给所有子函数
3. **条件输出**: 使用 `debug_print()` 函数替代原有的 `print()` 函数，只有在调试模式下才输出日志

### 向后兼容性
- 所有函数都保持了原有的参数签名，只是添加了可选的 `debug_mode` 参数
- 默认情况下 `debug_mode=False`，确保生产环境的静默运行
- 测试函数中启用了调试模式，便于开发调试

## 使用方式

### 生产环境（默认）
```yaml
custom_reward_function:
  debug_mode: false  # 不输出详细日志
```

### 调试环境
```yaml
custom_reward_function:
  debug_mode: true   # 输出详细日志
```

## 修改的文件列表

1. `config/rl/qwen/qwen2_14b_rf.yaml` - 添加调试模式配置
2. `model/rl/code2sql_reward.py` - 实现调试模式支持

## 影响范围

- **功能影响**: 无功能变化，只是增加了日志输出的控制
- **性能影响**: 关闭调试模式时减少了字符串处理和输出开销
- **兼容性**: 完全向后兼容，不影响现有调用方式

## 验证方法

1. 设置 `debug_mode: false` 运行，确认日志输出减少
2. 设置 `debug_mode: true` 运行，确认详细日志正常输出
3. 运行测试函数，确认调试模式正常工作

## 总结

本次修改成功实现了调试模式参数的功能，通过配置文件控制详细日志的输出，既保证了生产环境的清洁运行，又为开发调试提供了便利。修改采用了最小化变更原则，保持了代码的向后兼容性。 