[
  {
    "function_name": "Insert",
    "orm_code": "func (m *BillMode) Insert(log *logger.IvcLog) error {\n\tsql := fmt.Sprintf(InsertBillingModeSql, m.AppId, m.Uin, m.Date, m.Category, m.Mode)\n\terr := base.GetInstance().BillingDriver().Clauses(SqlComment(m.GeneralReq)...).Table(IvcBillingModeTable).Create(&m.BillingMode).Error\n\tif err != nil {\n\t\tlog.ErrorV(fmt.Sprintf(\"[Insert] BillingMode write db sql:%v err:%v\", sql, err))\n\t\treturn err\n\t}\n\tmodeInfo := types.BillingModeInfo{\n\t\tAppId:    m.AppId,\n\t\tDate:     m.Date,\n\t\tMode:     m.Mode,\n\t\tCategory: m.Category,\n\t}\n\tv, err := json.Marshal(modeInfo)\n\tif err != nil {\n\t\tlog.ErrorV(fmt.Sprintf(\"[Insert] BillingMode Marshal:%v err:%v\", modeInfo, err))\n\t\treturn err\n\t}\n\terr = base.GetInstance().Redis().Set(context.TODO(), fmt.Sprintf(UserBillingCategoryStrKey, m.AppId, m.Category), string(v), Timeout3Min).Err()\n\tif err != nil {\n\t\tlog.ErrorV(fmt.Sprintf(\"[Insert] BillingMode write cache err:%v\", err))\n\t\treturn err\n\t}\n\treturn nil\n}",
    "caller": "",
    "sql_statement_list": [
      "INSERT INTO ivc_billing_mode (app_id, uin, date, mode, category) VALUES (?, ?, ?, ?, ?);"
    ],
    "sql_types": [
      "INSERT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/model/quota.go",
        "code_start_line": 13,
        "code_end_line": 13,
        "code_key": "base",
        "code_value": "overview/internal/base",
        "code_label": null,
        "code_type": 4,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/model/quota.go",
        "code_start_line": 34,
        "code_end_line": 34,
        "code_key": "IvcBillingModeTable",
        "code_value": "const IvcBillingModeTable     = \"ivc_billing_mode\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/types/types.go",
        "code_start_line": 4,
        "code_end_line": 10,
        "code_key": "BillingMode",
        "code_value": "type BillingMode struct {\n\tAppId    int    `json:\"app_id,string\" gorm:\"column:app_id\"`\n\tUin      string `json:\"uin\" gorm:\"column:uin\"`\n\tDate     string `json:\"date\" gorm:\"column:date\"`\n\tMode     int    `json:\"mode,string\" gorm:\"column:mode\"`\n\tCategory int    `json:\"category,string\" gorm:\"column:category\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-overview.json"
  },
  {
    "function_name": "FindYesterdayBillingModeAppId",
    "orm_code": "func (m *BillMode) FindYesterdayBillingModeAppId() (*types.BillingMode, error) {\n\tvar mode types.BillingMode\n\t//sql := fmt.Sprintf(QueryYesterdayBillingModeByAppIdSql, m.AppId, m.Category, m.Date)\n\terr := base.GetInstance().BillingDriver().Clauses(SqlComment(m.GeneralReq)...).Select(\"date,category,mode\").Table(IvcBillingModeTable).Where(\"app_id = ? and category = ? and date < ?\", m.AppId, m.Category, m.Date).\n\t\tOrder(\"date desc\").First(&mode).Error\n\tif err != nil && err != gorm.ErrRecordNotFound {\n\t\treturn &mode, err\n\t}\n\n\treturn &mode, nil\n}",
    "caller": "",
    "sql_statement_list": [
      {
        "type": "param_dependent",
        "variants": [
          {
            "scenario": "查询指定app_id和category在指定日期之前的最新计费模式记录",
            "sql": "SELECT date,category,mode FROM ivc_billing_mode WHERE app_id = ? AND category = ? AND date < ? ORDER BY date DESC LIMIT 1;"
          }
        ]
      }
    ],
    "sql_types": [
      "PARAM_DEPENDENT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/model/quota.go",
        "code_start_line": 13,
        "code_end_line": 13,
        "code_key": "base",
        "code_value": "overview/internal/base",
        "code_label": null,
        "code_type": 4,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/model/quota.go",
        "code_start_line": 34,
        "code_end_line": 34,
        "code_key": "IvcBillingModeTable",
        "code_value": "const IvcBillingModeTable     = \"ivc_billing_mode\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/model/quota.go",
        "code_start_line": 89,
        "code_end_line": 89,
        "code_key": "mode",
        "code_value": "types.BillingMode",
        "code_label": null,
        "code_type": 31,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/types/types.go",
        "code_start_line": 4,
        "code_end_line": 10,
        "code_key": "BillingMode",
        "code_value": "type BillingMode struct {\n\tAppId    int    `json:\"app_id,string\" gorm:\"column:app_id\"`\n\tUin      string `json:\"uin\" gorm:\"column:uin\"`\n\tDate     string `json:\"date\" gorm:\"column:date\"`\n\tMode     int    `json:\"mode,string\" gorm:\"column:mode\"`\n\tCategory int    `json:\"category,string\" gorm:\"column:category\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-overview.json"
  },
  {
    "function_name": "FindBillingModeAppId",
    "orm_code": "func (m *BillMode) FindBillingModeAppId() (*types.BillingMode, error) {\n\tvar mode types.BillingMode\n\t//sql := fmt.Sprintf(QueryBillingModeByAppIdSql, m.AppId, m.Category)\n\terr := base.GetInstance().BillingDriver().Clauses(SqlComment(m.GeneralReq)...).Select(\"date,category,mode\").Table(IvcBillingModeTable).Where(\"app_id = ? and category = ? \", m.AppId, m.Category).\n\t\tOrder(\"date desc\").First(&mode).Error\n\tif err != nil && err != gorm.ErrRecordNotFound {\n\t\treturn &mode, err\n\t}\n\n\treturn &mode, nil\n}",
    "caller": "",
    "sql_statement_list": [
      "SELECT date, category, mode FROM ivc_billing_mode WHERE app_id = ? AND category = ? ORDER BY date DESC LIMIT 1;"
    ],
    "sql_types": [
      "SELECT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/model/quota.go",
        "code_start_line": 13,
        "code_end_line": 13,
        "code_key": "base",
        "code_value": "overview/internal/base",
        "code_label": null,
        "code_type": 4,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/model/quota.go",
        "code_start_line": 34,
        "code_end_line": 34,
        "code_key": "IvcBillingModeTable",
        "code_value": "const IvcBillingModeTable     = \"ivc_billing_mode\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/model/quota.go",
        "code_start_line": 101,
        "code_end_line": 101,
        "code_key": "mode",
        "code_value": "types.BillingMode",
        "code_label": null,
        "code_type": 31,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/types/types.go",
        "code_start_line": 4,
        "code_end_line": 10,
        "code_key": "BillingMode",
        "code_value": "type BillingMode struct {\n\tAppId    int    `json:\"app_id,string\" gorm:\"column:app_id\"`\n\tUin      string `json:\"uin\" gorm:\"column:uin\"`\n\tDate     string `json:\"date\" gorm:\"column:date\"`\n\tMode     int    `json:\"mode,string\" gorm:\"column:mode\"`\n\tCategory int    `json:\"category,string\" gorm:\"column:category\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-overview.json"
  },
  {
    "function_name": "FindQuotasByAppId",
    "orm_code": "func (q *Quota) FindQuotasByAppId(start, end string) ([]types.PostpayBill, error) {\n\tqs := make([]types.PostpayBill, 0)\n\t//sql := fmt.Sprintf(QueryQuotaByAppIdSql, q.AppId, start, end)\n\terr := base.GetInstance().BillingDriver().Clauses(SqlComment(q.GeneralReq)...).Select(\"date,field,sum(amount) as amounts \").Table(IssPostPaybillTable).Where(\"app_id = ? and date >=  ? and date <= ? \", q.AppId, start, end).\n\t\tGroup(\"date,field\").Find(&qs).Error\n\tif err != nil {\n\t\treturn nil, err\n\t}\n\n\treturn qs, nil\n}",
    "caller": "",
    "sql_statement_list": [
      "SELECT date, field, sum(amount) as amounts FROM iss_postpay_bill WHERE app_id = ? AND date >= ? AND date <= ? GROUP BY date, field;"
    ],
    "sql_types": [
      "SELECT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/model/quota.go",
        "code_start_line": 13,
        "code_end_line": 13,
        "code_key": "base",
        "code_value": "overview/internal/base",
        "code_label": null,
        "code_type": 4,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/model/quota.go",
        "code_start_line": 35,
        "code_end_line": 35,
        "code_key": "IssPostPaybillTable",
        "code_value": "const IssPostPaybillTable     = \"iss_postpay_bill\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/model/quota.go",
        "code_start_line": 152,
        "code_end_line": 152,
        "code_key": "qs",
        "code_value": "make([]types.PostpayBill, 0)",
        "code_label": null,
        "code_type": 35,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/types/types.go",
        "code_start_line": 175,
        "code_end_line": 180,
        "code_key": "PostpayBill",
        "code_value": "type PostpayBill struct {\n\tAppId   int     `json:\"app_id,string\" gorm:\"column:app_id\"`\n\tDate    string  `json:\"date\" gorm:\"column:date\"`\n\tField   string  `json:\"field\" gorm:\"column:field\"`\n\tAmounts float64 `json:\"amounts,string\" gorm:\"column:amounts\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-overview.json"
  },
  {
    "function_name": "FindStorageTypeByAppId",
    "orm_code": "func (q *Quota) FindStorageTypeByAppId() (*UserBucketWhitelist, error) {\n\tvar ubw UserBucketWhitelist\n\t//sql := fmt.Sprintf(QueryUserBucketWhitelistSql, q.AppId)\n\terr := base.GetInstance().Driver().Clauses(SqlComment(q.GeneralReq)...).Select(\"name,bucket_id,region,region_name\").Table(IvcBucketWhitelistTable).Where(\"app_id = ?\", q.AppId).First(&ubw).Error\n\tif err != nil && err != gorm.ErrRecordNotFound {\n\t\treturn &ubw, err\n\t}\n\n\treturn &ubw, nil\n}",
    "caller": "",
    "sql_statement_list": [
      "SELECT name, bucket_id, region, region_name FROM ivc_bucket_whitelist WHERE app_id = ? LIMIT 1;"
    ],
    "sql_types": [
      "SELECT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/model/quota.go",
        "code_start_line": 13,
        "code_end_line": 13,
        "code_key": "base",
        "code_value": "overview/internal/base",
        "code_label": null,
        "code_type": 4,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/model/quota.go",
        "code_start_line": 36,
        "code_end_line": 36,
        "code_key": "IvcBucketWhitelistTable",
        "code_value": "const IvcBucketWhitelistTable = \"ivc_bucket_whitelist\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/model/quota.go",
        "code_start_line": 164,
        "code_end_line": 164,
        "code_key": "ubw",
        "code_value": "UserBucketWhitelist",
        "code_label": null,
        "code_type": 31,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/types/types.go",
        "code_start_line": 284,
        "code_end_line": 289,
        "code_key": "UserBucketWhitelist",
        "code_value": "type UserBucketWhitelist struct {\n\tName       string `json:\"name\" gorm:\"column:name\"`\n\tBucketId   string `json:\"bucket_id\" gorm:\"column:bucket_id\"`\n\tRegion     string `json:\"region\" gorm:\"column:region\"`\n\tRegionName string `json:\"region_name\" gorm:\"column:region_name\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/model/quota.go",
        "code_start_line": 55,
        "code_end_line": 60,
        "code_key": "UserBucketWhitelist",
        "code_value": "type UserBucketWhitelist struct {\n\tName       string `json:\"name\"`\n\tBucketId   string `json:\"bucket_id\"`\n\tRegion     string `json:\"region\"`\n\tRegionName string `json:\"region_name\"`\n}",
        "code_label": null,
        "code_type": 3,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-overview.json"
  },
  {
    "function_name": "FindUserByAppId",
    "orm_code": "func (u *BillUser) FindUserByAppId() (int, error) {\n\tvar num int64\n\t//sql := fmt.Sprintf(QueryBillUserByAppIdSql, u.AppId)\n\terr := base.GetInstance().BillingDriver().Clauses(SqlComment(u.GeneralReq)...).Table(IssBillUserTable).Where(\"app_id = ?\", u.AppId).Count(&num).Error\n\tif err != nil {\n\t\treturn int(num), err\n\t}\n\n\treturn int(num), nil\n}",
    "caller": "",
    "sql_statement_list": [
      "SELECT count(*) FROM iss_traffic_bill_users WHERE app_id = ?;"
    ],
    "sql_types": [
      "SELECT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/model/quota.go",
        "code_start_line": 13,
        "code_end_line": 13,
        "code_key": "base",
        "code_value": "overview/internal/base",
        "code_label": null,
        "code_type": 4,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/model/quota.go",
        "code_start_line": 37,
        "code_end_line": 37,
        "code_key": "IssBillUserTable",
        "code_value": "const IssBillUserTable        = \"iss_traffic_bill_users\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/model/quota.go",
        "code_start_line": 251,
        "code_end_line": 251,
        "code_key": "num",
        "code_value": "int64",
        "code_label": null,
        "code_type": 31,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-overview.json"
  },
  {
    "function_name": "FindDeviceByAppId",
    "orm_code": "func (d *Device) FindDeviceByAppId() (*types.DeviceAmount, error) {\n\tvar typeDevs types.DeviceAmount\n\t//sql := fmt.Sprintf(QueryAccessDevByAppIdSql, d.AppId, d.AccessProtocol)\n\terr := base.GetInstance().Driver().Clauses(SqlComment(d.GeneralReq)...).Select(\"count(1) as total, count(IF(status=0,1,null)) as unregistered, count(IF(status=1,1,null)) as online,\"+\n\t\t\"count(IF(status=2,1,null)) as offline, count(IF(status=3,1,null)) as disable \").\n\t\tTable(IvcDeviceTable).Where(\"app_id=? and access_protocol=? and deleted_at is null\", d.AppId, d.AccessProtocol).Limit(1).Find(&typeDevs).Error\n\tif err != nil && err != gorm.ErrRecordNotFound {\n\t\treturn &typeDevs, err\n\t}\n\n\treturn &typeDevs, nil\n}",
    "caller": "",
    "sql_statement_list": [
      "SELECT count(1) as total, count(IF(status=0,1,null)) as unregistered, count(IF(status=1,1,null)) as online, count(IF(status=2,1,null)) as offline, count(IF(status=3,1,null)) as disable FROM ivc_device WHERE app_id=? and access_protocol=? and deleted_at is null LIMIT 1;"
    ],
    "sql_types": [
      "SELECT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/model/device.go",
        "code_start_line": 9,
        "code_end_line": 9,
        "code_key": "base",
        "code_value": "overview/internal/base",
        "code_label": null,
        "code_type": 4,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/model/device.go",
        "code_start_line": 23,
        "code_end_line": 23,
        "code_key": "IvcDeviceTable",
        "code_value": "const IvcDeviceTable           = \"ivc_device\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/model/device.go",
        "code_start_line": 116,
        "code_end_line": 116,
        "code_key": "typeDevs",
        "code_value": "types.DeviceAmount",
        "code_label": null,
        "code_type": 31,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/types/types.go",
        "code_start_line": 83,
        "code_end_line": 89,
        "code_key": "DeviceAmount",
        "code_value": "type DeviceAmount struct {\n\tTotal        int `json:\"total,string\" gorm:\"column:total\"`\n\tUnregistered int `json:\"unregistered,string\" gorm:\"column:unregistered\"` //0:未注册\n\tOnline       int `json:\"online,string\" gorm:\"column:online\"`             // 1:在线\n\tOffline      int `json:\"offline,string\" gorm:\"column:offline\"`           // 2:离线\n\tDisable      int `json:\"disable,string\" gorm:\"column:disable\"`           // 3:禁用\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-overview.json"
  },
  {
    "function_name": "FindChannelsByAppId",
    "orm_code": "func (d *Device) FindChannelsByAppId() (*types.ChannelAmount, error) {\n\tvar typeChannel types.ChannelAmount\n\t//sql := fmt.Sprintf(QueryAccessChannelByAppIdSql, d.AppId, d.AccessProtocol)\n\terr := base.GetInstance().Driver().Clauses(SqlComment(d.GeneralReq)...).Select(\"count(1) as total, count(IF(c.state=0,1,null)) as offline, count(IF(c.state=1,1,null)) as online \").\n\t\tTable(IvcChannelTable+\" as c \").Joins(\"left join ivc_device as d on c.device_id=d.id\").\n\t\tWhere(\"d.deleted_at is null and c.deleted_at is null and d.app_id = ? and d.access_protocol = ?\", d.AppId, d.AccessProtocol).Limit(1).Find(&typeChannel).Error\n\tif err != nil && err != gorm.ErrRecordNotFound {\n\t\treturn &typeChannel, err\n\t}\n\n\treturn &typeChannel, nil\n}",
    "caller": "",
    "sql_statement_list": [
      "SELECT count(1) as total, count(IF(c.state=0,1,null)) as offline, count(IF(c.state=1,1,null)) as online FROM ivc_channel as c LEFT JOIN ivc_device as d ON c.device_id = d.id WHERE d.deleted_at IS NULL AND c.deleted_at IS NULL AND d.app_id = ? AND d.access_protocol = ? LIMIT 1;"
    ],
    "sql_types": [
      "SELECT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/model/device.go",
        "code_start_line": 9,
        "code_end_line": 9,
        "code_key": "base",
        "code_value": "overview/internal/base",
        "code_label": null,
        "code_type": 4,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/model/device.go",
        "code_start_line": 24,
        "code_end_line": 24,
        "code_key": "IvcChannelTable",
        "code_value": "const IvcChannelTable          = \"ivc_channel\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/model/device.go",
        "code_start_line": 129,
        "code_end_line": 129,
        "code_key": "typeChannel",
        "code_value": "types.ChannelAmount",
        "code_label": null,
        "code_type": 31,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/types/types.go",
        "code_start_line": 31,
        "code_end_line": 35,
        "code_key": "ChannelAmount",
        "code_value": "type ChannelAmount struct {\n\tTotal   int `json:\"total,string\" gorm:\"column:total\"`\n\tOnline  int `json:\"online,string\" gorm:\"column:online\"`   // 1:在线\n\tOffline int `json:\"offline,string\" gorm:\"column:offline\"` // 2:离线\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-overview.json"
  },
  {
    "function_name": "FindOfflineChannelsByAppId",
    "orm_code": "func (d *Device) FindOfflineChannelsByAppId() ([]types.OfflineChannelAmount, error) {\n\ttypeOfflineChs := make([]types.OfflineChannelAmount, 0)\n\t//sql := fmt.Sprintf(QueryOfflineChannelByAppIdSql, d.AppId, d.AccessProtocol)\n\terr := base.GetInstance().Driver().Clauses(SqlComment(d.GeneralReq)...).Select(\"d.status, count(c.id) as amount \").Table(IvcChannelTable+\" as c\").\n\t\tJoins(\"left join \"+IvcDeviceTable+\" as d on c.device_id=d.id\").Where(\"d.deleted_at is null and c.deleted_at is null \"+\n\t\t\"and d.app_id = ? and d.access_protocol = ? \", d.AppId, d.AccessProtocol).Group(\"d.status\").Find(&typeOfflineChs).Error\n\tif err != nil {\n\t\treturn typeOfflineChs, err\n\t}\n\n\treturn typeOfflineChs, nil\n}",
    "caller": "",
    "sql_statement_list": [
      "SELECT d.status, count(c.id) as amount FROM ivc_channel as c LEFT JOIN ivc_device as d ON c.device_id = d.id WHERE d.deleted_at IS NULL AND c.deleted_at IS NULL AND d.app_id = ? AND d.access_protocol = ? GROUP BY d.status;"
    ],
    "sql_types": [
      "SELECT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/model/device.go",
        "code_start_line": 9,
        "code_end_line": 9,
        "code_key": "base",
        "code_value": "overview/internal/base",
        "code_label": null,
        "code_type": 4,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/model/device.go",
        "code_start_line": 24,
        "code_end_line": 24,
        "code_key": "IvcChannelTable",
        "code_value": "const IvcChannelTable          = \"ivc_channel\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/model/device.go",
        "code_start_line": 142,
        "code_end_line": 142,
        "code_key": "typeOfflineChs",
        "code_value": "make([]types.OfflineChannelAmount, 0)",
        "code_label": null,
        "code_type": 35,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/types/types.go",
        "code_start_line": 155,
        "code_end_line": 158,
        "code_key": "OfflineChannelAmount",
        "code_value": "type OfflineChannelAmount struct {\n\tStatus int `json:\"status,string\" gorm:\"column:status\"`\n\tAmount int `json:\"amount,string\" gorm:\"column:amount\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-overview.json"
  },
  {
    "function_name": "findCountsByAppId",
    "orm_code": "func (d *Device) findCountsByAppId() (int, error) {\n\tvar counts int64\n\terr := base.GetInstance().Driver().Clauses(SqlComment(d.GeneralReq)...).Table(IvcDeviceTable).Where(\"app_id = ? and deleted_at is null\", d.AppId).Count(&counts).Error\n\tif err != nil {\n\t\treturn int(counts), err\n\t}\n\treturn int(counts), nil\n}",
    "caller": "",
    "sql_statement_list": [
      "SELECT count(*) FROM ivc_device WHERE app_id = ? AND deleted_at is null;"
    ],
    "sql_types": [
      "SELECT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/model/device.go",
        "code_start_line": 9,
        "code_end_line": 9,
        "code_key": "base",
        "code_value": "overview/internal/base",
        "code_label": null,
        "code_type": 4,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/model/device.go",
        "code_start_line": 23,
        "code_end_line": 23,
        "code_key": "IvcDeviceTable",
        "code_value": "const IvcDeviceTable           = \"ivc_device\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/model/device.go",
        "code_start_line": 172,
        "code_end_line": 172,
        "code_key": "counts",
        "code_value": "int64",
        "code_label": null,
        "code_type": 31,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-overview.json"
  },
  {
    "function_name": "generalVideoQueryrealPlans",
    "orm_code": "func (rs *RecordState) generalVideoQueryrealPlans(wg *sync.WaitGroup, req types.GeneralRequest, num *int) {\n\tdefer wg.Done()\n\tvar count int64\n\terr := base.GetInstance().Driver().Clauses(SqlComment(req)...).Table(IvcRecordPlanTable).Where(\"app_id = ? and status = 1\", rs.AppId).Count(&count).Error\n\t*num = int(count)\n\tif err != nil {\n\t\trs.ErrChan <- err\n\t}\n\treturn\n}",
    "caller": "",
    "sql_statement_list": [
      "SELECT count(*) FROM ivc_record_plan WHERE app_id = ? AND status = 1;"
    ],
    "sql_types": [
      "SELECT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/model/record.go",
        "code_start_line": 11,
        "code_end_line": 11,
        "code_key": "base",
        "code_value": "overview/internal/base",
        "code_label": null,
        "code_type": 4,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/model/record.go",
        "code_start_line": 29,
        "code_end_line": 29,
        "code_key": "IvcRecordPlanTable",
        "code_value": "const IvcRecordPlanTable         = \"ivc_record_plan\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/model/record.go",
        "code_start_line": 146,
        "code_end_line": 146,
        "code_key": "count",
        "code_value": "int64",
        "code_label": null,
        "code_type": 31,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-overview.json"
  },
  {
    "function_name": "generalVideoQueryrealTemplates",
    "orm_code": "func (rs *RecordState) generalVideoQueryrealTemplates(wg *sync.WaitGroup, req types.GeneralRequest, num *int) {\n\tdefer wg.Done()\n\tvar count int64\n\terr := base.GetInstance().Driver().Clauses(SqlComment(req)...).Table(IvcRecordTemplateTable).Where(\"app_id = ?\", rs.AppId).Count(&count).Error\n\t*num = int(count)\n\tif err != nil {\n\t\trs.ErrChan <- err\n\t}\n\treturn\n}",
    "caller": "",
    "sql_statement_list": [
      "SELECT count(*) FROM ivc_record_template WHERE app_id = ?;"
    ],
    "sql_types": [
      "SELECT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/model/record.go",
        "code_start_line": 11,
        "code_end_line": 11,
        "code_key": "base",
        "code_value": "overview/internal/base",
        "code_label": null,
        "code_type": 4,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/model/record.go",
        "code_start_line": 30,
        "code_end_line": 30,
        "code_key": "IvcRecordTemplateTable",
        "code_value": "const IvcRecordTemplateTable     = \"ivc_record_template\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/model/record.go",
        "code_start_line": 157,
        "code_end_line": 157,
        "code_key": "count",
        "code_value": "int64",
        "code_label": null,
        "code_type": 31,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-overview.json"
  },
  {
    "function_name": "generalVideoQuerytasks",
    "orm_code": "func (rs *RecordState) generalVideoQuerytasks(wg *sync.WaitGroup, req types.GeneralRequest, num *int) {\n\tdefer wg.Done()\n\tvar count int64\n\terr := base.GetInstance().Driver().Clauses(SqlComment(req)...).Table(IvcRecordRetrieveTaskTable).Where(\"app_id = ?\", rs.AppId).Count(&count).Error\n\t*num = int(count)\n\tif err != nil {\n\t\trs.ErrChan <- err\n\t}\n\treturn\n}",
    "caller": "",
    "sql_statement_list": [
      "SELECT COUNT(*) FROM ivc_record_retrieve_task WHERE app_id = ?;"
    ],
    "sql_types": [
      "SELECT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/model/record.go",
        "code_start_line": 11,
        "code_end_line": 11,
        "code_key": "base",
        "code_value": "overview/internal/base",
        "code_label": null,
        "code_type": 4,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/model/record.go",
        "code_start_line": 31,
        "code_end_line": 31,
        "code_key": "IvcRecordRetrieveTaskTable",
        "code_value": "const IvcRecordRetrieveTaskTable = \"ivc_record_retrieve_task\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/model/record.go",
        "code_start_line": 168,
        "code_end_line": 168,
        "code_key": "count",
        "code_value": "int64",
        "code_label": null,
        "code_type": 31,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-overview.json"
  },
  {
    "function_name": "generalVideoQuerylocalTemplate",
    "orm_code": "func (rs *RecordState) generalVideoQuerylocalTemplate(wg *sync.WaitGroup, req types.GeneralRequest, num *int) {\n\tdefer wg.Done()\n\tvar count int64\n\terr := base.GetInstance().Driver().Clauses(SqlComment(req)...).Table(IvcRecordBakTemplateTable).Where(\"app_id = ? and deleted_at is null\", rs.AppId).Count(&count).Error\n\t*num = int(count)\n\tif err != nil {\n\t\trs.ErrChan <- err\n\t}\n\treturn\n}",
    "caller": "",
    "sql_statement_list": [
      "SELECT count(*) FROM ivc_record_bak_template WHERE app_id = ? AND deleted_at is null;"
    ],
    "sql_types": [
      "SELECT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/model/record.go",
        "code_start_line": 11,
        "code_end_line": 11,
        "code_key": "base",
        "code_value": "overview/internal/base",
        "code_label": null,
        "code_type": 4,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/model/record.go",
        "code_start_line": 33,
        "code_end_line": 33,
        "code_key": "IvcRecordBakTemplateTable",
        "code_value": "const IvcRecordBakTemplateTable  = \"ivc_record_bak_template\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/model/record.go",
        "code_start_line": 179,
        "code_end_line": 179,
        "code_key": "count",
        "code_value": "int64",
        "code_label": null,
        "code_type": 31,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-overview.json"
  },
  {
    "function_name": "generalVideoQuerylocalPlan",
    "orm_code": "func (rs *RecordState) generalVideoQuerylocalPlan(wg *sync.WaitGroup, req types.GeneralRequest, num *int) {\n\tdefer wg.Done()\n\tvar count int64\n\terr := base.GetInstance().Driver().Clauses(SqlComment(req)...).Table(IvcRecordBakPlanTable).Where(\"app_id = ? and status = 1\", rs.AppId).Count(&count).Error\n\t*num = int(count)\n\tif err != nil {\n\t\trs.ErrChan <- err\n\t}\n\treturn\n}",
    "caller": "",
    "sql_statement_list": [
      "SELECT count(*) FROM ivc_record_bak_plan WHERE app_id = ? AND status = 1;"
    ],
    "sql_types": [
      "SELECT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/model/record.go",
        "code_start_line": 11,
        "code_end_line": 11,
        "code_key": "base",
        "code_value": "overview/internal/base",
        "code_label": null,
        "code_type": 4,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/model/record.go",
        "code_start_line": 32,
        "code_end_line": 32,
        "code_key": "IvcRecordBakPlanTable",
        "code_value": "const IvcRecordBakPlanTable      = \"ivc_record_bak_plan\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-overview/internal/model/record.go",
        "code_start_line": 190,
        "code_end_line": 190,
        "code_key": "count",
        "code_value": "int64",
        "code_label": null,
        "code_type": 31,
        "code_version": "20a4303cf6a2662491830cde47ce9cfa89ad2ed1"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-overview.json"
  }
]