[
  {
    "function_name": "FindUserBillingAmount",
    "orm_code": "func FindUserBillingAmount(date string) ([]PostPayBill, error) {\n\t/*\n\t\t\tselect A.app_id,A.owner_uin,B.name,B.corporate,B.channel_mark,B.income_industry_name,A.date,A.region,A.field,A.amount,A.unit,A.price\n\t\t\tfrom iss_postpay_bill as A INNER JOIN ivc_user_info as B ON A.app_id = B.app_id\n\t\t   where A.date='2023-07-30' and A.push_status != \"NoNeedPush\" and A.cycle = \"Day\"\n\t\t   GROUP BY A.app_id,A.field;\n\t*/\n\tpbs := make([]PostPayBill, 0)\n\tsql := \"select A.app_id,A.owner_uin,B.name,B.corporate,B.channel_mark,B.income_industry_name,A.date,A.region,A.field,A.amount,A.unit,A.price from iss_postpay_bill as A \" +\n\t\t\"INNER JOIN ivc_user_info as B ON A.app_id = B.app_id \" +\n\t\t\"where A.date=? and A.push_status = 'NeedPush' and A.cycle = 'Day';\"\n\terr := base.GetInstance().BillingDriver().Raw(fmt.Sprintf(\"/* \"+Comment+\" */\", \"FindUserBillingAmount\")+sql, date).Scan(&pbs).Error\n\tif err != nil {\n\t\treturn pbs, err\n\t}\n\n\treturn pbs, nil\n}",
    "caller": "",
    "sql_statement_list": [
      "select A.app_id,A.owner_uin,B.name,B.corporate,B.channel_mark,B.income_industry_name,A.date,A.region,A.field,A.amount,A.unit,A.price from iss_postpay_bill as A INNER JOIN ivc_user_info as B ON A.app_id = B.app_id where A.date=? and A.push_status = 'NeedPush' and A.cycle = 'Day';"
    ],
    "sql_types": [
      "SELECT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/billing.go",
        "code_start_line": 10,
        "code_end_line": 10,
        "code_key": "base",
        "code_value": "dbs/internal/base",
        "code_label": null,
        "code_type": 4,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/billing.go",
        "code_start_line": 87,
        "code_end_line": 87,
        "code_key": "sql",
        "code_value": "\"select A.app_id,A.owner_uin,B.name,B.corporate,B.channel_mark,B.income_industry_name,A.date,A.region,A.field,A.amount,A.unit,A.price from iss_postpay_bill as A \" +\n\t\t\"INNER JOIN ivc_user_info as B ON A.app_id = B.app_id \" +\n\t\t\"where A.date=? and A.push_status = 'NeedPush' and A.cycle = 'Day';\"",
        "code_label": null,
        "code_type": 35,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/billing.go",
        "code_start_line": 86,
        "code_end_line": 86,
        "code_key": "pbs",
        "code_value": "make([]PostPayBill, 0)",
        "code_label": null,
        "code_type": 35,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/billing.go",
        "code_start_line": 55,
        "code_end_line": 68,
        "code_key": "PostPayBill",
        "code_value": "type PostPayBill struct {\n\tAppId              int     `json:\"AppId\" gorm:\"column:app_id\"`\n\tUin                string  `json:\"Uin\" gorm:\"column:owner_uin\"`\n\tName               string  `json:\"Name\" gorm:\"column:name\"`\n\tCorporate          int     `json:\"Corporate\" gorm:\"column:corporate\"`\n\tChannelMark        int     `json:\"ChannelMark\" gorm:\"column:channel_mark\"`                //用户来源\n\tIncomeIndustryName string  `json:\"IncomeIndustryName\" gorm:\"column:income_industry_name\"` //行业\n\tRegion             string  `json:\"Region\" gorm:\"column:region\"`\n\tDate               string  `json:\"Date\" gorm:\"type:date;column:date\"`\n\tField              string  `json:\"Field\" gorm:\"column:field\"`\n\tAmount             float64 `json:\"Amount\" gorm:\"column:amount\"`\n\tUnit               string  `json:\"Unit\" gorm:\"column:unit\"`\n\tPrice              float64 `json:\"Price\" gorm:\"column:price\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-dbs.json"
  },
  {
    "function_name": "FindUserUsagesAmount",
    "orm_code": "func FindUserUsagesAmount(date string) ([]PostPayBill, error) {\n\t/*\n\t\tselect A.app_id,A.owner_uin,B.name,A.date,A.region,A.field,A.amount,A.unit,A.price\n\t\tfrom iss_postpay_bill as A INNER JOIN ivc_user_info as B ON A.app_id = B.app_id\n\t\twhere A.date= '2023-08-24' and A.field in ('iss_downlink_traffic','iss_uplink_traffic') and A.cycle = 'Day'\n\t*/\n\tpbs := make([]PostPayBill, 0)\n\tsql := \"select A.app_id,A.owner_uin,B.name,A.date,A.region,A.field,A.amount,A.unit,A.price \" +\n\t\t\"from iss_postpay_bill as A INNER JOIN ivc_user_info as B ON A.app_id = B.app_id \" +\n\t\t\"where A.date= ? and A.field in ('iss_downlink_traffic','iss_uplink_traffic','cos_std_storage','cos_arc_storage') and A.cycle = 'Day';\"\n\terr := base.GetInstance().BillingDriver().Raw(fmt.Sprintf(\"/* \"+Comment+\" */\", \"FindUserUsagesAmount\")+sql, date).Scan(&pbs).Error\n\tif err != nil {\n\t\treturn pbs, err\n\t}\n\n\treturn pbs, nil\n}",
    "caller": "",
    "sql_statement_list": [
      "/* FindUserUsagesAmount */select A.app_id,A.owner_uin,B.name,A.date,A.region,A.field,A.amount,A.unit,A.price from iss_postpay_bill as A INNER JOIN ivc_user_info as B ON A.app_id = B.app_id where A.date= ? and A.field in ('iss_downlink_traffic','iss_uplink_traffic','cos_std_storage','cos_arc_storage') and A.cycle = 'Day';"
    ],
    "sql_types": [
      "OTHER"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/billing.go",
        "code_start_line": 10,
        "code_end_line": 10,
        "code_key": "base",
        "code_value": "dbs/internal/base",
        "code_label": null,
        "code_type": 4,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/billing.go",
        "code_start_line": 106,
        "code_end_line": 106,
        "code_key": "sql",
        "code_value": "\"select A.app_id,A.owner_uin,B.name,A.date,A.region,A.field,A.amount,A.unit,A.price \" +\n\t\t\"from iss_postpay_bill as A INNER JOIN ivc_user_info as B ON A.app_id = B.app_id \" +\n\t\t\"where A.date= ? and A.field in ('iss_downlink_traffic','iss_uplink_traffic','cos_std_storage','cos_arc_storage') and A.cycle = 'Day';\"",
        "code_label": null,
        "code_type": 35,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/billing.go",
        "code_start_line": 105,
        "code_end_line": 105,
        "code_key": "pbs",
        "code_value": "make([]PostPayBill, 0)",
        "code_label": null,
        "code_type": 35,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/billing.go",
        "code_start_line": 55,
        "code_end_line": 68,
        "code_key": "PostPayBill",
        "code_value": "type PostPayBill struct {\n\tAppId              int     `json:\"AppId\" gorm:\"column:app_id\"`\n\tUin                string  `json:\"Uin\" gorm:\"column:owner_uin\"`\n\tName               string  `json:\"Name\" gorm:\"column:name\"`\n\tCorporate          int     `json:\"Corporate\" gorm:\"column:corporate\"`\n\tChannelMark        int     `json:\"ChannelMark\" gorm:\"column:channel_mark\"`                //用户来源\n\tIncomeIndustryName string  `json:\"IncomeIndustryName\" gorm:\"column:income_industry_name\"` //行业\n\tRegion             string  `json:\"Region\" gorm:\"column:region\"`\n\tDate               string  `json:\"Date\" gorm:\"type:date;column:date\"`\n\tField              string  `json:\"Field\" gorm:\"column:field\"`\n\tAmount             float64 `json:\"Amount\" gorm:\"column:amount\"`\n\tUnit               string  `json:\"Unit\" gorm:\"column:unit\"`\n\tPrice              float64 `json:\"Price\" gorm:\"column:price\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-dbs.json"
  },
  {
    "function_name": "FindUserOnlineDeviceAmount",
    "orm_code": "func FindUserOnlineDeviceAmount(date string) ([]IssFiveMinuteBillState, error) {\n\t// select project_id,field,value,ctime,utime from iss_five_minute_stat_20240418 where field = 'ivc_device'\n\tibs := make([]IssFiveMinuteBillState, 0)\n\ttableName := fmt.Sprintf(IssFiveMinuteStat, strings.ReplaceAll(date, \"-\", \"\"))\n\tsql := fmt.Sprintf(\"select project_id,field,value,ctime,utime from %v where field = 'ivc_device'\", tableName)\n\terr := base.GetInstance().BillingDriver().Raw(fmt.Sprintf(\"/* \"+Comment+\" */\", \"FindUserOnlineDeviceAmount\") + sql).Scan(&ibs).Error\n\tif err != nil {\n\t\treturn ibs, err\n\t}\n\n\treturn ibs, nil\n}",
    "caller": "",
    "sql_statement_list": [
      {
        "type": "param_dependent",
        "variants": [
          {
            "scenario": "根据传入的date参数动态生成表名，查询设备在线数据",
            "sql": "select project_id,field,value,ctime,utime from iss_five_minute_stat_20240418 where field = 'ivc_device';"
          }
        ]
      }
    ],
    "sql_types": [
      "PARAM_DEPENDENT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/billing.go",
        "code_start_line": 10,
        "code_end_line": 10,
        "code_key": "base",
        "code_value": "dbs/internal/base",
        "code_label": null,
        "code_type": 4,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/billing.go",
        "code_start_line": 122,
        "code_end_line": 122,
        "code_key": "sql",
        "code_value": "fmt.Sprintf(\"select project_id,field,value,ctime,utime from %v where field = 'ivc_device'\", tableName)",
        "code_label": null,
        "code_type": 35,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/billing.go",
        "code_start_line": 5,
        "code_end_line": 5,
        "code_key": "fmt",
        "code_value": "fmt",
        "code_label": null,
        "code_type": 4,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/billing.go",
        "code_start_line": 121,
        "code_end_line": 121,
        "code_key": "tableName",
        "code_value": "fmt.Sprintf(IssFiveMinuteStat, strings.ReplaceAll(date, \"-\", \"\"))",
        "code_label": null,
        "code_type": 35,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/billing.go",
        "code_start_line": 33,
        "code_end_line": 33,
        "code_key": "IssFiveMinuteStat",
        "code_value": "const IssFiveMinuteStat = \"iss_five_minute_stat_%v\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/billing.go",
        "code_start_line": 8,
        "code_end_line": 8,
        "code_key": "strings",
        "code_value": "strings",
        "code_label": null,
        "code_type": 4,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/billing.go",
        "code_start_line": 120,
        "code_end_line": 120,
        "code_key": "ibs",
        "code_value": "make([]IssFiveMinuteBillState, 0)",
        "code_label": null,
        "code_type": 35,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/billing.go",
        "code_start_line": 70,
        "code_end_line": 76,
        "code_key": "IssFiveMinuteBillState",
        "code_value": "type IssFiveMinuteBillState struct {\n\tProjectId string  `json:\"ProjectId\" gorm:\"column:project_id\"`\n\tField     string  `json:\"Field\" gorm:\"column:field\"`\n\tValue     float64 `json:\"Value\" gorm:\"column:value\"`\n\tCtime     string  `json:\"Ctime\" gorm:\"column:ctime\"`\n\tUtime     string  `json:\"Utime\" gorm:\"column:utime\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-dbs.json"
  },
  {
    "function_name": "FindMonthlyAccountCustomerBillingAmount",
    "orm_code": "func FindMonthlyAccountCustomerBillingAmount(date string) ([]PostPayBill, error) {\n\tpbs := make([]PostPayBill, 0)\n\tsql := \"select A.app_id,A.owner_uin,B.name,B.corporate,B.channel_mark,B.income_industry_name,A.date,A.region,A.field,A.amount,A.unit,A.price from iss_postpay_bill as A \" +\n\t\t\"INNER JOIN ivc_user_info as B ON A.app_id = B.app_id \" +\n\t\t\"where A.date=? and A.push_status = 'NeedPush' and A.cycle = 'Month';\"\n\terr := base.GetInstance().BillingDriver().Raw(fmt.Sprintf(\"/* \"+Comment+\" */\", \"FindMonthlyAccountCustomerBillingAmount\")+sql, date).Scan(&pbs).Error\n\tif err != nil {\n\t\treturn pbs, err\n\t}\n\n\treturn pbs, nil\n}",
    "caller": "",
    "sql_statement_list": [
      "select A.app_id,A.owner_uin,B.name,B.corporate,B.channel_mark,B.income_industry_name,A.date,A.region,A.field,A.amount,A.unit,A.price from iss_postpay_bill as A INNER JOIN ivc_user_info as B ON A.app_id = B.app_id where A.date=? and A.push_status = 'NeedPush' and A.cycle = 'Month';"
    ],
    "sql_types": [
      "SELECT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/billing.go",
        "code_start_line": 10,
        "code_end_line": 10,
        "code_key": "base",
        "code_value": "dbs/internal/base",
        "code_label": null,
        "code_type": 4,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/billing.go",
        "code_start_line": 257,
        "code_end_line": 257,
        "code_key": "sql",
        "code_value": "\"select A.app_id,A.owner_uin,B.name,B.corporate,B.channel_mark,B.income_industry_name,A.date,A.region,A.field,A.amount,A.unit,A.price from iss_postpay_bill as A \" +\n\t\t\"INNER JOIN ivc_user_info as B ON A.app_id = B.app_id \" +\n\t\t\"where A.date=? and A.push_status = 'NeedPush' and A.cycle = 'Month';\"",
        "code_label": null,
        "code_type": 35,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/billing.go",
        "code_start_line": 256,
        "code_end_line": 256,
        "code_key": "pbs",
        "code_value": "make([]PostPayBill, 0)",
        "code_label": null,
        "code_type": 35,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/billing.go",
        "code_start_line": 55,
        "code_end_line": 68,
        "code_key": "PostPayBill",
        "code_value": "type PostPayBill struct {\n\tAppId              int     `json:\"AppId\" gorm:\"column:app_id\"`\n\tUin                string  `json:\"Uin\" gorm:\"column:owner_uin\"`\n\tName               string  `json:\"Name\" gorm:\"column:name\"`\n\tCorporate          int     `json:\"Corporate\" gorm:\"column:corporate\"`\n\tChannelMark        int     `json:\"ChannelMark\" gorm:\"column:channel_mark\"`                //用户来源\n\tIncomeIndustryName string  `json:\"IncomeIndustryName\" gorm:\"column:income_industry_name\"` //行业\n\tRegion             string  `json:\"Region\" gorm:\"column:region\"`\n\tDate               string  `json:\"Date\" gorm:\"type:date;column:date\"`\n\tField              string  `json:\"Field\" gorm:\"column:field\"`\n\tAmount             float64 `json:\"Amount\" gorm:\"column:amount\"`\n\tUnit               string  `json:\"Unit\" gorm:\"column:unit\"`\n\tPrice              float64 `json:\"Price\" gorm:\"column:price\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-dbs.json"
  },
  {
    "function_name": "FindUserResourceUseRecordBalanceData",
    "orm_code": "func FindUserResourceUseRecordBalanceData() ([]BillingBalanceData, error) {\n\t/*\n\t   SELECT A.app_id,A.field,A.resource_id,B.date,B.remaining_detail\n\t   FROM iss_prepay_resource as A JOIN iss_prepay_resource_userecord as B ON A.resource_id = B.resource_id\n\t   WHERE DATE(A.start_date) <= DATE_SUB(CURDATE(), INTERVAL 1 DAY) AND DATE(A.end_date) >= DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n\t   and DATE(B.date) = DATE_SUB(CURDATE(), INTERVAL 1 DAY);\n\t*/\n\tbds := make([]BillingBalanceData, 0)\n\tsql := \"SELECT A.app_id,A.field,A.resource_id,B.date,B.remaining_detail \" +\n\t\t\"FROM iss_prepay_resource as A JOIN iss_prepay_resource_userecord as B ON A.resource_id = B.resource_id \" +\n\t\t\"WHERE DATE(A.start_date) <= DATE_SUB(CURDATE(), INTERVAL 1 DAY) AND DATE(A.end_date) >= DATE_SUB(CURDATE(), INTERVAL 1 DAY) \" +\n\t\t\"AND DATE(B.date) = DATE_SUB(CURDATE(), INTERVAL 1 DAY);\"\n\terr := base.GetInstance().BillingDriver().Raw(fmt.Sprintf(\"/* \"+Comment+\" */\", \"FindMonthlyAccountCustomerBillingAmount\") + sql).Scan(&bds).Error\n\tif err != nil {\n\t\treturn bds, err\n\t}\n\n\treturn bds, nil\n}",
    "caller": "",
    "sql_statement_list": [
      "/* FindMonthlyAccountCustomerBillingAmount */ SELECT A.app_id, A.field, A.resource_id, B.date, B.remaining_detail FROM iss_prepay_resource as A JOIN iss_prepay_resource_userecord as B ON A.resource_id = B.resource_id WHERE DATE(A.start_date) <= DATE_SUB(CURDATE(), INTERVAL 1 DAY) AND DATE(A.end_date) >= DATE_SUB(CURDATE(), INTERVAL 1 DAY) AND DATE(B.date) = DATE_SUB(CURDATE(), INTERVAL 1 DAY);"
    ],
    "sql_types": [
      "OTHER"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/billing.go",
        "code_start_line": 10,
        "code_end_line": 10,
        "code_key": "base",
        "code_value": "dbs/internal/base",
        "code_label": null,
        "code_type": 4,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/billing.go",
        "code_start_line": 345,
        "code_end_line": 345,
        "code_key": "sql",
        "code_value": "\"SELECT A.app_id,A.field,A.resource_id,B.date,B.remaining_detail \" +\n\t\t\"FROM iss_prepay_resource as A JOIN iss_prepay_resource_userecord as B ON A.resource_id = B.resource_id \" +\n\t\t\"WHERE DATE(A.start_date) <= DATE_SUB(CURDATE(), INTERVAL 1 DAY) AND DATE(A.end_date) >= DATE_SUB(CURDATE(), INTERVAL 1 DAY) \" +\n\t\t\"AND DATE(B.date) = DATE_SUB(CURDATE(), INTERVAL 1 DAY);\"",
        "code_label": null,
        "code_type": 35,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/billing.go",
        "code_start_line": 344,
        "code_end_line": 344,
        "code_key": "bds",
        "code_value": "make([]BillingBalanceData, 0)",
        "code_label": null,
        "code_type": 35,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/billing.go",
        "code_start_line": 317,
        "code_end_line": 323,
        "code_key": "BillingBalanceData",
        "code_value": "type BillingBalanceData struct {\n\tAppId           int    `json:\"AppId\" gorm:\"column:app_id\"`\n\tDate            string `json:\"Date\" gorm:\"type:date;column:date\"`\n\tField           string `json:\"Field\" gorm:\"column:field\"`\n\tResourceId      string `json:\"ResourceId\" gorm:\"column:resource_id\"`\n\tRemainingDetail string `json:\"RemainingDetail\" gorm:\"column:remaining_detail\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-dbs.json"
  },
  {
    "function_name": "FindBucketWhitelists",
    "orm_code": "func FindBucketWhitelists() ([]IvcBucketSource, error) {\n\tbs := make([]IvcBucketSource, 0)\n\tvar err error\n\terr = base.GetInstance().IvcDriver().Clauses(CommentBefore(ACT_SELECT, \"FindBucketWhitelists\")).Table(IvcBucketWhitelistTable).Find(&bs).Error\n\tif err != nil {\n\t\tif err == db.ErrRecordNotFound {\n\t\t\treturn bs, utils.RecordNotFoundError\n\t\t}\n\t\treturn bs, err\n\t}\n\treturn bs, nil\n}",
    "caller": "",
    "sql_statement_list": [
      "SELECT id, name, uin, app_id, region, region_name, bucket_id, create_at, update_at FROM ivc_bucket_whitelist;"
    ],
    "sql_types": [
      "SELECT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 7,
        "code_end_line": 7,
        "code_key": "base",
        "code_value": "dbs/internal/base",
        "code_label": null,
        "code_type": 4,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 25,
        "code_end_line": 27,
        "code_key": "CommentBefore",
        "code_value": "func CommentBefore(Action, Callfunc string) hints.Hints {\n\treturn hints.CommentBefore(Action, fmt.Sprintf(Comment, Callfunc))\n}",
        "code_label": null,
        "code_type": 2,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 19,
        "code_end_line": 19,
        "code_key": "ACT_SELECT",
        "code_value": "const ACT_SELECT = \"SELECT\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 14,
        "code_end_line": 14,
        "code_key": "IvcBucketWhitelistTable",
        "code_value": "const IvcBucketWhitelistTable = \"ivc_bucket_whitelist\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 43,
        "code_end_line": 43,
        "code_key": "bs",
        "code_value": "make([]IvcBucketSource, 0)",
        "code_label": null,
        "code_type": 35,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 29,
        "code_end_line": 39,
        "code_key": "IvcBucketSource",
        "code_value": "type IvcBucketSource struct {\n\tId         int    `json:\"Id\" gorm:\"column:id\"`\n\tName       string `json:\"Name\" gorm:\"column:name\"`\n\tUin        string `json:\"Uin\" gorm:\"column:uin\"`\n\tAppId      int    `json:\"AppId\" gorm:\"column:app_id\"`\n\tRegion     int    `json:\"Region\" gorm:\"column:region\"`\n\tRegionName string `json:\"RegionName\" gorm:\"column:region_name\"`\n\tBucketId   string `json:\"BucketId\" gorm:\"column:bucket_id\"`\n\tCreatedAt  int    `json:\"CreateAt\" gorm:\"column:create_at\"`\n\tUpdatedAt  int    `json:\"UpdateAt\" gorm:\"column:update_at\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-dbs.json"
  },
  {
    "function_name": "FindBucketUsage",
    "orm_code": "func (c *CosBucket) FindBucketUsage(date string) error {\n\tparts := strings.Split(date, \"-\")\n\tyearMonth := parts[0] + parts[1]\n\tval := make([]interface{}, 0)\n\t/* 实际总存储量字段\n\t   arc_storage+std_storage+ sia_storage+ nel_storage+maz_std_storage+maz_sia_storage+\n\t   dp_arc_storage+int_freq_storage+int_infreq_storage+maz_int_freq_storage+maz_int_infreq_storage\n\t*/\n\tsql := \"select date,sum(std_storage+arc_storage+sia_storage+dp_arc_storage) as total_storage,\" +\n\t\t\"std_storage,arc_storage,sia_storage,dp_arc_storage from \" + fmt.Sprintf(CosBucketTable, yearMonth) +\n\t\t\" where date = ? and app_id = ? and bucket = ?\"\n\tval = append(val, c.Date, c.AppId, c.Bucket)\n\terr := base.GetInstance().CosBucketDriver().Raw(fmt.Sprintf(\"/* \"+Comment+\" */\", \"FindBucketUsage\")+sql, val...).Scan(c).Error\n\tif err != nil {\n\t\treturn err\n\t}\n\treturn nil\n}",
    "caller": "",
    "sql_statement_list": [
      "/* FindBucketUsage */select date,sum(std_storage+arc_storage+sia_storage+dp_arc_storage) as total_storage,std_storage,arc_storage,sia_storage,dp_arc_storage from cos_bucket_202401 where date = ? and app_id = ? and bucket = ?;"
    ],
    "sql_types": [
      "OTHER"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 7,
        "code_end_line": 7,
        "code_key": "base",
        "code_value": "dbs/internal/base",
        "code_label": null,
        "code_type": 4,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 92,
        "code_end_line": 92,
        "code_key": "sql",
        "code_value": "\"select date,sum(std_storage+arc_storage+sia_storage+dp_arc_storage) as total_storage,\" +\n\t\t\"std_storage,arc_storage,sia_storage,dp_arc_storage from \" + fmt.Sprintf(CosBucketTable, yearMonth) +\n\t\t\" where date = ? and app_id = ? and bucket = ?\"",
        "code_label": null,
        "code_type": 35,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 4,
        "code_end_line": 4,
        "code_key": "fmt",
        "code_value": "fmt",
        "code_label": null,
        "code_type": 4,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 16,
        "code_end_line": 16,
        "code_key": "CosBucketTable",
        "code_value": "const CosBucketTable          = \"cos_bucket_%v\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 86,
        "code_end_line": 86,
        "code_key": "yearMonth",
        "code_value": "parts[0] + parts[1]",
        "code_label": null,
        "code_type": 35,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 85,
        "code_end_line": 85,
        "code_key": "parts",
        "code_value": "strings.Split(date, \"-\")",
        "code_label": null,
        "code_type": 35,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 5,
        "code_end_line": 5,
        "code_key": "strings",
        "code_value": "strings",
        "code_label": null,
        "code_type": 4,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 87,
        "code_end_line": 87,
        "code_key": "val",
        "code_value": "make([]interface{}, 0)",
        "code_label": null,
        "code_type": 35,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 69,
        "code_end_line": 81,
        "code_key": "CosBucket",
        "code_value": "type CosBucket struct {\n\tId           int    `json:\"Id\" gorm:\"column:id\"`\n\tDate         string `json:\"Date\" gorm:\"column:date\"`\n\tName         string `json:\"Name\" gorm:\"column:name\"`\n\tUin          string `json:\"Uin\" gorm:\"column:uin\"`\n\tAppId        string `json:\"AppId\" gorm:\"column:app_id\"`\n\tBucket       string `json:\"Bucket\" gorm:\"column:bucket\"`\n\tTotalStorage int64  `json:\"TotalStorage\" gorm:\"column:total_storage\"`\n\tStdStorage   int64  `json:\"StdStorage\" gorm:\"column:std_storage\"`\n\tArcStorage   int64  `json:\"ArcStorage\" gorm:\"column:arc_storage\"`\n\tSiaStorage   int64  `json:\"SiaStorage\" gorm:\"column:sia_storage\"`\n\tDpArcStorage int64  `json:\"DpArcStorage\" gorm:\"column:dp_arc_storage\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-dbs.json"
  },
  {
    "function_name": "InsertUserBucketSummary",
    "orm_code": "func (cos *UserBucketSource) InsertUserBucketSummary() (int, error) {\n\terr := base.GetInstance().IvcDriver().Clauses(CommentBefore(ACT_INSERT, \"InsertUserBucketSummary\")).Table(IvcBucketSummaryTable).Create(cos).Error\n\tif err != nil {\n\t\treturn cos.Id, err\n\t}\n\treturn cos.Id, nil\n}",
    "caller": "",
    "sql_statement_list": [
      "INSERT INTO ivc_bucket_summary (id, date, name, uin, app_id, bucket_id, total_storage, std_storage, arc_storage, sia_storage, dp_arc_storage) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?);"
    ],
    "sql_types": [
      "INSERT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 7,
        "code_end_line": 7,
        "code_key": "base",
        "code_value": "dbs/internal/base",
        "code_label": null,
        "code_type": 4,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 25,
        "code_end_line": 27,
        "code_key": "CommentBefore",
        "code_value": "func CommentBefore(Action, Callfunc string) hints.Hints {\n\treturn hints.CommentBefore(Action, fmt.Sprintf(Comment, Callfunc))\n}",
        "code_label": null,
        "code_type": 2,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 20,
        "code_end_line": 20,
        "code_key": "ACT_INSERT",
        "code_value": "const ACT_INSERT = \"INSERT\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 15,
        "code_end_line": 15,
        "code_key": "IvcBucketSummaryTable",
        "code_value": "const IvcBucketSummaryTable   = \"ivc_bucket_summary\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 55,
        "code_end_line": 67,
        "code_key": "UserBucketSource",
        "code_value": "type UserBucketSource struct {\n\tId           int     `json:\"Id\" gorm:\"column:id\"`\n\tDate         string  `json:\"Date\" gorm:\"column:date\"`\n\tName         string  `json:\"Name\" gorm:\"column:name\"`\n\tUin          string  `json:\"Uin\" gorm:\"column:uin\"`\n\tAppId        int     `json:\"AppId\" gorm:\"column:app_id\"`\n\tBucketId     string  `json:\"BucketId\" gorm:\"column:bucket_id\"`\n\tTotalStorage float64 `json:\"TotalStorage\" gorm:\"column:total_storage\"`\n\tStdStorage   float64 `json:\"StdStorage\" gorm:\"column:std_storage\"`\n\tArcStorage   float64 `json:\"ArcStorage\" gorm:\"column:arc_storage\"`\n\tSiaStorage   float64 `json:\"SiaStorage\" gorm:\"column:sia_storage\"`\n\tDpArcStorage float64 `json:\"DpArcStorage\" gorm:\"column:dp_arc_storage\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-dbs.json"
  },
  {
    "function_name": "FindUserCount",
    "orm_code": "func (u *UserInfo) FindUserCount(end int64) (int, error) {\n\tvar counts int64\n\t// 查询创建时间在指定范围内的数据\n\tendTime := time.Unix(end, 0)\n\terr := base.GetInstance().BillingDriver().Clauses(CommentBefore(ACT_SELECT, \"FindUserCount\")).Table(UserInfoTable).Where(\"created_at <= ?\", endTime).Count(&counts).Error\n\tif err != nil {\n\t\treturn int(counts), err\n\t}\n\treturn int(counts), nil\n}",
    "caller": "",
    "sql_statement_list": [
      "SELECT count(*) FROM ivc_user_info WHERE created_at <= ?;"
    ],
    "sql_types": [
      "SELECT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/user.go",
        "code_start_line": 9,
        "code_end_line": 9,
        "code_key": "base",
        "code_value": "dbs/internal/base",
        "code_label": null,
        "code_type": 4,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 25,
        "code_end_line": 27,
        "code_key": "CommentBefore",
        "code_value": "func CommentBefore(Action, Callfunc string) hints.Hints {\n\treturn hints.CommentBefore(Action, fmt.Sprintf(Comment, Callfunc))\n}",
        "code_label": null,
        "code_type": 2,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 19,
        "code_end_line": 19,
        "code_key": "ACT_SELECT",
        "code_value": "const ACT_SELECT = \"SELECT\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/user.go",
        "code_start_line": 18,
        "code_end_line": 18,
        "code_key": "UserInfoTable",
        "code_value": "const UserInfoTable       = \"ivc_user_info\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/user.go",
        "code_start_line": 68,
        "code_end_line": 68,
        "code_key": "endTime",
        "code_value": "time.Unix(end, 0)",
        "code_label": null,
        "code_type": 35,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/user.go",
        "code_start_line": 7,
        "code_end_line": 7,
        "code_key": "time",
        "code_value": "time",
        "code_label": null,
        "code_type": 4,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/user.go",
        "code_start_line": 66,
        "code_end_line": 66,
        "code_key": "counts",
        "code_value": "int64",
        "code_label": null,
        "code_type": 31,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-dbs.json"
  },
  {
    "function_name": "FindBillingUserCount",
    "orm_code": "func (u *UserInfo) FindBillingUserCount(date string) ([]UserCount, error) {\n\tval := make([]interface{}, 0)\n\tuc := make([]UserCount, 0)\n\tvar sql string\n\n\t/*\n\t   SELECT B.corporate, COUNT(DISTINCT A.app_id) AS counts\n\t   FROM iss_postpay_bill as A\n\t   JOIN ivc_user_info as B ON A.app_id = B.app_id\n\t   WHERE A.date = '2023-07-25' and A.push_status != 'NoNeedPush'\n\t   GROUP BY B.corporate;\n\t*/\n\tsql = \"SELECT B.corporate, count(DISTINCT A.app_id) as counts FROM iss_postpay_bill as A JOIN ivc_user_info as B ON A.app_id = B.app_id \" +\n\t\t\"WHERE A.push_status = 'NeedPush' and A.date = ? GROUP BY B.corporate;\"\n\tval = append(val, date)\n\terr := base.GetInstance().BillingDriver().Raw(fmt.Sprintf(\"/* \"+Comment+\" */\", \"FindBillingUserCount\")+sql, val...).Scan(&uc).Error\n\tif err != nil {\n\t\treturn uc, err\n\t}\n\n\treturn uc, nil\n}",
    "caller": "",
    "sql_statement_list": [
      "/* FindBillingUserCount */SELECT B.corporate, count(DISTINCT A.app_id) as counts FROM iss_postpay_bill as A JOIN ivc_user_info as B ON A.app_id = B.app_id WHERE A.push_status = 'NeedPush' and A.date = ? GROUP BY B.corporate;"
    ],
    "sql_types": [
      "OTHER"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/user.go",
        "code_start_line": 9,
        "code_end_line": 9,
        "code_key": "base",
        "code_value": "dbs/internal/base",
        "code_label": null,
        "code_type": 4,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/user.go",
        "code_start_line": 80,
        "code_end_line": 80,
        "code_key": "sql",
        "code_value": "string",
        "code_label": null,
        "code_type": 31,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/user.go",
        "code_start_line": 78,
        "code_end_line": 78,
        "code_key": "val",
        "code_value": "make([]interface{}, 0)",
        "code_label": null,
        "code_type": 35,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/user.go",
        "code_start_line": 79,
        "code_end_line": 79,
        "code_key": "uc",
        "code_value": "make([]UserCount, 0)",
        "code_label": null,
        "code_type": 35,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/user.go",
        "code_start_line": 31,
        "code_end_line": 34,
        "code_key": "UserCount",
        "code_value": "type UserCount struct {\n\tCorporate int `json:\"Corporate\" gorm:\"column:corporate\"`\n\tCounts    int `json:\"Counts\" gorm:\"column:counts\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-dbs.json"
  },
  {
    "function_name": "FindResourcePackPrepaidDiscountPriceList",
    "orm_code": "func FindResourcePackPrepaidDiscountPriceList() ([]UserPrepaidDiscountPrice, error) {\n\t/*\n\t   查询用户资源包预付费折扣金额列表（源数据单位为元）\n\t   SELECT app_id, SUM(price*100 / (DATEDIFF(end_date, start_date) + 1)) as total_average_price FROM iss_prepay_resource\n\t   WHERE DATE(start_date) <= DATE_SUB(CURDATE(), INTERVAL 1 DAY) AND DATE(end_date) >= DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n\t   group by app_id\n\t   联合用户表查询预付费折扣金额\n\t   select A.app_id,B.uin,B.name,B.corporate,B.channel_mark,B.income_industry_name,SUM(A.price*100 / (DATEDIFF(A.end_date, A.start_date) + 1)) as total_average_price\n\t   from iss_prepay_resource as A INNER JOIN ivc_user_info as B ON A.app_id = B.app_id\n\t   WHERE DATE(A.start_date) <= DATE_SUB(CURDATE(), INTERVAL 1 DAY) AND DATE(A.end_date) >= DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n\t   group by A.app_id\n\t*/\n\tprices := make([]UserPrepaidDiscountPrice, 0)\n\tsql := \"select A.app_id,B.uin,B.name,B.corporate,B.channel_mark,B.income_industry_name,SUM(A.price*100 / (DATEDIFF(A.end_date, A.start_date) + 1)) as total_average_price \" +\n\t\t\"from iss_prepay_resource as A INNER JOIN ivc_user_info as B ON A.app_id = B.app_id \" +\n\t\t\"WHERE DATE(A.start_date) <= DATE_SUB(CURDATE(), INTERVAL 1 DAY) AND DATE(A.end_date) >= DATE_SUB(CURDATE(), INTERVAL 1 DAY) AND A.field != 'access_fee_ivcp' \" +\n\t\t\"group by A.app_id,B.uin;\"\n\terr := base.GetInstance().BillingDriver().Raw(fmt.Sprintf(\"/* \"+Comment+\" */\", \"FindResourcePackPrepaidDiscountPriceList\") + sql).Scan(&prices).Error\n\tif err != nil {\n\t\tif err == db.ErrRecordNotFound {\n\t\t\treturn prices, utils.RecordNotFoundError\n\t\t}\n\t\treturn prices, err\n\t}\n\n\treturn prices, nil\n}",
    "caller": "",
    "sql_statement_list": [
      "/* FindResourcePackPrepaidDiscountPriceList */select A.app_id,B.uin,B.name,B.corporate,B.channel_mark,B.income_industry_name,SUM(A.price*100 / (DATEDIFF(A.end_date, A.start_date) + 1)) as total_average_price from iss_prepay_resource as A INNER JOIN ivc_user_info as B ON A.app_id = B.app_id WHERE DATE(A.start_date) <= DATE_SUB(CURDATE(), INTERVAL 1 DAY) AND DATE(A.end_date) >= DATE_SUB(CURDATE(), INTERVAL 1 DAY) AND A.field != 'access_fee_ivcp' group by A.app_id,B.uin;"
    ],
    "sql_types": [
      "OTHER"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/user.go",
        "code_start_line": 9,
        "code_end_line": 9,
        "code_key": "base",
        "code_value": "dbs/internal/base",
        "code_label": null,
        "code_type": 4,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/user.go",
        "code_start_line": 114,
        "code_end_line": 114,
        "code_key": "sql",
        "code_value": "\"select A.app_id,B.uin,B.name,B.corporate,B.channel_mark,B.income_industry_name,SUM(A.price*100 / (DATEDIFF(A.end_date, A.start_date) + 1)) as total_average_price \" +\n\t\t\"from iss_prepay_resource as A INNER JOIN ivc_user_info as B ON A.app_id = B.app_id \" +\n\t\t\"WHERE DATE(A.start_date) <= DATE_SUB(CURDATE(), INTERVAL 1 DAY) AND DATE(A.end_date) >= DATE_SUB(CURDATE(), INTERVAL 1 DAY) AND A.field != 'access_fee_ivcp' \" +\n\t\t\"group by A.app_id,B.uin;\"",
        "code_label": null,
        "code_type": 35,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/user.go",
        "code_start_line": 113,
        "code_end_line": 113,
        "code_key": "prices",
        "code_value": "make([]UserPrepaidDiscountPrice, 0)",
        "code_label": null,
        "code_type": 35,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/user.go",
        "code_start_line": 40,
        "code_end_line": 48,
        "code_key": "UserPrepaidDiscountPrice",
        "code_value": "type UserPrepaidDiscountPrice struct {\n\tAppId              int     `json:\"AppId\" gorm:\"column:app_id\"`\n\tUin                string  `json:\"Uin\" gorm:\"column:uin\"`\n\tName               string  `json:\"Name\" gorm:\"column:name\"`\n\tCorporate          int     `json:\"Corporate\" gorm:\"column:corporate\"`\n\tChannelMark        int     `json:\"ChannelMark\" gorm:\"column:channel_mark\"`                //用户来源\n\tIncomeIndustryName string  `json:\"IncomeIndustryName\" gorm:\"column:income_industry_name\"` //行业\n\tTotalAveragePrice  float64 `json:\"TotalAveragePrice\" gorm:\"column:total_average_price\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-dbs.json"
  },
  {
    "function_name": "FindUserResourcePackPrepaidReceivablePrice",
    "orm_code": "func FindUserResourcePackPrepaidReceivablePrice() ([]UserPrepaidDiscountPrice, error) {\n\tprices := make([]UserPrepaidDiscountPrice, 0)\n\tsql := \"select A.app_id,B.uin,B.name,B.corporate,B.channel_mark,B.income_industry_name,SUM(price*100) as total_price  \" +\n\t\t\"from iss_prepay_resource as A INNER JOIN ivc_user_info as B ON A.app_id = B.app_id \" +\n\t\t\"WHERE DATE(start_date) = DATE_SUB(CURDATE(), INTERVAL 1 DAY) AND A.field = 'access_fee_ivcp' \" +\n\t\t\"group by A.app_id,B.uin;\"\n\terr := base.GetInstance().BillingDriver().Raw(fmt.Sprintf(\"/* \"+Comment+\" */\", \"FindUserResourcePackPrepaidReceivablePrice\") + sql).Scan(&prices).Error\n\tif err != nil {\n\t\tif err == db.ErrRecordNotFound {\n\t\t\treturn prices, utils.RecordNotFoundError\n\t\t}\n\t\treturn prices, err\n\t}\n\n\treturn prices, nil\n}",
    "caller": "",
    "sql_statement_list": [
      "SELECT A.app_id, B.uin, B.name, B.corporate, B.channel_mark, B.income_industry_name, SUM(price*100) as total_price FROM iss_prepay_resource as A INNER JOIN ivc_user_info as B ON A.app_id = B.app_id WHERE DATE(start_date) = DATE_SUB(CURDATE(), INTERVAL 1 DAY) AND A.field = 'access_fee_ivcp' GROUP BY A.app_id, B.uin;"
    ],
    "sql_types": [
      "SELECT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/user.go",
        "code_start_line": 9,
        "code_end_line": 9,
        "code_key": "base",
        "code_value": "dbs/internal/base",
        "code_label": null,
        "code_type": 4,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/user.go",
        "code_start_line": 132,
        "code_end_line": 132,
        "code_key": "sql",
        "code_value": "\"select A.app_id,B.uin,B.name,B.corporate,B.channel_mark,B.income_industry_name,SUM(price*100) as total_price  \" +\n\t\t\"from iss_prepay_resource as A INNER JOIN ivc_user_info as B ON A.app_id = B.app_id \" +\n\t\t\"WHERE DATE(start_date) = DATE_SUB(CURDATE(), INTERVAL 1 DAY) AND A.field = 'access_fee_ivcp' \" +\n\t\t\"group by A.app_id,B.uin;\"",
        "code_label": null,
        "code_type": 35,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/user.go",
        "code_start_line": 131,
        "code_end_line": 131,
        "code_key": "prices",
        "code_value": "make([]UserPrepaidDiscountPrice, 0)",
        "code_label": null,
        "code_type": 35,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/user.go",
        "code_start_line": 40,
        "code_end_line": 48,
        "code_key": "UserPrepaidDiscountPrice",
        "code_value": "type UserPrepaidDiscountPrice struct {\n\tAppId              int     `json:\"AppId\" gorm:\"column:app_id\"`\n\tUin                string  `json:\"Uin\" gorm:\"column:uin\"`\n\tName               string  `json:\"Name\" gorm:\"column:name\"`\n\tCorporate          int     `json:\"Corporate\" gorm:\"column:corporate\"`\n\tChannelMark        int     `json:\"ChannelMark\" gorm:\"column:channel_mark\"`                //用户来源\n\tIncomeIndustryName string  `json:\"IncomeIndustryName\" gorm:\"column:income_industry_name\"` //行业\n\tTotalAveragePrice  float64 `json:\"TotalAveragePrice\" gorm:\"column:total_average_price\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-dbs.json"
  },
  {
    "function_name": "FindResourcePackPrepaidDiscountPrice",
    "orm_code": "func (u *UserInfo) FindResourcePackPrepaidDiscountPrice() (float64, error) {\n\t/*\n\t    1. 查询单个资源包及有效期（源数据单位为元）\n\t    SELECT price,start_date,end_date,(DATEDIFF(end_date, start_date) + 1)\n\t    FROM iss_prepay_resource\n\t    WHERE DATE(start_date) <= DATE_SUB(CURDATE(), INTERVAL 1 DAY) AND DATE(end_date) >= DATE_SUB(CURDATE(), INTERVAL 1 DAY);\n\t   2. 查询资源包预付费折扣总金额（源数据单位为元）\n\t   SELECT SUM(price / (DATEDIFF(end_date, start_date) + 1)) as total_average_amount\n\t   FROM iss_prepay_resource\n\t   WHERE DATE(start_date) <= DATE_SUB(CURDATE(), INTERVAL 1 DAY) AND DATE(end_date) >= DATE_SUB(CURDATE(), INTERVAL 1 DAY);\n\t*/\n\tvar (\n\t\tprice PrepaidDiscountPrice\n\t\tsql   string\n\t)\n\tval := make([]interface{}, 0)\n\tsql = \"SELECT SUM(price*100 / (DATEDIFF(end_date, start_date) + 1)) as total_average_price FROM iss_prepay_resource \" +\n\t\t\"WHERE DATE(start_date) <= DATE_SUB(CURDATE(), INTERVAL 1 DAY) AND DATE(end_date) >= DATE_SUB(CURDATE(), INTERVAL 1 DAY)  AND field != 'access_fee_ivcp' \"\n\tif u.AppId > 0 {\n\t\tsql += \"AND app_id=? \"\n\t\tval = append(val, u.AppId)\n\t}\n\n\terr := base.GetInstance().BillingDriver().Raw(fmt.Sprintf(\"/* \"+Comment+\" */\", \"FindResourcePackPrepaidDiscountPrice\")+sql, val...).Scan(&price).Error\n\tif err != nil {\n\t\tif err == db.ErrRecordNotFound {\n\t\t\treturn price.TotalAveragePrice, utils.RecordNotFoundError\n\t\t}\n\t\treturn price.TotalAveragePrice, err\n\t}\n\n\treturn price.TotalAveragePrice, nil\n}",
    "caller": "",
    "sql_statement_list": [
      {
        "type": "param_dependent",
        "variants": [
          {
            "scenario": "AppId <= 0，不添加app_id条件",
            "sql": "SELECT SUM(price*100 / (DATEDIFF(end_date, start_date) + 1)) as total_average_price FROM iss_prepay_resource WHERE DATE(start_date) <= DATE_SUB(CURDATE(), INTERVAL 1 DAY) AND DATE(end_date) >= DATE_SUB(CURDATE(), INTERVAL 1 DAY) AND field != 'access_fee_ivcp';"
          },
          {
            "scenario": "AppId > 0，添加app_id条件",
            "sql": "SELECT SUM(price*100 / (DATEDIFF(end_date, start_date) + 1)) as total_average_price FROM iss_prepay_resource WHERE DATE(start_date) <= DATE_SUB(CURDATE(), INTERVAL 1 DAY) AND DATE(end_date) >= DATE_SUB(CURDATE(), INTERVAL 1 DAY) AND field != 'access_fee_ivcp' AND app_id = ?;"
          }
        ]
      }
    ],
    "sql_types": [
      "PARAM_DEPENDENT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/user.go",
        "code_start_line": 9,
        "code_end_line": 9,
        "code_key": "base",
        "code_value": "dbs/internal/base",
        "code_label": null,
        "code_type": 4,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/user.go",
        "code_start_line": 161,
        "code_end_line": 161,
        "code_key": "sql",
        "code_value": "string",
        "code_label": null,
        "code_type": 31,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/user.go",
        "code_start_line": 163,
        "code_end_line": 163,
        "code_key": "val",
        "code_value": "make([]interface{}, 0)",
        "code_label": null,
        "code_type": 35,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/user.go",
        "code_start_line": 160,
        "code_end_line": 160,
        "code_key": "price",
        "code_value": "PrepaidDiscountPrice",
        "code_label": null,
        "code_type": 31,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/user.go",
        "code_start_line": 36,
        "code_end_line": 38,
        "code_key": "PrepaidDiscountPrice",
        "code_value": "type PrepaidDiscountPrice struct {\n\tTotalAveragePrice float64 `json:\"TotalAveragePrice\" gorm:\"column:total_average_price\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-dbs.json"
  },
  {
    "function_name": "FindResourcePackPrepaidReceivablePrice",
    "orm_code": "func (u *UserInfo) FindResourcePackPrepaidReceivablePrice() (float64, error) {\n\tvar (\n\t\tprice PrepaidReceivablePrice\n\t\tsql   string\n\t)\n\tval := make([]interface{}, 0)\n\t// price单位由元转为分\n\tsql = \"SELECT SUM(price*100) as total_price FROM iss_prepay_resource WHERE DATE(start_date) = DATE_SUB(CURDATE(), INTERVAL 1 DAY) AND field = 'access_fee_ivcp' \"\n\tif u.AppId > 0 {\n\t\tsql += \"AND app_id=? \"\n\t\tval = append(val, u.AppId)\n\t}\n\terr := base.GetInstance().BillingDriver().Raw(fmt.Sprintf(\"/* \"+Comment+\" */\", \"FindResourcePackPrepaidReceivablePrice\")+sql, val...).Scan(&price).Error\n\tif err != nil {\n\t\tif err == db.ErrRecordNotFound {\n\t\t\treturn price.TotalPrice, utils.RecordNotFoundError\n\t\t}\n\t\treturn price.TotalPrice, err\n\t}\n\n\treturn price.TotalPrice, nil\n}",
    "caller": "",
    "sql_statement_list": [
      {
        "type": "param_dependent",
        "variants": [
          {
            "scenario": "AppId > 0，包含应用ID过滤条件",
            "sql": "/* FindResourcePackPrepaidReceivablePrice */SELECT SUM(price*100) as total_price FROM iss_prepay_resource WHERE DATE(start_date) = DATE_SUB(CURDATE(), INTERVAL 1 DAY) AND field = 'access_fee_ivcp' AND app_id=?;"
          },
          {
            "scenario": "AppId <= 0，不包含应用ID过滤条件",
            "sql": "/* FindResourcePackPrepaidReceivablePrice */SELECT SUM(price*100) as total_price FROM iss_prepay_resource WHERE DATE(start_date) = DATE_SUB(CURDATE(), INTERVAL 1 DAY) AND field = 'access_fee_ivcp';"
          }
        ]
      }
    ],
    "sql_types": [
      "PARAM_DEPENDENT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/user.go",
        "code_start_line": 9,
        "code_end_line": 9,
        "code_key": "base",
        "code_value": "dbs/internal/base",
        "code_label": null,
        "code_type": 4,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/user.go",
        "code_start_line": 186,
        "code_end_line": 186,
        "code_key": "sql",
        "code_value": "string",
        "code_label": null,
        "code_type": 31,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/user.go",
        "code_start_line": 188,
        "code_end_line": 188,
        "code_key": "val",
        "code_value": "make([]interface{}, 0)",
        "code_label": null,
        "code_type": 35,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/user.go",
        "code_start_line": 185,
        "code_end_line": 185,
        "code_key": "price",
        "code_value": "PrepaidReceivablePrice",
        "code_label": null,
        "code_type": 31,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/user.go",
        "code_start_line": 50,
        "code_end_line": 52,
        "code_key": "PrepaidReceivablePrice",
        "code_value": "type PrepaidReceivablePrice struct {\n\tTotalPrice float64 `json:\"TotalPrice\" gorm:\"column:total_price\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-dbs.json"
  },
  {
    "function_name": "FindUserList",
    "orm_code": "func FindUserList() ([]UserInfo, error) {\n\tvar userInfo []UserInfo\n\terr := base.GetInstance().BillingDriver().Clauses(CommentBefore(ACT_SELECT, \"FindUserList\")).Table(UserInfoTable).\n\t\tSelect(\"app_id,status,uin,name\").Find(&userInfo).Error\n\tif err != nil {\n\t\treturn userInfo, err\n\t}\n\tfilterUsers := make([]UserInfo, 0)\n\tfor _, user := range userInfo {\n\t\tif user.Status == NormalServiceStatus || user.Status == StopServiceStatus {\n\t\t\tfilterUsers = append(filterUsers, user)\n\t\t}\n\t}\n\treturn filterUsers, nil\n}",
    "caller": "",
    "sql_statement_list": [
      "SELECT app_id, status, uin, name FROM ivc_user_info;"
    ],
    "sql_types": [
      "SELECT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/user.go",
        "code_start_line": 9,
        "code_end_line": 9,
        "code_key": "base",
        "code_value": "dbs/internal/base",
        "code_label": null,
        "code_type": 4,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 25,
        "code_end_line": 27,
        "code_key": "CommentBefore",
        "code_value": "func CommentBefore(Action, Callfunc string) hints.Hints {\n\treturn hints.CommentBefore(Action, fmt.Sprintf(Comment, Callfunc))\n}",
        "code_label": null,
        "code_type": 2,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 19,
        "code_end_line": 19,
        "code_key": "ACT_SELECT",
        "code_value": "const ACT_SELECT = \"SELECT\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/user.go",
        "code_start_line": 18,
        "code_end_line": 18,
        "code_key": "UserInfoTable",
        "code_value": "const UserInfoTable       = \"ivc_user_info\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/user.go",
        "code_start_line": 243,
        "code_end_line": 243,
        "code_key": "userInfo",
        "code_value": "[]UserInfo",
        "code_label": null,
        "code_type": 31,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/user.go",
        "code_start_line": 24,
        "code_end_line": 29,
        "code_key": "UserInfo",
        "code_value": "type UserInfo struct {\n\tUin    string `json:\"Uin\" gorm:\"column:uin\"`\n\tAppId  int    `json:\"AppId\" gorm:\"column:app_id\"`\n\tStatus int    `json:\"Status\" gorm:\"column:status\"`\n\tName   string `json:\"Name\" gorm:\"column:name\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-dbs.json"
  },
  {
    "function_name": "FindUserList",
    "orm_code": "func FindUserList() ([]UserInfo, error) {\n\tvar userInfo []UserInfo\n\terr := base.GetInstance().BillingDriver().Clauses(CommentBefore(ACT_SELECT, \"FindUserList\")).Table(UserInfoTable).\n\t\tSelect(\"app_id,status,uin,name\").Find(&userInfo).Error\n\tif err != nil {\n\t\treturn userInfo, err\n\t}\n\tfilterUsers := make([]UserInfo, 0)\n\tfor _, user := range userInfo {\n\t\tif user.Status == NormalServiceStatus || user.Status == StopServiceStatus {\n\t\t\tfilterUsers = append(filterUsers, user)\n\t\t}\n\t}\n\treturn filterUsers, nil\n}",
    "caller": "func GetUserInfoList(log *logger.IvcLog) ([]UserInfo, error) {\n\tvar resp []UserInfo\n\tv, err := base.GetInstance().Redis().Get(context.TODO(), fmt.Sprintf(UserInfoStrKey)).Result()\n\tswitch err {\n\tcase nil:\n\t\terr = json.Unmarshal([]byte(v), &resp)\n\t\tif err != nil {\n\t\t\treturn nil, err\n\t\t}\n\t\treturn resp, nil\n\n\tcase redis.Nil:\n\t\tresp, err := FindUserList()\n\t\tif err != nil {\n\t\t\tlog.ErrorV(fmt.Sprintf(\"[GetUserInfoList] findUserList read db err:%v\", err))\n\t\t\tif err == db.ErrRecordNotFound {\n\t\t\t\treturn nil, utils.RecordNotFoundError\n\t\t\t}\n\t\t\treturn nil, err\n\t\t}\n\t\tv, err := json.Marshal(resp)\n\t\tif err != nil {\n\t\t\treturn nil, err\n\t\t}\n\t\terr = base.GetInstance().Redis().Set(context.TODO(), fmt.Sprintf(UserInfoStrKey), string(v), UserInfoExpiredTimeout).Err()\n\t\tif err != nil {\n\t\t\tlog.ErrorV(fmt.Sprintf(\"[GetUserInfoList] write cache err:%v\", err))\n\t\t\treturn nil, err\n\t\t}\n\t\treturn resp, nil\n\tdefault:\n\t\tlog.ErrorV(fmt.Sprintf(\"[GetUserInfoList] read cache err:%v\", err))\n\t\treturn nil, err\n\t}\n}",
    "sql_statement_list": [
      {
        "type": "LACK_INFORMATION",
        "variants": [
          {
            "scenario": "缺少UserInfoTable常量定义，根据UserInfo结构体推测表名",
            "sql": "SELECT app_id, status, uin, name FROM user_info;"
          }
        ]
      }
    ],
    "sql_statement": "根据代码分析，我需要先进行边界条件判断：\n\n**边界条件判断**：\n1. **SQL生成能力检查**：代码包含实际的数据库执行操作`Find(&userInfo)`，会生成SQL\n2. **信息完整性检查**：缺少`UserInfoTable`的具体定义，但可以根据结构体名称推测表名\n\n**<LACK INFORMATION>**: 缺少UserInfoTable常量定义，根据UserInfo结构体推测表名为user_info\n\n**SQL分析**：\n\n**表名确定**：\n- 代码中使用了`Table(UserInfoTable)`，但元数据中没有提供`UserInfoTable`的定义\n- 根据结构体名称`UserInfo`，按照GORM默认规则推测表名为`user_info`\n\n**调用者上下文约束**：\n调用者`GetUserInfoList`在Redis缓存未命中时会调用`FindUserList()`，该调用没有传递任何参数，因此会执行完整的查询逻辑。\n\n**执行路径分析**：\n该函数执行路径固定，不依赖任何入参，会生成一条固定结构的SQL语句：\n\n**场景1：标准查询执行**\n- 入参：无参数\n- 执行逻辑：查询所有用户信息，选择特定字段\n- 生成的SQL：\n```sql\nSELECT app_id, status, uin, name FROM user_info;\n```\n\n**SQL语句详细说明**：\n1. **操作类型**：SELECT查询\n2. **目标表**：user_info（根据UserInfo结构体推测）\n3. **选择字段**：app_id, status, uin, name（通过Select方法明确指定）\n4. **查询条件**：无WHERE条件，查询所有记录\n5. **后续处理**：查询结果在Go代码中进行过滤，但不影响SQL生成\n\n```json\n[\n  {\n    \"type\": \"LACK_INFORMATION\", \n    \"variants\": [\n      {\n        \"scenario\": \"缺少UserInfoTable常量定义，根据UserInfo结构体推测表名\",\n        \"sql\": \"SELECT app_id, status, uin, name FROM user_info;\"\n      }\n    ]\n  }\n]\n```",
    "verified_sql": "我需要仔细检查这个分析结果。让我逐步验证：\n\n**第一步：边界条件检查**\n\n分析结果包含了`<LACK INFORMATION>`标记，表明缺少`UserInfoTable`常量定义。让我验证：\n\n1. **信息缺失验证**：确实在元数据中没有找到`UserInfoTable`的定义\n2. **推测SQL验证**：基于`UserInfo`结构体推测表名为`user_info`是合理的\n3. **SQL完整性验证**：提供的推测SQL是完整可执行的\n\n**第二步：SQL语句验证**\n\n检查推测的SQL语句：\n- **表名**：`user_info`（基于UserInfo结构体的合理推测）\n- **字段**：`app_id, status, uin, name`（代码中明确指定的Select字段）\n- **操作**：SELECT查询（Find操作对应SELECT）\n- **条件**：无WHERE条件（代码中没有Where子句）\n\n**第三步：调用者上下文验证**\n\n调用者`GetUserInfoList`在Redis缓存未命中时调用`FindUserList()`，没有传递参数，会执行完整查询，符合分析结果。\n\n**第四步：SQL数量验证**\n\n代码中只有一个`Find(&userInfo)`操作，应该生成1条SQL语句，分析结果正确。\n\n**验证结论**：分析结果准确，边界条件判断正确，推测的SQL语句合理且完整。\n\n```json\n[\n  {\n    \"type\": \"LACK_INFORMATION\", \n    \"variants\": [\n      {\n        \"scenario\": \"缺少UserInfoTable常量定义，根据UserInfo结构体推测表名\",\n        \"sql\": \"SELECT app_id, status, uin, name FROM user_info;\"\n      }\n    ]\n  }\n]\n```",
    "sql_types": [
      "LACK_INFORMATION"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/user.go",
        "code_start_line": 9,
        "code_end_line": 9,
        "code_key": "base",
        "code_value": "dbs/internal/base",
        "code_label": null,
        "code_type": 4,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 25,
        "code_end_line": 27,
        "code_key": "CommentBefore",
        "code_value": "func CommentBefore(Action, Callfunc string) hints.Hints {\n\treturn hints.CommentBefore(Action, fmt.Sprintf(Comment, Callfunc))\n}",
        "code_label": null,
        "code_type": 2,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 19,
        "code_end_line": 19,
        "code_key": "ACT_SELECT",
        "code_value": "const ACT_SELECT = \"SELECT\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/user.go",
        "code_start_line": 18,
        "code_end_line": 18,
        "code_key": "UserInfoTable",
        "code_value": "const UserInfoTable       = \"ivc_user_info\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/user.go",
        "code_start_line": 243,
        "code_end_line": 243,
        "code_key": "userInfo",
        "code_value": "[]UserInfo",
        "code_label": null,
        "code_type": 31,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/user.go",
        "code_start_line": 24,
        "code_end_line": 29,
        "code_key": "UserInfo",
        "code_value": "type UserInfo struct {\n\tUin    string `json:\"Uin\" gorm:\"column:uin\"`\n\tAppId  int    `json:\"AppId\" gorm:\"column:app_id\"`\n\tStatus int    `json:\"Status\" gorm:\"column:status\"`\n\tName   string `json:\"Name\" gorm:\"column:name\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-dbs.json"
  },
  {
    "function_name": "InsertUserDeviceUsage",
    "orm_code": "func (dus *DeviceUsageSource) InsertUserDeviceUsage() (int, error) {\n\terr := base.GetInstance().IvcDriver().Clauses(CommentBefore(ACT_INSERT, \"InsertUserDeviceUsage\")).Table(IvcUsageDeviceTable).Create(dus).Error\n\tif err != nil {\n\t\treturn dus.Id, err\n\t}\n\treturn dus.Id, nil\n}",
    "caller": "",
    "sql_statement_list": [
      "INSERT INTO ivc_usage_device (id, app_id, uin, name, date, total_channel, online_channel, offline_channel, total_device, online_device, offline_device) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?);"
    ],
    "sql_types": [
      "INSERT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/usage_summary.go",
        "code_start_line": 4,
        "code_end_line": 4,
        "code_key": "base",
        "code_value": "dbs/internal/base",
        "code_label": null,
        "code_type": 4,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 25,
        "code_end_line": 27,
        "code_key": "CommentBefore",
        "code_value": "func CommentBefore(Action, Callfunc string) hints.Hints {\n\treturn hints.CommentBefore(Action, fmt.Sprintf(Comment, Callfunc))\n}",
        "code_label": null,
        "code_type": 2,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 20,
        "code_end_line": 20,
        "code_key": "ACT_INSERT",
        "code_value": "const ACT_INSERT = \"INSERT\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/usage_summary.go",
        "code_start_line": 10,
        "code_end_line": 10,
        "code_key": "IvcUsageDeviceTable",
        "code_value": "const IvcUsageDeviceTable  = \"ivc_usage_device\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/usage_summary.go",
        "code_start_line": 16,
        "code_end_line": 28,
        "code_key": "DeviceUsageSource",
        "code_value": "type DeviceUsageSource struct {\n\tId             int    `json:\"Id\" gorm:\"column:id\"`\n\tAppId          int    `json:\"AppId\" gorm:\"column:app_id\"`\n\tUin            string `json:\"Uin\" gorm:\"column:uin\"`\n\tName           string `json:\"Name\" gorm:\"column:name\"`\n\tDate           string `json:\"Date\" gorm:\"column:date\"`\n\tTotalChannel   int    `json:\"TotalChannel\" gorm:\"column:total_channel\"`     //总通道数\n\tOnlineChannel  int    `json:\"OnlineChannel\" gorm:\"column:online_channel\"`   //在线通道数\n\tOfflineChannel int    `json:\"OfflineChannel\" gorm:\"column:offline_channel\"` //离线通道数\n\tTotalDevice    int    `json:\"TotalDevice\" gorm:\"column:total_device\"`       //总设备数\n\tOnlineDevice   int    `json:\"OnlineDevice\" gorm:\"column:online_device\"`     //在线设备数\n\tOfflineDevice  int    `json:\"OfflineDevice\" gorm:\"column:offline_device\"`   //离线设备数\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-dbs.json"
  },
  {
    "function_name": "QueryUserDeviceUsage",
    "orm_code": "func (dus *DeviceUsageSource) QueryUserDeviceUsage() (*DeviceUsageSource, error) {\n\tvar usage DeviceUsageSource\n\terr := base.GetInstance().IvcDriver().Clauses(CommentBefore(ACT_SELECT, \"QueryUserDeviceUsage\")).Table(IvcUsageDeviceTable).\n\t\tWhere(map[string]interface{}{\"date\": dus.Date}).Scan(&usage).Error\n\tif err != nil {\n\t\tif err == db.ErrRecordNotFound {\n\t\t\treturn &usage, utils.RecordNotFoundError\n\t\t}\n\t\treturn &usage, err\n\t}\n\treturn &usage, nil\n}",
    "caller": "",
    "sql_statement_list": [
      "SELECT id, app_id, uin, name, date, total_channel, online_channel, offline_channel, total_device, online_device, offline_device FROM ivc_usage_device WHERE date = ?;"
    ],
    "sql_types": [
      "SELECT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/usage_summary.go",
        "code_start_line": 4,
        "code_end_line": 4,
        "code_key": "base",
        "code_value": "dbs/internal/base",
        "code_label": null,
        "code_type": 4,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 25,
        "code_end_line": 27,
        "code_key": "CommentBefore",
        "code_value": "func CommentBefore(Action, Callfunc string) hints.Hints {\n\treturn hints.CommentBefore(Action, fmt.Sprintf(Comment, Callfunc))\n}",
        "code_label": null,
        "code_type": 2,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 19,
        "code_end_line": 19,
        "code_key": "ACT_SELECT",
        "code_value": "const ACT_SELECT = \"SELECT\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/usage_summary.go",
        "code_start_line": 10,
        "code_end_line": 10,
        "code_key": "IvcUsageDeviceTable",
        "code_value": "const IvcUsageDeviceTable  = \"ivc_usage_device\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/usage_summary.go",
        "code_start_line": 63,
        "code_end_line": 63,
        "code_key": "usage",
        "code_value": "DeviceUsageSource",
        "code_label": null,
        "code_type": 31,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/usage_summary.go",
        "code_start_line": 16,
        "code_end_line": 28,
        "code_key": "DeviceUsageSource",
        "code_value": "type DeviceUsageSource struct {\n\tId             int    `json:\"Id\" gorm:\"column:id\"`\n\tAppId          int    `json:\"AppId\" gorm:\"column:app_id\"`\n\tUin            string `json:\"Uin\" gorm:\"column:uin\"`\n\tName           string `json:\"Name\" gorm:\"column:name\"`\n\tDate           string `json:\"Date\" gorm:\"column:date\"`\n\tTotalChannel   int    `json:\"TotalChannel\" gorm:\"column:total_channel\"`     //总通道数\n\tOnlineChannel  int    `json:\"OnlineChannel\" gorm:\"column:online_channel\"`   //在线通道数\n\tOfflineChannel int    `json:\"OfflineChannel\" gorm:\"column:offline_channel\"` //离线通道数\n\tTotalDevice    int    `json:\"TotalDevice\" gorm:\"column:total_device\"`       //总设备数\n\tOnlineDevice   int    `json:\"OnlineDevice\" gorm:\"column:online_device\"`     //在线设备数\n\tOfflineDevice  int    `json:\"OfflineDevice\" gorm:\"column:offline_device\"`   //离线设备数\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-dbs.json"
  },
  {
    "function_name": "InsertUserTrafficUsage",
    "orm_code": "func (tus *TrafficUsageSource) InsertUserTrafficUsage() (int, error) {\n\terr := base.GetInstance().IvcDriver().Clauses(CommentBefore(ACT_INSERT, \"InsertUserTrafficUsage\")).Table(IvcUsageTrafficTable).Create(tus).Error\n\tif err != nil {\n\t\treturn tus.Id, err\n\t}\n\treturn tus.Id, nil\n}",
    "caller": "",
    "sql_statement_list": [
      "/* INSERT InsertUserTrafficUsage */ INSERT INTO ivc_usage_traffic (id, app_id, uin, name, date, total_traffic, uplink_traffic, downlink_traffic) VALUES (?, ?, ?, ?, ?, ?, ?, ?);"
    ],
    "sql_types": [
      "OTHER"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/usage_summary.go",
        "code_start_line": 4,
        "code_end_line": 4,
        "code_key": "base",
        "code_value": "dbs/internal/base",
        "code_label": null,
        "code_type": 4,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 25,
        "code_end_line": 27,
        "code_key": "CommentBefore",
        "code_value": "func CommentBefore(Action, Callfunc string) hints.Hints {\n\treturn hints.CommentBefore(Action, fmt.Sprintf(Comment, Callfunc))\n}",
        "code_label": null,
        "code_type": 2,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 20,
        "code_end_line": 20,
        "code_key": "ACT_INSERT",
        "code_value": "const ACT_INSERT = \"INSERT\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/usage_summary.go",
        "code_start_line": 11,
        "code_end_line": 11,
        "code_key": "IvcUsageTrafficTable",
        "code_value": "const IvcUsageTrafficTable = \"ivc_usage_traffic\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/usage_summary.go",
        "code_start_line": 30,
        "code_end_line": 39,
        "code_key": "TrafficUsageSource",
        "code_value": "type TrafficUsageSource struct {\n\tId              int     `json:\"Id\" gorm:\"column:id\"`\n\tAppId           int     `json:\"AppId\" gorm:\"column:app_id\"`\n\tUin             string  `json:\"Uin\" gorm:\"column:uin\"`\n\tName            string  `json:\"Name\" gorm:\"column:name\"`\n\tDate            string  `json:\"Date\" gorm:\"column:date\"`\n\tTotalTraffic    float64 `json:\"TotalTraffic\" gorm:\"column:total_traffic\"`       //总流量\n\tUplinkTraffic   float64 `json:\"UplinkTraffic\" gorm:\"column:uplink_traffic\"`     //上行流量\n\tDownlinkTraffic float64 `json:\"DownlinkTraffic\" gorm:\"column:downlink_traffic\"` //下行流量\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-dbs.json"
  },
  {
    "function_name": "QueryUserTrafficUsage",
    "orm_code": "func (tus *TrafficUsageSource) QueryUserTrafficUsage() (*TrafficUsageSource, error) {\n\tvar usage TrafficUsageSource\n\terr := base.GetInstance().IvcDriver().Clauses(CommentBefore(ACT_SELECT, \"QueryUserTrafficUsage\")).Table(IvcUsageTrafficTable).\n\t\tWhere(map[string]interface{}{\"date\": tus.Date}).Scan(&usage).Error\n\tif err != nil {\n\t\tif err == db.ErrRecordNotFound {\n\t\t\treturn &usage, utils.RecordNotFoundError\n\t\t}\n\t\treturn &usage, err\n\t}\n\treturn &usage, nil\n}",
    "caller": "",
    "sql_statement_list": [
      "/* SELECT QueryUserTrafficUsage */ SELECT id, app_id, uin, name, date, total_traffic, uplink_traffic, downlink_traffic FROM ivc_usage_traffic WHERE date = ?;"
    ],
    "sql_types": [
      "OTHER"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/usage_summary.go",
        "code_start_line": 4,
        "code_end_line": 4,
        "code_key": "base",
        "code_value": "dbs/internal/base",
        "code_label": null,
        "code_type": 4,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 25,
        "code_end_line": 27,
        "code_key": "CommentBefore",
        "code_value": "func CommentBefore(Action, Callfunc string) hints.Hints {\n\treturn hints.CommentBefore(Action, fmt.Sprintf(Comment, Callfunc))\n}",
        "code_label": null,
        "code_type": 2,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 19,
        "code_end_line": 19,
        "code_key": "ACT_SELECT",
        "code_value": "const ACT_SELECT = \"SELECT\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/usage_summary.go",
        "code_start_line": 11,
        "code_end_line": 11,
        "code_key": "IvcUsageTrafficTable",
        "code_value": "const IvcUsageTrafficTable = \"ivc_usage_traffic\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/usage_summary.go",
        "code_start_line": 86,
        "code_end_line": 86,
        "code_key": "usage",
        "code_value": "TrafficUsageSource",
        "code_label": null,
        "code_type": 31,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/usage_summary.go",
        "code_start_line": 30,
        "code_end_line": 39,
        "code_key": "TrafficUsageSource",
        "code_value": "type TrafficUsageSource struct {\n\tId              int     `json:\"Id\" gorm:\"column:id\"`\n\tAppId           int     `json:\"AppId\" gorm:\"column:app_id\"`\n\tUin             string  `json:\"Uin\" gorm:\"column:uin\"`\n\tName            string  `json:\"Name\" gorm:\"column:name\"`\n\tDate            string  `json:\"Date\" gorm:\"column:date\"`\n\tTotalTraffic    float64 `json:\"TotalTraffic\" gorm:\"column:total_traffic\"`       //总流量\n\tUplinkTraffic   float64 `json:\"UplinkTraffic\" gorm:\"column:uplink_traffic\"`     //上行流量\n\tDownlinkTraffic float64 `json:\"DownlinkTraffic\" gorm:\"column:downlink_traffic\"` //下行流量\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-dbs.json"
  },
  {
    "function_name": "InsertUserStorageUsage",
    "orm_code": "func (sus *StorageUsageSource) InsertUserStorageUsage() (int, error) {\n\terr := base.GetInstance().IvcDriver().Clauses(CommentBefore(ACT_INSERT, \"InsertUserStorageUsage\")).Table(IvcUsageStorageTable).Create(sus).Error\n\tif err != nil {\n\t\treturn sus.Id, err\n\t}\n\treturn sus.Id, nil\n}",
    "caller": "",
    "sql_statement_list": [
      "INSERT INTO ivc_usage_storage (id, app_id, uin, name, date, total_storage, hot_storage, cold_storage) VALUES (?, ?, ?, ?, ?, ?, ?, ?);"
    ],
    "sql_types": [
      "INSERT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/usage_summary.go",
        "code_start_line": 4,
        "code_end_line": 4,
        "code_key": "base",
        "code_value": "dbs/internal/base",
        "code_label": null,
        "code_type": 4,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 25,
        "code_end_line": 27,
        "code_key": "CommentBefore",
        "code_value": "func CommentBefore(Action, Callfunc string) hints.Hints {\n\treturn hints.CommentBefore(Action, fmt.Sprintf(Comment, Callfunc))\n}",
        "code_label": null,
        "code_type": 2,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 20,
        "code_end_line": 20,
        "code_key": "ACT_INSERT",
        "code_value": "const ACT_INSERT = \"INSERT\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/usage_summary.go",
        "code_start_line": 12,
        "code_end_line": 12,
        "code_key": "IvcUsageStorageTable",
        "code_value": "const IvcUsageStorageTable = \"ivc_usage_storage\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/usage_summary.go",
        "code_start_line": 41,
        "code_end_line": 50,
        "code_key": "StorageUsageSource",
        "code_value": "type StorageUsageSource struct {\n\tId           int     `json:\"Id\" gorm:\"column:id\"`\n\tAppId        int     `json:\"AppId\" gorm:\"column:app_id\"`\n\tUin          string  `json:\"Uin\" gorm:\"column:uin\"`\n\tName         string  `json:\"Name\" gorm:\"column:name\"`\n\tDate         string  `json:\"Date\" gorm:\"column:date\"`\n\tTotalStorage float64 `json:\"TotalStorage\" gorm:\"column:total_storage\"` //总存储\n\tHotStorage   float64 `json:\"HotStorage\" gorm:\"column:hot_storage\"`     //热存储\n\tColdStorage  float64 `json:\"ColdStorage\" gorm:\"column:cold_storage\"`   //冷存储\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-dbs.json"
  },
  {
    "function_name": "QueryUserStorageUsage",
    "orm_code": "func (sus *StorageUsageSource) QueryUserStorageUsage() (*StorageUsageSource, error) {\n\tvar usage StorageUsageSource\n\terr := base.GetInstance().IvcDriver().Clauses(CommentBefore(ACT_SELECT, \"QueryUserStorageUsage\")).Table(IvcUsageStorageTable).\n\t\tWhere(map[string]interface{}{\"date\": sus.Date}).Scan(&usage).Error\n\tif err != nil {\n\t\tif err == db.ErrRecordNotFound {\n\t\t\treturn &usage, utils.RecordNotFoundError\n\t\t}\n\t\treturn &usage, err\n\t}\n\treturn &usage, nil\n}",
    "caller": "",
    "sql_statement_list": [
      "SELECT id, app_id, uin, name, date, total_storage, hot_storage, cold_storage FROM ivc_usage_storage WHERE date = ?;"
    ],
    "sql_types": [
      "SELECT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/usage_summary.go",
        "code_start_line": 4,
        "code_end_line": 4,
        "code_key": "base",
        "code_value": "dbs/internal/base",
        "code_label": null,
        "code_type": 4,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 25,
        "code_end_line": 27,
        "code_key": "CommentBefore",
        "code_value": "func CommentBefore(Action, Callfunc string) hints.Hints {\n\treturn hints.CommentBefore(Action, fmt.Sprintf(Comment, Callfunc))\n}",
        "code_label": null,
        "code_type": 2,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 19,
        "code_end_line": 19,
        "code_key": "ACT_SELECT",
        "code_value": "const ACT_SELECT = \"SELECT\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/usage_summary.go",
        "code_start_line": 12,
        "code_end_line": 12,
        "code_key": "IvcUsageStorageTable",
        "code_value": "const IvcUsageStorageTable = \"ivc_usage_storage\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/usage_summary.go",
        "code_start_line": 109,
        "code_end_line": 109,
        "code_key": "usage",
        "code_value": "StorageUsageSource",
        "code_label": null,
        "code_type": 31,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/usage_summary.go",
        "code_start_line": 41,
        "code_end_line": 50,
        "code_key": "StorageUsageSource",
        "code_value": "type StorageUsageSource struct {\n\tId           int     `json:\"Id\" gorm:\"column:id\"`\n\tAppId        int     `json:\"AppId\" gorm:\"column:app_id\"`\n\tUin          string  `json:\"Uin\" gorm:\"column:uin\"`\n\tName         string  `json:\"Name\" gorm:\"column:name\"`\n\tDate         string  `json:\"Date\" gorm:\"column:date\"`\n\tTotalStorage float64 `json:\"TotalStorage\" gorm:\"column:total_storage\"` //总存储\n\tHotStorage   float64 `json:\"HotStorage\" gorm:\"column:hot_storage\"`     //热存储\n\tColdStorage  float64 `json:\"ColdStorage\" gorm:\"column:cold_storage\"`   //冷存储\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-dbs.json"
  },
  {
    "function_name": "InsertAIUsage",
    "orm_code": "func (aus *AIUsageSource) InsertAIUsage() (int, error) {\n\terr := base.GetInstance().IvcDriver().Clauses(CommentBefore(ACT_INSERT, \"InsertAIUsage\")).Table(IvcUsageAITable).Create(aus).Error\n\tif err != nil {\n\t\treturn aus.Id, err\n\t}\n\treturn aus.Id, nil\n}",
    "caller": "",
    "sql_statement_list": [
      "INSERT INTO ivc_usage_ai (id, app_id, uin, name, date, field, amount, unit, price) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?);"
    ],
    "sql_types": [
      "INSERT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/usage_summary.go",
        "code_start_line": 4,
        "code_end_line": 4,
        "code_key": "base",
        "code_value": "dbs/internal/base",
        "code_label": null,
        "code_type": 4,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 25,
        "code_end_line": 27,
        "code_key": "CommentBefore",
        "code_value": "func CommentBefore(Action, Callfunc string) hints.Hints {\n\treturn hints.CommentBefore(Action, fmt.Sprintf(Comment, Callfunc))\n}",
        "code_label": null,
        "code_type": 2,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 20,
        "code_end_line": 20,
        "code_key": "ACT_INSERT",
        "code_value": "const ACT_INSERT = \"INSERT\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/usage_summary.go",
        "code_start_line": 13,
        "code_end_line": 13,
        "code_key": "IvcUsageAITable",
        "code_value": "const IvcUsageAITable      = \"ivc_usage_ai\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/usage_summary.go",
        "code_start_line": 214,
        "code_end_line": 224,
        "code_key": "AIUsageSource",
        "code_value": "type AIUsageSource struct {\n\tId     int     `json:\"Id\" gorm:\"column:id\"`\n\tAppId  int     `json:\"AppId\" gorm:\"column:app_id\"`\n\tUin    string  `json:\"Uin\" gorm:\"column:uin\"`\n\tName   string  `json:\"Name\" gorm:\"column:name\"`\n\tDate   string  `json:\"Date\" gorm:\"column:date\"`\n\tField  string  `json:\"Field\" gorm:\"column:field\"`   //计费指标\n\tAmount float64 `json:\"Amount\" gorm:\"column:amount\"` //用量\n\tUnit   string  `json:\"Unit\" gorm:\"column:unit\"`     //单位\n\tPrice  float64 `json:\"Price\" gorm:\"column:price\"`   //价格\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-dbs.json"
  },
  {
    "function_name": "QueryAIUsage",
    "orm_code": "func (uss *AIUsageSource) QueryAIUsage() (*AIUsageSource, error) {\n\tvar usage AIUsageSource\n\terr := base.GetInstance().IvcDriver().Clauses(CommentBefore(ACT_SELECT, \"QueryAIUsage\")).Table(IvcUsageAITable).\n\t\tWhere(map[string]interface{}{\"date\": uss.Date}).Scan(&usage).Error\n\tif err != nil {\n\t\tif err == db.ErrRecordNotFound {\n\t\t\treturn &usage, utils.RecordNotFoundError\n\t\t}\n\t\treturn &usage, err\n\t}\n\treturn &usage, nil\n}",
    "caller": "",
    "sql_statement_list": [
      "SELECT id, app_id, uin, name, date, field, amount, unit, price FROM ivc_usage_ai WHERE date = ?;"
    ],
    "sql_types": [
      "SELECT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/usage_summary.go",
        "code_start_line": 4,
        "code_end_line": 4,
        "code_key": "base",
        "code_value": "dbs/internal/base",
        "code_label": null,
        "code_type": 4,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 25,
        "code_end_line": 27,
        "code_key": "CommentBefore",
        "code_value": "func CommentBefore(Action, Callfunc string) hints.Hints {\n\treturn hints.CommentBefore(Action, fmt.Sprintf(Comment, Callfunc))\n}",
        "code_label": null,
        "code_type": 2,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 19,
        "code_end_line": 19,
        "code_key": "ACT_SELECT",
        "code_value": "const ACT_SELECT = \"SELECT\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/usage_summary.go",
        "code_start_line": 13,
        "code_end_line": 13,
        "code_key": "IvcUsageAITable",
        "code_value": "const IvcUsageAITable      = \"ivc_usage_ai\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/usage_summary.go",
        "code_start_line": 237,
        "code_end_line": 237,
        "code_key": "usage",
        "code_value": "AIUsageSource",
        "code_label": null,
        "code_type": 31,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/usage_summary.go",
        "code_start_line": 214,
        "code_end_line": 224,
        "code_key": "AIUsageSource",
        "code_value": "type AIUsageSource struct {\n\tId     int     `json:\"Id\" gorm:\"column:id\"`\n\tAppId  int     `json:\"AppId\" gorm:\"column:app_id\"`\n\tUin    string  `json:\"Uin\" gorm:\"column:uin\"`\n\tName   string  `json:\"Name\" gorm:\"column:name\"`\n\tDate   string  `json:\"Date\" gorm:\"column:date\"`\n\tField  string  `json:\"Field\" gorm:\"column:field\"`   //计费指标\n\tAmount float64 `json:\"Amount\" gorm:\"column:amount\"` //用量\n\tUnit   string  `json:\"Unit\" gorm:\"column:unit\"`     //单位\n\tPrice  float64 `json:\"Price\" gorm:\"column:price\"`   //价格\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-dbs.json"
  },
  {
    "function_name": "FindUserDeviceChannelSourceList",
    "orm_code": "func FindUserDeviceChannelSourceList() ([]DeviceUsageSource, error) {\n\tdus := make([]DeviceUsageSource, 0)\n\tsql := \"SELECT d.app_id, COUNT(c.id) AS total_channel, (SELECT COUNT(*) FROM ivc_device d2 \" +\n\t\t\"WHERE d2.app_id = d.app_id AND d2.deleted_at IS NULL) AS total_device FROM ivc_channel AS c \" +\n\t\t\"INNER JOIN ivc_device AS d ON c.device_id = d.id WHERE d.deleted_at IS NULL AND c.deleted_at IS NULL \" +\n\t\t\"GROUP BY d.app_id;\"\n\terr := base.GetInstance().IvcDriver().Raw(fmt.Sprintf(\"/* \"+Comment+\" */\", \"FindUserDeviceChannelSourceList\") + sql).Scan(&dus).Error\n\tif err != nil {\n\t\tif err == db.ErrRecordNotFound {\n\t\t\treturn dus, utils.RecordNotFoundError\n\t\t}\n\t\treturn dus, err\n\t}\n\treturn dus, nil\n}",
    "caller": "",
    "sql_statement_list": [
      "SELECT d.app_id, COUNT(c.id) AS total_channel, (SELECT COUNT(*) FROM ivc_device d2 WHERE d2.app_id = d.app_id AND d2.deleted_at IS NULL) AS total_device FROM ivc_channel AS c INNER JOIN ivc_device AS d ON c.device_id = d.id WHERE d.deleted_at IS NULL AND c.deleted_at IS NULL GROUP BY d.app_id;"
    ],
    "sql_types": [
      "SELECT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/device.go",
        "code_start_line": 9,
        "code_end_line": 9,
        "code_key": "base",
        "code_value": "dbs/internal/base",
        "code_label": null,
        "code_type": 4,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/device.go",
        "code_start_line": 48,
        "code_end_line": 48,
        "code_key": "sql",
        "code_value": "\"SELECT d.app_id, COUNT(c.id) AS total_channel, (SELECT COUNT(*) FROM ivc_device d2 \" +\n\t\t\"WHERE d2.app_id = d.app_id AND d2.deleted_at IS NULL) AS total_device FROM ivc_channel AS c \" +\n\t\t\"INNER JOIN ivc_device AS d ON c.device_id = d.id WHERE d.deleted_at IS NULL AND c.deleted_at IS NULL \" +\n\t\t\"GROUP BY d.app_id;\"",
        "code_label": null,
        "code_type": 35,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/device.go",
        "code_start_line": 47,
        "code_end_line": 47,
        "code_key": "dus",
        "code_value": "make([]DeviceUsageSource, 0)",
        "code_label": null,
        "code_type": 35,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/usage_summary.go",
        "code_start_line": 16,
        "code_end_line": 28,
        "code_key": "DeviceUsageSource",
        "code_value": "type DeviceUsageSource struct {\n\tId             int    `json:\"Id\" gorm:\"column:id\"`\n\tAppId          int    `json:\"AppId\" gorm:\"column:app_id\"`\n\tUin            string `json:\"Uin\" gorm:\"column:uin\"`\n\tName           string `json:\"Name\" gorm:\"column:name\"`\n\tDate           string `json:\"Date\" gorm:\"column:date\"`\n\tTotalChannel   int    `json:\"TotalChannel\" gorm:\"column:total_channel\"`     //总通道数\n\tOnlineChannel  int    `json:\"OnlineChannel\" gorm:\"column:online_channel\"`   //在线通道数\n\tOfflineChannel int    `json:\"OfflineChannel\" gorm:\"column:offline_channel\"` //离线通道数\n\tTotalDevice    int    `json:\"TotalDevice\" gorm:\"column:total_device\"`       //总设备数\n\tOnlineDevice   int    `json:\"OnlineDevice\" gorm:\"column:online_device\"`     //在线设备数\n\tOfflineDevice  int    `json:\"OfflineDevice\" gorm:\"column:offline_device\"`   //离线设备数\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-dbs.json"
  },
  {
    "function_name": "FindUserDeviceChannelSourceList",
    "orm_code": "func FindUserDeviceChannelSourceList() ([]DeviceUsageSource, error) {\n\tdus := make([]DeviceUsageSource, 0)\n\tsql := \"SELECT d.app_id, COUNT(c.id) AS total_channel, (SELECT COUNT(*) FROM ivc_device d2 \" +\n\t\t\"WHERE d2.app_id = d.app_id AND d2.deleted_at IS NULL) AS total_device FROM ivc_channel AS c \" +\n\t\t\"INNER JOIN ivc_device AS d ON c.device_id = d.id WHERE d.deleted_at IS NULL AND c.deleted_at IS NULL \" +\n\t\t\"GROUP BY d.app_id;\"\n\terr := base.GetInstance().IvcDriver().Raw(fmt.Sprintf(\"/* \"+Comment+\" */\", \"FindUserDeviceChannelSourceList\") + sql).Scan(&dus).Error\n\tif err != nil {\n\t\tif err == db.ErrRecordNotFound {\n\t\t\treturn dus, utils.RecordNotFoundError\n\t\t}\n\t\treturn dus, err\n\t}\n\treturn dus, nil\n}",
    "caller": "func SyncUserDeviceMapToCache(log *logger.IvcLog) (map[int]DeviceUsageSource, error) {\n\t// 判断dssUserInfoKey是否过期，过期则查库获取数据，未过期则直接从dss缓存中获取数据\n\tdsMap := make(map[int]DeviceUsageSource)\n\tif !IsExistDssUserInfo() {\n\t\tlog.WarnV(fmt.Sprintf(\"[SyncUserDeviceMapToCache] DssUserInfoKey does not exist, get DeviceUsageSource from the database.\"))\n\t\tdus, err := FindUserDeviceChannelSourceList()\n\t\tif err != nil {\n\t\t\tlog.ErrorV(fmt.Sprintf(\"[SyncUserDeviceMapToCache] FindUserDeviceChannelSourceList err:%v\", err))\n\t\t\treturn dsMap, err\n\t\t}\n\t\tfor _, du := range dus {\n\t\t\tdsMap[du.AppId] = DeviceUsageSource{\n\t\t\t\tAppId:        du.AppId,\n\t\t\t\tTotalDevice:  du.TotalDevice,\n\t\t\t\tTotalChannel: du.TotalChannel,\n\t\t\t}\n\t\t}\n\t} else {\n\t\t// 从dss服务获取分钟级缓存数据\n\t\tusers, err := GetUserInfoList(log)\n\t\tif err != nil {\n\t\t\tlog.ErrorV(fmt.Sprintf(\"[SyncUserDeviceMapToCache] GetUserInfoList err:%v\", err))\n\t\t\treturn dsMap, err\n\t\t}\n\t\tfor _, u := range users {\n\t\t\tdMetrics, err := GetCacheEveryMinuteDeviceData(log, u.AppId)\n\t\t\tif err != nil {\n\t\t\t\tlog.ErrorV(fmt.Sprintf(\"[SyncUserDeviceMapToCache] GetCacheEveryMinuteDeviceData appId:%v err:%v\", u.AppId, err))\n\t\t\t\tcontinue\n\t\t\t}\n\t\t\tdsMap[u.AppId] = DeviceUsageSource{\n\t\t\t\tAppId:        u.AppId,\n\t\t\t\tTotalDevice:  dMetrics.Total.DeviceTotal,\n\t\t\t\tTotalChannel: dMetrics.Total.ChannelTotal,\n\t\t\t}\n\t\t}\n\t}\n\tv, err := json.Marshal(dsMap)\n\tif err != nil {\n\t\tlog.ErrorV(fmt.Sprintf(\"[SyncUserDeviceMapToCache] Marshal DeviceUsageSourceMap err:%v\", err))\n\t\treturn dsMap, err\n\t}\n\terr = base.GetInstance().Redis().Set(context.TODO(), fmt.Sprintf(DeviceMetricsStrKey), string(v), DefaultExpiredTimeout).Err()\n\tif err != nil {\n\t\tlog.ErrorV(fmt.Sprintf(\"[SyncUserDeviceMapToCache] write cache err:%v\", err))\n\t\treturn dsMap, err\n\t}\n\treturn dsMap, nil\n}",
    "sql_statement_list": [
      "SELECT d.app_id, COUNT(c.id) AS total_channel, (SELECT COUNT(*) FROM ivc_device d2 WHERE d2.app_id = d.app_id AND d2.deleted_at IS NULL) AS total_device FROM ivc_channel AS c INNER JOIN ivc_device AS d ON c.device_id = d.id WHERE d.deleted_at IS NULL AND c.deleted_at IS NULL GROUP BY d.app_id;"
    ],
    "sql_statement": "基于调用者上下文分析，该ORM代码在`SyncUserDeviceMapToCache`函数调用时会生成以下SQL语句：\n\n## 执行路径分析\n\n根据调用者代码，`FindUserDeviceChannelSourceList`函数只在特定条件下被调用：\n- 当`!IsExistDssUserInfo()`为true时（即DssUserInfoKey不存在或过期时）\n- 此时会执行数据库查询获取设备使用情况数据\n\n## 生成的SQL语句\n\n该函数会生成1条SQL语句：\n\n```sql\n/* FindUserDeviceChannelSourceList */\nSELECT d.app_id, \n       COUNT(c.id) AS total_channel, \n       (SELECT COUNT(*) \n        FROM ivc_device d2 \n        WHERE d2.app_id = d.app_id AND d2.deleted_at IS NULL) AS total_device \nFROM ivc_channel AS c \nINNER JOIN ivc_device AS d ON c.device_id = d.id \nWHERE d.deleted_at IS NULL AND c.deleted_at IS NULL \nGROUP BY d.app_id;\n```\n\n## SQL语句分析\n\n**操作类型**: SELECT查询（原生SQL）\n\n**涉及表**:\n- `ivc_channel` (别名: c) - 主表\n- `ivc_device` (别名: d) - 关联表  \n- `ivc_device` (别名: d2) - 子查询中的表\n\n**查询逻辑**:\n1. **主查询**: 通过INNER JOIN连接channel表和device表\n2. **关联条件**: `c.device_id = d.id`\n3. **过滤条件**: 排除软删除的记录（deleted_at IS NULL）\n4. **聚合统计**: \n   - 按app_id分组\n   - 统计每个app_id下的channel数量\n   - 通过子查询统计每个app_id下的device总数\n5. **子查询**: 独立统计每个app_id对应的设备总数\n\n**返回结果**: 每个app_id的设备和通道使用统计数据，用于后续的缓存存储和数据同步。\n\n**调用上下文**: 该SQL只在缓存失效时执行，作为从数据库重新获取统计数据的备用方案。",
    "verified_sql": "检查分析结果，我发现这是一个正常的SQL分析，没有边界条件标记。让我验证SQL语句的准确性：\n\n**验证结果**：\n1. **表名验证**：`ivc_channel`、`ivc_device` - 正确，这些是代码中明确指定的表名\n2. **字段映射验证**：所有字段名都是在原生SQL中直接指定的，应按原样保留\n3. **JOIN操作验证**：表别名使用正确，ON条件格式正确\n4. **调用者上下文验证**：分析正确识别了只在特定条件下执行的路径\n5. **SQL完整性验证**：SQL语句完整可执行，包含所有必要的字段\n\n分析准确，SQL语句正确。\n\n```json\n[\n  \"/* FindUserDeviceChannelSourceList */SELECT d.app_id, COUNT(c.id) AS total_channel, (SELECT COUNT(*) FROM ivc_device d2 WHERE d2.app_id = d.app_id AND d2.deleted_at IS NULL) AS total_device FROM ivc_channel AS c INNER JOIN ivc_device AS d ON c.device_id = d.id WHERE d.deleted_at IS NULL AND c.deleted_at IS NULL GROUP BY d.app_id;\"\n]\n```",
    "sql_types": [
      "SELECT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/device.go",
        "code_start_line": 9,
        "code_end_line": 9,
        "code_key": "base",
        "code_value": "dbs/internal/base",
        "code_label": null,
        "code_type": 4,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/device.go",
        "code_start_line": 48,
        "code_end_line": 48,
        "code_key": "sql",
        "code_value": "\"SELECT d.app_id, COUNT(c.id) AS total_channel, (SELECT COUNT(*) FROM ivc_device d2 \" +\n\t\t\"WHERE d2.app_id = d.app_id AND d2.deleted_at IS NULL) AS total_device FROM ivc_channel AS c \" +\n\t\t\"INNER JOIN ivc_device AS d ON c.device_id = d.id WHERE d.deleted_at IS NULL AND c.deleted_at IS NULL \" +\n\t\t\"GROUP BY d.app_id;\"",
        "code_label": null,
        "code_type": 35,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/device.go",
        "code_start_line": 47,
        "code_end_line": 47,
        "code_key": "dus",
        "code_value": "make([]DeviceUsageSource, 0)",
        "code_label": null,
        "code_type": 35,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/usage_summary.go",
        "code_start_line": 16,
        "code_end_line": 28,
        "code_key": "DeviceUsageSource",
        "code_value": "type DeviceUsageSource struct {\n\tId             int    `json:\"Id\" gorm:\"column:id\"`\n\tAppId          int    `json:\"AppId\" gorm:\"column:app_id\"`\n\tUin            string `json:\"Uin\" gorm:\"column:uin\"`\n\tName           string `json:\"Name\" gorm:\"column:name\"`\n\tDate           string `json:\"Date\" gorm:\"column:date\"`\n\tTotalChannel   int    `json:\"TotalChannel\" gorm:\"column:total_channel\"`     //总通道数\n\tOnlineChannel  int    `json:\"OnlineChannel\" gorm:\"column:online_channel\"`   //在线通道数\n\tOfflineChannel int    `json:\"OfflineChannel\" gorm:\"column:offline_channel\"` //离线通道数\n\tTotalDevice    int    `json:\"TotalDevice\" gorm:\"column:total_device\"`       //总设备数\n\tOnlineDevice   int    `json:\"OnlineDevice\" gorm:\"column:online_device\"`     //在线设备数\n\tOfflineDevice  int    `json:\"OfflineDevice\" gorm:\"column:offline_device\"`   //离线设备数\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-dbs.json"
  },
  {
    "function_name": "InsertIncomeSummary",
    "orm_code": "func (iss *IncomeSummarySource) InsertIncomeSummary() (int, error) {\n\terr := base.GetInstance().IvcDriver().Clauses(CommentBefore(ACT_INSERT, \"InsertIncomeSummary\")).Table(IvcIncomeSummaryTable).Create(iss).Error\n\tif err != nil {\n\t\treturn iss.Id, err\n\t}\n\treturn iss.Id, nil\n}",
    "caller": "",
    "sql_statement_list": [
      "INSERT INTO ivc_income_summary (id, date, total_users, enterprise_paid_users, personal_paid_users, actual_total_receivable, postpaid_receivable, prepaid_receivable_deduction, prepaid_receivable) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?);"
    ],
    "sql_types": [
      "INSERT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/income_summary.go",
        "code_start_line": 4,
        "code_end_line": 4,
        "code_key": "base",
        "code_value": "dbs/internal/base",
        "code_label": null,
        "code_type": 4,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 25,
        "code_end_line": 27,
        "code_key": "CommentBefore",
        "code_value": "func CommentBefore(Action, Callfunc string) hints.Hints {\n\treturn hints.CommentBefore(Action, fmt.Sprintf(Comment, Callfunc))\n}",
        "code_label": null,
        "code_type": 2,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 20,
        "code_end_line": 20,
        "code_key": "ACT_INSERT",
        "code_value": "const ACT_INSERT = \"INSERT\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/income_summary.go",
        "code_start_line": 9,
        "code_end_line": 9,
        "code_key": "IvcIncomeSummaryTable",
        "code_value": "const IvcIncomeSummaryTable = \"ivc_income_summary\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/income_summary.go",
        "code_start_line": 11,
        "code_end_line": 21,
        "code_key": "IncomeSummarySource",
        "code_value": "type IncomeSummarySource struct {\n\tId                         int     `json:\"Id\" gorm:\"column:id\"`\n\tDate                       string  `json:\"Date\" gorm:\"column:date\"`\n\tTotalUsers                 int     `json:\"TotalUsers\" gorm:\"column:total_users\"`                                               //总用户数\n\tEnterprisePaidUsers        int     `json:\"EnterprisePaidUsers\" gorm:\"column:enterprise_paid_users\"`                            //企业付费用户数\n\tPersonalPaidUsers          int     `json:\"PersonalPaidUsers\" gorm:\"column:personal_paid_users\"`                                //个人付费用户数\n\tActualTotalReceivable      float64 `json:\"ActualTotalReceivable\" gorm:\"column:actual_total_receivable;default:NULL\"`           //实际总应收\n\tPostpaidReceivable         float64 `json:\"PostpaidReceivable\" gorm:\"column:postpaid_receivable;default:NULL\"`                  //后付费应收\n\tPrepaidReceivableDeduction float64 `json:\"PrepaidReceivableDeduction\" gorm:\"column:prepaid_receivable_deduction;default:NULL\"` //预付费抵扣应收\n\tPrepaidReceivable          float64 `json:\"PrepaidReceivable\" gorm:\"column:prepaid_receivable;default:NULL\"`                    //预付费应收\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-dbs.json"
  },
  {
    "function_name": "QueryIncomeSummary",
    "orm_code": "func (iss *IncomeSummarySource) QueryIncomeSummary() (*IncomeSummarySource, error) {\n\tvar incomes IncomeSummarySource\n\terr := base.GetInstance().IvcDriver().Clauses(CommentBefore(ACT_SELECT, \"QueryIncomeSummary\")).Table(IvcIncomeSummaryTable).\n\t\tWhere(map[string]interface{}{\"date\": iss.Date}).Scan(&incomes).Error\n\tif err != nil {\n\t\tif err == db.ErrRecordNotFound {\n\t\t\treturn &incomes, utils.RecordNotFoundError\n\t\t}\n\t\treturn &incomes, err\n\t}\n\treturn &incomes, nil\n}",
    "caller": "",
    "sql_statement_list": [
      "SELECT id, date, total_users, enterprise_paid_users, personal_paid_users, actual_total_receivable, postpaid_receivable, prepaid_receivable_deduction, prepaid_receivable FROM ivc_income_summary WHERE date = ?;"
    ],
    "sql_types": [
      "SELECT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/income_summary.go",
        "code_start_line": 4,
        "code_end_line": 4,
        "code_key": "base",
        "code_value": "dbs/internal/base",
        "code_label": null,
        "code_type": 4,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 25,
        "code_end_line": 27,
        "code_key": "CommentBefore",
        "code_value": "func CommentBefore(Action, Callfunc string) hints.Hints {\n\treturn hints.CommentBefore(Action, fmt.Sprintf(Comment, Callfunc))\n}",
        "code_label": null,
        "code_type": 2,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 19,
        "code_end_line": 19,
        "code_key": "ACT_SELECT",
        "code_value": "const ACT_SELECT = \"SELECT\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/income_summary.go",
        "code_start_line": 9,
        "code_end_line": 9,
        "code_key": "IvcIncomeSummaryTable",
        "code_value": "const IvcIncomeSummaryTable = \"ivc_income_summary\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/income_summary.go",
        "code_start_line": 34,
        "code_end_line": 34,
        "code_key": "incomes",
        "code_value": "IncomeSummarySource",
        "code_label": null,
        "code_type": 31,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/income_summary.go",
        "code_start_line": 11,
        "code_end_line": 21,
        "code_key": "IncomeSummarySource",
        "code_value": "type IncomeSummarySource struct {\n\tId                         int     `json:\"Id\" gorm:\"column:id\"`\n\tDate                       string  `json:\"Date\" gorm:\"column:date\"`\n\tTotalUsers                 int     `json:\"TotalUsers\" gorm:\"column:total_users\"`                                               //总用户数\n\tEnterprisePaidUsers        int     `json:\"EnterprisePaidUsers\" gorm:\"column:enterprise_paid_users\"`                            //企业付费用户数\n\tPersonalPaidUsers          int     `json:\"PersonalPaidUsers\" gorm:\"column:personal_paid_users\"`                                //个人付费用户数\n\tActualTotalReceivable      float64 `json:\"ActualTotalReceivable\" gorm:\"column:actual_total_receivable;default:NULL\"`           //实际总应收\n\tPostpaidReceivable         float64 `json:\"PostpaidReceivable\" gorm:\"column:postpaid_receivable;default:NULL\"`                  //后付费应收\n\tPrepaidReceivableDeduction float64 `json:\"PrepaidReceivableDeduction\" gorm:\"column:prepaid_receivable_deduction;default:NULL\"` //预付费抵扣应收\n\tPrepaidReceivable          float64 `json:\"PrepaidReceivable\" gorm:\"column:prepaid_receivable;default:NULL\"`                    //预付费应收\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-dbs.json"
  },
  {
    "function_name": "InsertUserConsume",
    "orm_code": "func (css *ConsumeSummarySource) InsertUserConsume() (int, error) {\n\terr := base.GetInstance().IvcDriver().Clauses(CommentBefore(ACT_INSERT, \"InsertUserConsume\")).Table(IvcUserConsumeTable).Create(css).Error\n\tif err != nil {\n\t\treturn css.Id, err\n\t}\n\treturn css.Id, nil\n}",
    "caller": "",
    "sql_statement_list": [
      "INSERT INTO ivc_user_consume (id, app_id, uin, name, corporate, channel_mark, income_industry_name, date, actual_consume, prepaid_consume, device_overall_consume, online_channel_consume, device_consume, upload_network_consume, download_network_consume, hot_storage_consume, cold_storage_consume, ai_consume) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?);"
    ],
    "sql_types": [
      "INSERT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/consume_summary.go",
        "code_start_line": 4,
        "code_end_line": 4,
        "code_key": "base",
        "code_value": "dbs/internal/base",
        "code_label": null,
        "code_type": 4,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 25,
        "code_end_line": 27,
        "code_key": "CommentBefore",
        "code_value": "func CommentBefore(Action, Callfunc string) hints.Hints {\n\treturn hints.CommentBefore(Action, fmt.Sprintf(Comment, Callfunc))\n}",
        "code_label": null,
        "code_type": 2,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 20,
        "code_end_line": 20,
        "code_key": "ACT_INSERT",
        "code_value": "const ACT_INSERT = \"INSERT\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/consume_summary.go",
        "code_start_line": 10,
        "code_end_line": 10,
        "code_key": "IvcUserConsumeTable",
        "code_value": "const IvcUserConsumeTable = \"ivc_user_consume\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/consume_summary.go",
        "code_start_line": 32,
        "code_end_line": 51,
        "code_key": "ConsumeSummarySource",
        "code_value": "type ConsumeSummarySource struct {\n\tId                     int     `json:\"Id\" gorm:\"column:id\"`\n\tAppId                  int     `json:\"AppId\" gorm:\"column:app_id\"`\n\tUin                    string  `json:\"Uin\" gorm:\"column:uin\"`\n\tName                   string  `json:\"Name\" gorm:\"column:name\"`\n\tCorporate              int     `json:\"Corporate\" gorm:\"column:corporate\"`                     //0:个人客户 1:企业客户\n\tChannelMark            string  `json:\"ChannelMark\" gorm:\"column:channel_mark\"`                //用户来源\n\tIncomeIndustryName     string  `json:\"IncomeIndustryName\" gorm:\"column:income_industry_name\"` //行业\n\tDate                   string  `json:\"Date\" gorm:\"column:date\"`\n\tActualConsume          float64 `json:\"ActualConsume\" gorm:\"column:actual_consume\"`                                 //实际消耗\n\tPrepaidConsume         float64 `json:\"PrepaidConsume\" gorm:\"column:prepaid_consume\"`                               //预付费实际消耗\n\tDeviceOverallConsume   float64 `json:\"DeviceOverallConsume\" gorm:\"column:device_overall_consume;default:NULL\"`     //设备综合管理费\n\tOnlineChannelConsume   float64 `json:\"OnlineChannelConsume\" gorm:\"column:online_channel_consume;default:NULL\"`     //在线通道管理费\n\tDeviceConsume          float64 `json:\"DeviceConsume\" gorm:\"column:device_consume;default:NULL\"`                    //设备管理消耗\n\tUploadNetworkConsume   float64 `json:\"UploadNetworkConsume\" gorm:\"column:upload_network_consume;default:NULL\"`     //上行网络消耗\n\tDownloadNetworkConsume float64 `json:\"DownloadNetworkConsume\" gorm:\"column:download_network_consume;default:NULL\"` //下行网络消耗\n\tHotStorageConsume      float64 `json:\"HotStorageConsume\" gorm:\"column:hot_storage_consume;default:NULL\"`           //热存储消耗\n\tColdStorageConsume     float64 `json:\"ColdStorageConsume\" gorm:\"column:cold_storage_consume;default:NULL\"`         //冷存储消耗\n\tAIConsume              float64 `json:\"AIConsume\" gorm:\"column:ai_consume;default:NULL\"`                            //AI消耗\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-dbs.json"
  },
  {
    "function_name": "QueryUserConsume",
    "orm_code": "func (css *ConsumeSummarySource) QueryUserConsume() (*ConsumeSummarySource, error) {\n\tvar consume ConsumeSummarySource\n\terr := base.GetInstance().IvcDriver().Clauses(CommentBefore(ACT_SELECT, \"QueryUserConsume\")).Table(IvcUserConsumeTable).\n\t\tWhere(map[string]interface{}{\"date\": css.Date}).Scan(&consume).Error\n\tif err != nil {\n\t\tif err == db.ErrRecordNotFound {\n\t\t\treturn &consume, utils.RecordNotFoundError\n\t\t}\n\t\treturn &consume, err\n\t}\n\treturn &consume, nil\n}",
    "caller": "",
    "sql_statement_list": [
      "SELECT id, app_id, uin, name, corporate, channel_mark, income_industry_name, date, actual_consume, prepaid_consume, device_overall_consume, online_channel_consume, device_consume, upload_network_consume, download_network_consume, hot_storage_consume, cold_storage_consume, ai_consume FROM ivc_user_consume WHERE date = ?;"
    ],
    "sql_types": [
      "SELECT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/consume_summary.go",
        "code_start_line": 4,
        "code_end_line": 4,
        "code_key": "base",
        "code_value": "dbs/internal/base",
        "code_label": null,
        "code_type": 4,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 25,
        "code_end_line": 27,
        "code_key": "CommentBefore",
        "code_value": "func CommentBefore(Action, Callfunc string) hints.Hints {\n\treturn hints.CommentBefore(Action, fmt.Sprintf(Comment, Callfunc))\n}",
        "code_label": null,
        "code_type": 2,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/bucket_whitelist.go",
        "code_start_line": 19,
        "code_end_line": 19,
        "code_key": "ACT_SELECT",
        "code_value": "const ACT_SELECT = \"SELECT\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/consume_summary.go",
        "code_start_line": 10,
        "code_end_line": 10,
        "code_key": "IvcUserConsumeTable",
        "code_value": "const IvcUserConsumeTable = \"ivc_user_consume\"",
        "code_label": 21,
        "code_type": 1,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/consume_summary.go",
        "code_start_line": 64,
        "code_end_line": 64,
        "code_key": "consume",
        "code_value": "ConsumeSummarySource",
        "code_label": null,
        "code_type": 31,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      },
      {
        "code_file": "/Users/ymhuan/code/aid-db/temp/aid-main/aid/risk_sql/code/scripts/IVC__ivc-dbs/internal/model/consume_summary.go",
        "code_start_line": 32,
        "code_end_line": 51,
        "code_key": "ConsumeSummarySource",
        "code_value": "type ConsumeSummarySource struct {\n\tId                     int     `json:\"Id\" gorm:\"column:id\"`\n\tAppId                  int     `json:\"AppId\" gorm:\"column:app_id\"`\n\tUin                    string  `json:\"Uin\" gorm:\"column:uin\"`\n\tName                   string  `json:\"Name\" gorm:\"column:name\"`\n\tCorporate              int     `json:\"Corporate\" gorm:\"column:corporate\"`                     //0:个人客户 1:企业客户\n\tChannelMark            string  `json:\"ChannelMark\" gorm:\"column:channel_mark\"`                //用户来源\n\tIncomeIndustryName     string  `json:\"IncomeIndustryName\" gorm:\"column:income_industry_name\"` //行业\n\tDate                   string  `json:\"Date\" gorm:\"column:date\"`\n\tActualConsume          float64 `json:\"ActualConsume\" gorm:\"column:actual_consume\"`                                 //实际消耗\n\tPrepaidConsume         float64 `json:\"PrepaidConsume\" gorm:\"column:prepaid_consume\"`                               //预付费实际消耗\n\tDeviceOverallConsume   float64 `json:\"DeviceOverallConsume\" gorm:\"column:device_overall_consume;default:NULL\"`     //设备综合管理费\n\tOnlineChannelConsume   float64 `json:\"OnlineChannelConsume\" gorm:\"column:online_channel_consume;default:NULL\"`     //在线通道管理费\n\tDeviceConsume          float64 `json:\"DeviceConsume\" gorm:\"column:device_consume;default:NULL\"`                    //设备管理消耗\n\tUploadNetworkConsume   float64 `json:\"UploadNetworkConsume\" gorm:\"column:upload_network_consume;default:NULL\"`     //上行网络消耗\n\tDownloadNetworkConsume float64 `json:\"DownloadNetworkConsume\" gorm:\"column:download_network_consume;default:NULL\"` //下行网络消耗\n\tHotStorageConsume      float64 `json:\"HotStorageConsume\" gorm:\"column:hot_storage_consume;default:NULL\"`           //热存储消耗\n\tColdStorageConsume     float64 `json:\"ColdStorageConsume\" gorm:\"column:cold_storage_consume;default:NULL\"`         //冷存储消耗\n\tAIConsume              float64 `json:\"AIConsume\" gorm:\"column:ai_consume;default:NULL\"`                            //AI消耗\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "0670cc8c51513604a00932c6f5b44b5bb19a35c8"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-dbs.json"
  }
]