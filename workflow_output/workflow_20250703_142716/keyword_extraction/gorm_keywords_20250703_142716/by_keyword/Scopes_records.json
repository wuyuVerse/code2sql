[
  {
    "function_name": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/model/bucket.go:38:63:FindBucketWhitelists",
    "orm_code": "func (b *Bucket) FindBucketWhitelists(filterSource map[string]interface{}, page, size int) ([]types.BucketSource, error) {\n\tbs := make([]types.BucketSource, 0)\n\tvar err error\n\tcomment := b.CommentFunc(SELECT_COMMENT)\n\tif name, ok := filterSource[\"name\"]; ok {\n\t\tfilter := make(map[string]interface{})\n\t\tfor k, v := range filterSource {\n\t\t\tif k == \"name\" {\n\t\t\t\tcontinue\n\t\t\t}\n\t\t\tfilter[k] = v\n\t\t}\n\t\terr = base.GetInstance().IvcDriver().Clauses(comment).Table(IvcBucketWhitelistTable).Order(\"id\").Scopes(PaginateDB(page, size)).\n\t\t\tWhere(filter).Where(\"name like ?\", \"%\"+name.(string)+\"%\").Find(&bs).Error\n\t} else {\n\t\terr = base.GetInstance().IvcDriver().Clauses(comment).Table(IvcBucketWhitelistTable).Order(\"id\").Scopes(PaginateDB(page, size)).\n\t\t\tWhere(filterSource).Find(&bs).Error\n\t}\n\tif err != nil {\n\t\tif err == db.ErrRecordNotFound {\n\t\t\treturn bs, utils.RecordNotFoundError\n\t\t}\n\t\treturn bs, err\n\t}\n\treturn bs, nil\n}",
    "caller": "",
    "sql_statement_list": [
      {
        "type": "param_dependent",
        "variants": [
          {
            "scenario": "filterSource包含name字段时",
            "sql": "SELECT id, name, uin, app_id, region, region_name, bucket_id, seg_duration, seg_size, describe, create_at, update_at FROM IvcBucketWhitelistTable WHERE uin = ? AND region = ? AND name LIKE ? ORDER BY id LIMIT 10 OFFSET 0;"
          },
          {
            "scenario": "filterSource不包含name字段时",
            "sql": "SELECT id, name, uin, app_id, region, region_name, bucket_id, seg_duration, seg_size, describe, create_at, update_at FROM IvcBucketWhitelistTable WHERE uin = ? AND region = ? AND app_id = ? ORDER BY id LIMIT 10 OFFSET 0;"
          }
        ]
      }
    ],
    "sql_types": [
      "PARAM_DEPENDENT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/types/types.go",
        "code_start_line": 262,
        "code_end_line": 275,
        "code_key": "BucketSource",
        "code_value": "type BucketSource struct {\n\tId          int    `json:\"Id\" gorm:\"column:id\"`\n\tName        string `json:\"Name\" gorm:\"column:name\"`\n\tUin         string `json:\"Uin\" gorm:\"column:uin\"`\n\tAppId       int    `json:\"AppId\" gorm:\"column:app_id\"`\n\tRegion      int    `json:\"Region\" gorm:\"column:region\"`\n\tRegionName  string `json:\"RegionName\" gorm:\"column:region_name\"`\n\tBucketId    string `json:\"BucketId\" gorm:\"column:bucket_id\"`\n\tSegDuration int    `json:\"SegDuration\" gorm:\"column:seg_duration\"`\n\tSegSize     int    `json:\"SegSize\" gorm:\"column:seg_size\"`\n\tDescribe    string `json:\"Describe\" gorm:\"column:describe\"`\n\tCreatedAt   int    `json:\"CreateAt\" gorm:\"column:create_at;default:NULL\"`\n\tUpdatedAt   int    `json:\"UpdateAt\" gorm:\"column:update_at;default:NULL\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "c9bb087a681a6287be10c9b6e8e232a6cfc363c7"
      }
    ],
    "sql_pattern_cnt": 2,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-urs.json",
    "matched_keywords": [
      "Scopes"
    ]
  },
  {
    "function_name": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/model/bucket.go:38:63:FindBucketWhitelists",
    "orm_code": "func (b *Bucket) FindBucketWhitelists(filterSource map[string]interface{}, page, size int) ([]types.BucketSource, error) {\n\tbs := make([]types.BucketSource, 0)\n\tvar err error\n\tcomment := b.CommentFunc(SELECT_COMMENT)\n\tif name, ok := filterSource[\"name\"]; ok {\n\t\tfilter := make(map[string]interface{})\n\t\tfor k, v := range filterSource {\n\t\t\tif k == \"name\" {\n\t\t\t\tcontinue\n\t\t\t}\n\t\t\tfilter[k] = v\n\t\t}\n\t\terr = base.GetInstance().IvcDriver().Clauses(comment).Table(IvcBucketWhitelistTable).Order(\"id\").Scopes(PaginateDB(page, size)).\n\t\t\tWhere(filter).Where(\"name like ?\", \"%\"+name.(string)+\"%\").Find(&bs).Error\n\t} else {\n\t\terr = base.GetInstance().IvcDriver().Clauses(comment).Table(IvcBucketWhitelistTable).Order(\"id\").Scopes(PaginateDB(page, size)).\n\t\t\tWhere(filterSource).Find(&bs).Error\n\t}\n\tif err != nil {\n\t\tif err == db.ErrRecordNotFound {\n\t\t\treturn bs, utils.RecordNotFoundError\n\t\t}\n\t\treturn bs, err\n\t}\n\treturn bs, nil\n}",
    "caller": "func (l *QueryBucketWhitelistLogic) QueryBucketWhitelist(req *types.QueryBucketWhitelistRequest, log *logger.IvcLog) (resp *types.QueryBucketWhitelistReponse, err error) {\n\t// 1. 参数校验\n\tpageReq := req.PaginationRequest\n\tpage, size := model.ReqPagination(&pageReq)\n\tfilter := make(map[string]interface{})\n\tif req.AppId > 0 {\n\t\tfilter[\"app_id\"] = req.AppId\n\t} else if len(req.OwnerUin) > 0 {\n\t\terr := utils.CheckUinStr(req.OwnerUin)\n\t\tif err != nil {\n\t\t\tlog.ErrorV(fmt.Sprintf(\"[QueryBucketWhitelist] CheckUinStr Param Invalid:%+v\", *req), utils.InvalidParamErr)\n\t\t\treturn nil, utils.InvalidParamError\n\t\t}\n\t\tfilter[\"uin\"] = req.OwnerUin\n\t} else if len(req.Name) > 0 {\n\t\terr := utils.CheckNameStr(req.Name)\n\t\tif err != nil {\n\t\t\tlog.ErrorV(fmt.Sprintf(\"[QueryBucketWhitelist] CheckNameStr Param Invalid:%+v\", *req), utils.InvalidParamErr)\n\t\t\treturn nil, utils.InvalidParamError\n\t\t}\n\t\tfilter[\"name\"] = req.Name\n\t}\n\n\tif len(req.BucketId) > 0 {\n\t\terr := utils.CheckUUID(req.BucketId)\n\t\tif err != nil {\n\t\t\tlog.ErrorV(fmt.Sprintf(\"[QueryBucketWhitelist] CheckBucketId Param Invalid:%+v\", *req), utils.InvalidParamErr)\n\t\t\treturn nil, utils.InvalidParamError\n\t\t}\n\t\tfilter[\"bucket_id\"] = req.BucketId\n\t}\n\n\tif req.Region != nil {\n\t\tfilter[\"region\"] = *req.Region\n\t}\n\n\t// 2. 查找符合条件的存储桶白名单列表\n\tbucket := &model.Bucket{\n\t\tComment: model.NewComment(req.RequestId, model.QueryBucketWhitelistFlow),\n\t}\n\tbs, err := bucket.FindBucketWhitelists(filter, page, size)\n\tif err != nil {\n\t\terrCode := utils.OperationErr\n\t\tif e, ok := err.(*utils.UrsError); ok {\n\t\t\terrCode = e.Id\n\t\t}\n\t\tlog.ErrorV(fmt.Sprintf(\"[QueryBucketWhitelist] FindBucketWhitelists err:%v\", err), errCode)\n\t\treturn nil, err\n\t}\n\n\t// 3. 处理组合结果\n\tbucketList := MatchBucketWhitelistResp(bs)\n\n\t// 4. 查询符合条件的存储桶白名单总数\n\ttotal, err := bucket.FindBucketWhitelistCount(filter)\n\tif err != nil {\n\t\terrCode := utils.OperationErr\n\t\tif e, ok := err.(*utils.UrsError); ok {\n\t\t\terrCode = e.Id\n\t\t}\n\t\tlog.ErrorV(fmt.Sprintf(\"[QueryBucketWhitelist] FindBucketWhitelistCount err:%v\", err), errCode)\n\t\treturn nil, err\n\t}\n\n\tresp = &types.QueryBucketWhitelistReponse{\n\t\tBucketList: bucketList,\n\t\tTotal:      total,\n\t\tPage:       page,\n\t\tSize:       size,\n\t}\n\n\treturn resp, nil\n}",
    "sql_statement_list": [
      {
        "type": "param_dependent",
        "variants": [
          {
            "scenario": "当filterSource中包含name字段时",
            "sql": "SELECT id, name, uin, app_id, region, region_name, bucket_id, seg_duration, seg_size, describe, create_at, update_at FROM ivc_bucket_whitelist WHERE app_id = ? AND region = ? AND bucket_id = ? AND uin = ? AND name LIKE ? ORDER BY id LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "当filterSource中不包含name字段时",
            "sql": "SELECT id, name, uin, app_id, region, region_name, bucket_id, seg_duration, seg_size, describe, create_at, update_at FROM ivc_bucket_whitelist WHERE app_id = ? AND region = ? AND bucket_id = ? AND uin = ? ORDER BY id LIMIT ? OFFSET ?;"
          }
        ]
      }
    ],
    "sql_types": [
      "PARAM_DEPENDENT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/types/types.go",
        "code_start_line": 262,
        "code_end_line": 275,
        "code_key": "BucketSource",
        "code_value": "type BucketSource struct {\n\tId          int    `json:\"Id\" gorm:\"column:id\"`\n\tName        string `json:\"Name\" gorm:\"column:name\"`\n\tUin         string `json:\"Uin\" gorm:\"column:uin\"`\n\tAppId       int    `json:\"AppId\" gorm:\"column:app_id\"`\n\tRegion      int    `json:\"Region\" gorm:\"column:region\"`\n\tRegionName  string `json:\"RegionName\" gorm:\"column:region_name\"`\n\tBucketId    string `json:\"BucketId\" gorm:\"column:bucket_id\"`\n\tSegDuration int    `json:\"SegDuration\" gorm:\"column:seg_duration\"`\n\tSegSize     int    `json:\"SegSize\" gorm:\"column:seg_size\"`\n\tDescribe    string `json:\"Describe\" gorm:\"column:describe\"`\n\tCreatedAt   int    `json:\"CreateAt\" gorm:\"column:create_at;default:NULL\"`\n\tUpdatedAt   int    `json:\"UpdateAt\" gorm:\"column:update_at;default:NULL\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "c9bb087a681a6287be10c9b6e8e232a6cfc363c7"
      }
    ],
    "sql_pattern_cnt": 2,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-urs.json",
    "matched_keywords": [
      "Scopes"
    ]
  },
  {
    "function_name": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/model/event.go:308:320:FindApprovalEventList",
    "orm_code": "func (ae *ApprovalEvent) FindApprovalEventList(filterSource map[string]interface{}, page, size int) ([]types.ApprovalEventSource, error) {\n\tas := make([]types.ApprovalEventSource, 0)\n\tcomment := ae.CommentFunc(SELECT_COMMENT)\n\terr := base.GetInstance().IvcDriver().Clauses(comment).Table(IvcApprovalEventTable).Order(\"update_at desc\").Scopes(PaginateDB(page, size)).\n\t\tWhere(filterSource).Find(&as).Error\n\tif err != nil {\n\t\tif err == db.ErrRecordNotFound {\n\t\t\treturn as, utils.RecordNotFoundError\n\t\t}\n\t\treturn as, err\n\t}\n\treturn as, nil\n}",
    "caller": "",
    "sql_statement_list": [
      {
        "type": "param_dependent",
        "variants": [
          {
            "scenario": "无过滤条件",
            "sql": "SELECT id, order_id, creator, operator, approver, approve_msg, step_type, approve_res, total_approve_res, approve_time, approve_content, action, create_at, update_at FROM IvcApprovalEventTable ORDER BY update_at desc LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "单个过滤条件",
            "sql": "SELECT id, order_id, creator, operator, approver, approve_msg, step_type, approve_res, total_approve_res, approve_time, approve_content, action, create_at, update_at FROM IvcApprovalEventTable WHERE ? = ? ORDER BY update_at desc LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "多个过滤条件",
            "sql": "SELECT id, order_id, creator, operator, approver, approve_msg, step_type, approve_res, total_approve_res, approve_time, approve_content, action, create_at, update_at FROM IvcApprovalEventTable WHERE ? = ? AND ? = ? ORDER BY update_at desc LIMIT ? OFFSET ?;"
          }
        ]
      }
    ],
    "sql_types": [
      "PARAM_DEPENDENT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/types/types.go",
        "code_start_line": 113,
        "code_end_line": 128,
        "code_key": "ApprovalEventSource",
        "code_value": "type ApprovalEventSource struct {\n\tTaskId          string `json:\"task_id\" gorm:\"column:id\"`\n\tOrderId         int    `json:\"order_id\" gorm:\"column:order_id\"`\n\tCreator         string `json:\"creator\" gorm:\"column:creator\"`\n\tOperator        string `json:\"operator\" gorm:\"column:operator\"`\n\tApprover        string `json:\"approver\" gorm:\"column:approver\"`\n\tApproveMsg      string `json:\"approve_msg\" gorm:\"column:approve_msg\"`\n\tStepType        string `json:\"step_type\" gorm:\"column:step_type\"`\n\tApproveRes      int    `json:\"approve_res\" gorm:\"column:approve_res\"`\n\tTotalApproveRes int    `json:\"total_approve_res\" gorm:\"column:total_approve_res\"`\n\tApproveTime     string `json:\"approve_time\" gorm:\"column:approve_time\"`\n\tApproveContent  string `json:\"approve_content\" gorm:\"column:approve_content\"`\n\tAction          string `json:\"action\" gorm:\"column:action\"`\n\tCreateAt        int64  `json:\"create_at\" gorm:\"column:create_at\"`\n\tUpdateAt        int64  `json:\"update_at\" gorm:\"column:update_at\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "c9bb087a681a6287be10c9b6e8e232a6cfc363c7"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-urs.json",
    "matched_keywords": [
      "Scopes"
    ]
  },
  {
    "function_name": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/model/event.go:308:320:FindApprovalEventList",
    "orm_code": "func (ae *ApprovalEvent) FindApprovalEventList(filterSource map[string]interface{}, page, size int) ([]types.ApprovalEventSource, error) {\n\tas := make([]types.ApprovalEventSource, 0)\n\tcomment := ae.CommentFunc(SELECT_COMMENT)\n\terr := base.GetInstance().IvcDriver().Clauses(comment).Table(IvcApprovalEventTable).Order(\"update_at desc\").Scopes(PaginateDB(page, size)).\n\t\tWhere(filterSource).Find(&as).Error\n\tif err != nil {\n\t\tif err == db.ErrRecordNotFound {\n\t\t\treturn as, utils.RecordNotFoundError\n\t\t}\n\t\treturn as, err\n\t}\n\treturn as, nil\n}",
    "caller": "func (l *QueryApprovalFormListLogic) QueryApprovalFormList(req *types.QueryApprovalFormRequest, log *logger.IvcLog) (resp *types.QueryApprovalFormListReponse, err error) {\n\t// 1. 参数校验\n\tpageReq := req.PaginationRequest\n\tpage, size := model.ReqPagination(&pageReq)\n\tfilter := make(map[string]interface{})\n\n\tif len(req.TaskId) > 0 {\n\t\terr := utils.CheckUUID(req.TaskId)\n\t\tif err != nil {\n\t\t\tlog.ErrorV(fmt.Sprintf(\"[QueryApprovalFormList] CheckTaskId Param Invalid:%+v\", *req), utils.InvalidParamErr)\n\t\t\treturn nil, utils.InvalidParamError\n\t\t}\n\t\tfilter[\"id\"] = req.TaskId\n\t}\n\tif len(req.Creator) > 0 {\n\t\terr := utils.CheckNameStr(req.Creator)\n\t\tif err != nil {\n\t\t\tlog.ErrorV(fmt.Sprintf(\"[QueryApprovalFormList] CheckCreator Param Invalid:%+v\", *req), utils.InvalidParamErr)\n\t\t\treturn nil, utils.InvalidParamError\n\t\t}\n\t\tfilter[\"creator\"] = req.Creator\n\t}\n\tif len(req.Action) > 0 {\n\t\terr := utils.CheckNameStr(req.Action)\n\t\tif err != nil {\n\t\t\tlog.ErrorV(fmt.Sprintf(\"[QueryApprovalFormList] CheckAction Param Invalid:%+v\", *req), utils.InvalidParamErr)\n\t\t\treturn nil, utils.InvalidParamError\n\t\t}\n\t\tfilter[\"action\"] = req.Action\n\t}\n\tif req.TotalApproveRes != nil {\n\t\tfilter[\"total_approve_res\"] = *req.TotalApproveRes\n\t}\n\tif req.OrderId != nil {\n\t\tfilter[\"order_id\"] = *req.OrderId\n\t}\n\tcomment := model.NewComment(req.RequestId, model.QueryApprovalFormListFlow)\n\t// 2. 查找符合条件的审批单列表\n\taet := &model.ApprovalEvent{\n\t\tComment: comment,\n\t}\n\tas, err := aet.FindApprovalEventList(filter, page, size)\n\tif err != nil {\n\t\terrCode := utils.OperationErr\n\t\tif e, ok := err.(*utils.UrsError); ok {\n\t\t\terrCode = e.Id\n\t\t}\n\t\tlog.ErrorV(fmt.Sprintf(\"[QueryApprovalFormList] FindApprovalEventList err:%v\", err), errCode)\n\t\treturn nil, err\n\t}\n\n\t// 3. 处理组合结果\n\tapprovalList := MatchApprovalEventListResp(as)\n\n\t// 4. 查询符合条件的审批单总数\n\ttotal, err := aet.FindApprovalEventListCount(filter)\n\tif err != nil {\n\t\terrCode := utils.OperationErr\n\t\tif e, ok := err.(*utils.UrsError); ok {\n\t\t\terrCode = e.Id\n\t\t}\n\t\tlog.ErrorV(fmt.Sprintf(\"[QueryApprovalFormList] FindApprovalEventListCount err:%v\", err), errCode)\n\t\treturn nil, err\n\t}\n\n\tresp = &types.QueryApprovalFormListReponse{\n\t\tApprovalFormList: approvalList,\n\t\tTotal:            total,\n\t\tPage:             page,\n\t\tSize:             size,\n\t}\n\n\treturn resp, nil\n}",
    "sql_statement_list": [
      {
        "type": "param_dependent",
        "variants": [
          {
            "scenario": "无任何过滤条件",
            "sql": "SELECT id, order_id, creator, operator, approver, approve_msg, step_type, approve_res, total_approve_res, approve_time, approve_content, action, create_at, update_at FROM ivc_approval_event ORDER BY update_at desc LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "只有id条件",
            "sql": "SELECT id, order_id, creator, operator, approver, approve_msg, step_type, approve_res, total_approve_res, approve_time, approve_content, action, create_at, update_at FROM ivc_approval_event WHERE id = ? ORDER BY update_at desc LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "只有creator条件",
            "sql": "SELECT id, order_id, creator, operator, approver, approve_msg, step_type, approve_res, total_approve_res, approve_time, approve_content, action, create_at, update_at FROM ivc_approval_event WHERE creator = ? ORDER BY update_at desc LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "只有action条件",
            "sql": "SELECT id, order_id, creator, operator, approver, approve_msg, step_type, approve_res, total_approve_res, approve_time, approve_content, action, create_at, update_at FROM ivc_approval_event WHERE action = ? ORDER BY update_at desc LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "只有total_approve_res条件",
            "sql": "SELECT id, order_id, creator, operator, approver, approve_msg, step_type, approve_res, total_approve_res, approve_time, approve_content, action, create_at, update_at FROM ivc_approval_event WHERE total_approve_res = ? ORDER BY update_at desc LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "只有order_id条件",
            "sql": "SELECT id, order_id, creator, operator, approver, approve_msg, step_type, approve_res, total_approve_res, approve_time, approve_content, action, create_at, update_at FROM ivc_approval_event WHERE order_id = ? ORDER BY update_at desc LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "id和creator条件",
            "sql": "SELECT id, order_id, creator, operator, approver, approve_msg, step_type, approve_res, total_approve_res, approve_time, approve_content, action, create_at, update_at FROM ivc_approval_event WHERE id = ? AND creator = ? ORDER BY update_at desc LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "id和action条件",
            "sql": "SELECT id, order_id, creator, operator, approver, approve_msg, step_type, approve_res, total_approve_res, approve_time, approve_content, action, create_at, update_at FROM ivc_approval_event WHERE id = ? AND action = ? ORDER BY update_at desc LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "id和total_approve_res条件",
            "sql": "SELECT id, order_id, creator, operator, approver, approve_msg, step_type, approve_res, total_approve_res, approve_time, approve_content, action, create_at, update_at FROM ivc_approval_event WHERE id = ? AND total_approve_res = ? ORDER BY update_at desc LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "id和order_id条件",
            "sql": "SELECT id, order_id, creator, operator, approver, approve_msg, step_type, approve_res, total_approve_res, approve_time, approve_content, action, create_at, update_at FROM ivc_approval_event WHERE id = ? AND order_id = ? ORDER BY update_at desc LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "creator和action条件",
            "sql": "SELECT id, order_id, creator, operator, approver, approve_msg, step_type, approve_res, total_approve_res, approve_time, approve_content, action, create_at, update_at FROM ivc_approval_event WHERE creator = ? AND action = ? ORDER BY update_at desc LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "creator和total_approve_res条件",
            "sql": "SELECT id, order_id, creator, operator, approver, approve_msg, step_type, approve_res, total_approve_res, approve_time, approve_content, action, create_at, update_at FROM ivc_approval_event WHERE creator = ? AND total_approve_res = ? ORDER BY update_at desc LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "creator和order_id条件",
            "sql": "SELECT id, order_id, creator, operator, approver, approve_msg, step_type, approve_res, total_approve_res, approve_time, approve_content, action, create_at, update_at FROM ivc_approval_event WHERE creator = ? AND order_id = ? ORDER BY update_at desc LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "action和total_approve_res条件",
            "sql": "SELECT id, order_id, creator, operator, approver, approve_msg, step_type, approve_res, total_approve_res, approve_time, approve_content, action, create_at, update_at FROM ivc_approval_event WHERE action = ? AND total_approve_res = ? ORDER BY update_at desc LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "action和order_id条件",
            "sql": "SELECT id, order_id, creator, operator, approver, approve_msg, step_type, approve_res, total_approve_res, approve_time, approve_content, action, create_at, update_at FROM ivc_approval_event WHERE action = ? AND order_id = ? ORDER BY update_at desc LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "total_approve_res和order_id条件",
            "sql": "SELECT id, order_id, creator, operator, approver, approve_msg, step_type, approve_res, total_approve_res, approve_time, approve_content, action, create_at, update_at FROM ivc_approval_event WHERE total_approve_res = ? AND order_id = ? ORDER BY update_at desc LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "id、creator和action条件",
            "sql": "SELECT id, order_id, creator, operator, approver, approve_msg, step_type, approve_res, total_approve_res, approve_time, approve_content, action, create_at, update_at FROM ivc_approval_event WHERE id = ? AND creator = ? AND action = ? ORDER BY update_at desc LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "id、creator和total_approve_res条件",
            "sql": "SELECT id, order_id, creator, operator, approver, approve_msg, step_type, approve_res, total_approve_res, approve_time, approve_content, action, create_at, update_at FROM ivc_approval_event WHERE id = ? AND creator = ? AND total_approve_res = ? ORDER BY update_at desc LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "id、creator和order_id条件",
            "sql": "SELECT id, order_id, creator, operator, approver, approve_msg, step_type, approve_res, total_approve_res, approve_time, approve_content, action, create_at, update_at FROM ivc_approval_event WHERE id = ? AND creator = ? AND order_id = ? ORDER BY update_at desc LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "id、action和total_approve_res条件",
            "sql": "SELECT id, order_id, creator, operator, approver, approve_msg, step_type, approve_res, total_approve_res, approve_time, approve_content, action, create_at, update_at FROM ivc_approval_event WHERE id = ? AND action = ? AND total_approve_res = ? ORDER BY update_at desc LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "id、action和order_id条件",
            "sql": "SELECT id, order_id, creator, operator, approver, approve_msg, step_type, approve_res, total_approve_res, approve_time, approve_content, action, create_at, update_at FROM ivc_approval_event WHERE id = ? AND action = ? AND order_id = ? ORDER BY update_at desc LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "id、total_approve_res和order_id条件",
            "sql": "SELECT id, order_id, creator, operator, approver, approve_msg, step_type, approve_res, total_approve_res, approve_time, approve_content, action, create_at, update_at FROM ivc_approval_event WHERE id = ? AND total_approve_res = ? AND order_id = ? ORDER BY update_at desc LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "creator、action和total_approve_res条件",
            "sql": "SELECT id, order_id, creator, operator, approver, approve_msg, step_type, approve_res, total_approve_res, approve_time, approve_content, action, create_at, update_at FROM ivc_approval_event WHERE creator = ? AND action = ? AND total_approve_res = ? ORDER BY update_at desc LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "creator、action和order_id条件",
            "sql": "SELECT id, order_id, creator, operator, approver, approve_msg, step_type, approve_res, total_approve_res, approve_time, approve_content, action, create_at, update_at FROM ivc_approval_event WHERE creator = ? AND action = ? AND order_id = ? ORDER BY update_at desc LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "creator、total_approve_res和order_id条件",
            "sql": "SELECT id, order_id, creator, operator, approver, approve_msg, step_type, approve_res, total_approve_res, approve_time, approve_content, action, create_at, update_at FROM ivc_approval_event WHERE creator = ? AND total_approve_res = ? AND order_id = ? ORDER BY update_at desc LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "action、total_approve_res和order_id条件",
            "sql": "SELECT id, order_id, creator, operator, approver, approve_msg, step_type, approve_res, total_approve_res, approve_time, approve_content, action, create_at, update_at FROM ivc_approval_event WHERE action = ? AND total_approve_res = ? AND order_id = ? ORDER BY update_at desc LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "id、creator、action和total_approve_res条件",
            "sql": "SELECT id, order_id, creator, operator, approver, approve_msg, step_type, approve_res, total_approve_res, approve_time, approve_content, action, create_at, update_at FROM ivc_approval_event WHERE id = ? AND creator = ? AND action = ? AND total_approve_res = ? ORDER BY update_at desc LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "id、creator、action和order_id条件",
            "sql": "SELECT id, order_id, creator, operator, approver, approve_msg, step_type, approve_res, total_approve_res, approve_time, approve_content, action, create_at, update_at FROM ivc_approval_event WHERE id = ? AND creator = ? AND action = ? AND order_id = ? ORDER BY update_at desc LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "id、creator、total_approve_res和order_id条件",
            "sql": "SELECT id, order_id, creator, operator, approver, approve_msg, step_type, approve_res, total_approve_res, approve_time, approve_content, action, create_at, update_at FROM ivc_approval_event WHERE id = ? AND creator = ? AND total_approve_res = ? AND order_id = ? ORDER BY update_at desc LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "id、action、total_approve_res和order_id条件",
            "sql": "SELECT id, order_id, creator, operator, approver, approve_msg, step_type, approve_res, total_approve_res, approve_time, approve_content, action, create_at, update_at FROM ivc_approval_event WHERE id = ? AND action = ? AND total_approve_res = ? AND order_id = ? ORDER BY update_at desc LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "creator、action、total_approve_res和order_id条件",
            "sql": "SELECT id, order_id, creator, operator, approver, approve_msg, step_type, approve_res, total_approve_res, approve_time, approve_content, action, create_at, update_at FROM ivc_approval_event WHERE creator = ? AND action = ? AND total_approve_res = ? AND order_id = ? ORDER BY update_at desc LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "全部五个条件",
            "sql": "SELECT id, order_id, creator, operator, approver, approve_msg, step_type, approve_res, total_approve_res, approve_time, approve_content, action, create_at, update_at FROM ivc_approval_event WHERE id = ? AND creator = ? AND action = ? AND total_approve_res = ? AND order_id = ? ORDER BY update_at desc LIMIT ? OFFSET ?;"
          }
        ]
      }
    ],
    "sql_types": [
      "PARAM_DEPENDENT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/types/types.go",
        "code_start_line": 113,
        "code_end_line": 128,
        "code_key": "ApprovalEventSource",
        "code_value": "type ApprovalEventSource struct {\n\tTaskId          string `json:\"task_id\" gorm:\"column:id\"`\n\tOrderId         int    `json:\"order_id\" gorm:\"column:order_id\"`\n\tCreator         string `json:\"creator\" gorm:\"column:creator\"`\n\tOperator        string `json:\"operator\" gorm:\"column:operator\"`\n\tApprover        string `json:\"approver\" gorm:\"column:approver\"`\n\tApproveMsg      string `json:\"approve_msg\" gorm:\"column:approve_msg\"`\n\tStepType        string `json:\"step_type\" gorm:\"column:step_type\"`\n\tApproveRes      int    `json:\"approve_res\" gorm:\"column:approve_res\"`\n\tTotalApproveRes int    `json:\"total_approve_res\" gorm:\"column:total_approve_res\"`\n\tApproveTime     string `json:\"approve_time\" gorm:\"column:approve_time\"`\n\tApproveContent  string `json:\"approve_content\" gorm:\"column:approve_content\"`\n\tAction          string `json:\"action\" gorm:\"column:action\"`\n\tCreateAt        int64  `json:\"create_at\" gorm:\"column:create_at\"`\n\tUpdateAt        int64  `json:\"update_at\" gorm:\"column:update_at\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "c9bb087a681a6287be10c9b6e8e232a6cfc363c7"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-urs.json",
    "matched_keywords": [
      "Scopes"
    ]
  },
  {
    "function_name": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/model/media.go:32:57:FindMediaWhitelists",
    "orm_code": "func (m *Media) FindMediaWhitelists(filterSource map[string]interface{}, page, size int) ([]types.MediaSource, error) {\n\tms := make([]types.MediaSource, 0)\n\tvar err error\n\tcomment := m.CommentFunc(SELECT_COMMENT)\n\tif name, ok := filterSource[\"name\"]; ok {\n\t\tfilter := make(map[string]interface{})\n\t\tfor k, v := range filterSource {\n\t\t\tif k == \"name\" {\n\t\t\t\tcontinue\n\t\t\t}\n\t\t\tfilter[k] = v\n\t\t}\n\t\terr = base.GetInstance().IvcDriver().Clauses(comment).Table(IvcMediaWhitelistTable).Order(\"id\").Scopes(PaginateDB(page, size)).\n\t\t\tWhere(filter).Where(\"name like ?\", \"%\"+name.(string)+\"%\").Find(&ms).Error\n\t} else {\n\t\terr = base.GetInstance().IvcDriver().Clauses(comment).Table(IvcMediaWhitelistTable).Order(\"id\").Scopes(PaginateDB(page, size)).\n\t\t\tWhere(filterSource).Find(&ms).Error\n\t}\n\tif err != nil {\n\t\tif err == db.ErrRecordNotFound {\n\t\t\treturn ms, utils.RecordNotFoundError\n\t\t}\n\t\treturn ms, err\n\t}\n\treturn ms, nil\n}",
    "caller": "",
    "sql_statement_list": [
      {
        "type": "param_dependent",
        "variants": [
          {
            "scenario": "filterSource包含name字段时的查询",
            "sql": "SELECT id, name, uin, app_id, cluster_id, gb_media_addr, rtmp_media_addr, describe, create_at, update_at FROM ivc_media_whitelist WHERE uin = ? AND app_id = ? AND name LIKE ? ORDER BY id LIMIT 10 OFFSET 0;"
          },
          {
            "scenario": "filterSource不包含name字段时的查询",
            "sql": "SELECT id, name, uin, app_id, cluster_id, gb_media_addr, rtmp_media_addr, describe, create_at, update_at FROM ivc_media_whitelist WHERE uin = ? AND app_id = ? AND cluster_id = ? ORDER BY id LIMIT 10 OFFSET 0;"
          }
        ]
      }
    ],
    "sql_types": [
      "PARAM_DEPENDENT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/types/types.go",
        "code_start_line": 774,
        "code_end_line": 785,
        "code_key": "MediaSource",
        "code_value": "type MediaSource struct {\n\tId            int    `json:\"Id\" gorm:\"column:id\"`\n\tName          string `json:\"Name\" gorm:\"column:name\"`\n\tUin           string `json:\"Uin\" gorm:\"column:uin\"`\n\tAppId         int    `json:\"AppId\" gorm:\"column:app_id\"`\n\tClusterId     string `json:\"ClusterId\" gorm:\"column:cluster_id\"`\n\tGBMediaAddr   string `json:\"GBMediaAddr\" gorm:\"column:gb_media_addr\"`\n\tRTMPMediaAddr string `json:\"RTMPMediaAddr\" gorm:\"column:rtmp_media_addr\"`\n\tDescribe      string `json:\"Describe\" gorm:\"column:describe\"`\n\tCreatedAt     int    `json:\"CreateAt\" gorm:\"column:create_at;default:NULL\"`\n\tUpdatedAt     int    `json:\"UpdateAt\" gorm:\"column:update_at;default:NULL\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "c9bb087a681a6287be10c9b6e8e232a6cfc363c7"
      }
    ],
    "sql_pattern_cnt": 2,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-urs.json",
    "matched_keywords": [
      "Scopes"
    ]
  },
  {
    "function_name": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/model/media.go:32:57:FindMediaWhitelists",
    "orm_code": "func (m *Media) FindMediaWhitelists(filterSource map[string]interface{}, page, size int) ([]types.MediaSource, error) {\n\tms := make([]types.MediaSource, 0)\n\tvar err error\n\tcomment := m.CommentFunc(SELECT_COMMENT)\n\tif name, ok := filterSource[\"name\"]; ok {\n\t\tfilter := make(map[string]interface{})\n\t\tfor k, v := range filterSource {\n\t\t\tif k == \"name\" {\n\t\t\t\tcontinue\n\t\t\t}\n\t\t\tfilter[k] = v\n\t\t}\n\t\terr = base.GetInstance().IvcDriver().Clauses(comment).Table(IvcMediaWhitelistTable).Order(\"id\").Scopes(PaginateDB(page, size)).\n\t\t\tWhere(filter).Where(\"name like ?\", \"%\"+name.(string)+\"%\").Find(&ms).Error\n\t} else {\n\t\terr = base.GetInstance().IvcDriver().Clauses(comment).Table(IvcMediaWhitelistTable).Order(\"id\").Scopes(PaginateDB(page, size)).\n\t\t\tWhere(filterSource).Find(&ms).Error\n\t}\n\tif err != nil {\n\t\tif err == db.ErrRecordNotFound {\n\t\t\treturn ms, utils.RecordNotFoundError\n\t\t}\n\t\treturn ms, err\n\t}\n\treturn ms, nil\n}",
    "caller": "func (l *QueryMediaWhitelistLogic) QueryMediaWhitelist(req *types.QueryMediaWhitelistRequest, log *logger.IvcLog) (resp *types.QueryMediaWhitelistReponse, err error) {\n\t// 1. 参数校验\n\tpageReq := req.PaginationRequest\n\tpage, size := model.ReqPagination(&pageReq)\n\tfilter := make(map[string]interface{})\n\tif req.AppId > 0 {\n\t\tfilter[\"app_id\"] = req.AppId\n\t} else if len(req.OwnerUin) > 0 {\n\t\terr := utils.CheckUinStr(req.OwnerUin)\n\t\tif err != nil {\n\t\t\tlog.ErrorV(fmt.Sprintf(\"[QueryMediaWhitelist] CheckUinStr Param Invalid:%+v\", *req), utils.InvalidParamErr)\n\t\t\treturn nil, utils.InvalidParamError\n\t\t}\n\t\tfilter[\"uin\"] = req.OwnerUin\n\t} else if len(req.Name) > 0 {\n\t\terr := utils.CheckNameStr(req.Name)\n\t\tif err != nil {\n\t\t\tlog.ErrorV(fmt.Sprintf(\"[QueryMediaWhitelist] CheckNameStr Param Invalid:%+v\", *req), utils.InvalidParamErr)\n\t\t\treturn nil, utils.InvalidParamError\n\t\t}\n\t\tfilter[\"name\"] = req.Name\n\t}\n\n\tif len(req.ClusterId) > 0 {\n\t\terr := utils.CheckUUID(req.ClusterId)\n\t\tif err != nil {\n\t\t\tlog.ErrorV(fmt.Sprintf(\"[QueryMediaWhitelist] CheckUUIDClusterId Param Invalid:%+v\", *req), utils.InvalidParamErr)\n\t\t\treturn nil, utils.InvalidParamError\n\t\t}\n\n\t\tfilter[\"cluster_id\"] = req.ClusterId\n\t}\n\tcomment := model.NewComment(req.RequestId, model.QueryMediaWhitelistFlow)\n\t// 2. 查找符合条件的媒体白名单列表\n\tmedia := &model.Media{\n\t\tComment: comment,\n\t}\n\tms, err := media.FindMediaWhitelists(filter, page, size)\n\tif err != nil {\n\t\terrCode := utils.OperationErr\n\t\tif e, ok := err.(*utils.UrsError); ok {\n\t\t\terrCode = e.Id\n\t\t}\n\t\tlog.ErrorV(fmt.Sprintf(\"[QueryMediaWhitelist] FindMediaWhitelists err:%v\", err), errCode)\n\t\treturn nil, err\n\t}\n\n\t// 3. 查询集群列表\n\tc := &model.Cluster{\n\t\tComment: comment,\n\t}\n\tclusters, err := c.GetClusterIdList(log)\n\tif err != nil {\n\t\terrCode := utils.OperationErr\n\t\tif e, ok := err.(*utils.UrsError); ok {\n\t\t\terrCode = e.Id\n\t\t}\n\t\tlog.ErrorV(fmt.Sprintf(\"[QueryMediaWhitelist] GetClusterIdList err:%v\", err), errCode)\n\t\treturn nil, err\n\t}\n\tclusterMap := make(map[string]string, 0)\n\tfor _, clu := range clusters {\n\t\tclusterMap[clu.ClusterId] = clu.ClusterName\n\t}\n\n\t// 4. 处理组合结果\n\tmediaWhitelist := MatchMediaWhitelistResp(ms, clusterMap, log)\n\n\t// 5. 查询符合条件的媒体白名单总数\n\ttotal, err := media.FindMediaWhitelistCount(filter)\n\tif err != nil {\n\t\terrCode := utils.OperationErr\n\t\tif e, ok := err.(*utils.UrsError); ok {\n\t\t\terrCode = e.Id\n\t\t}\n\t\tlog.ErrorV(fmt.Sprintf(\"[QueryMediaWhitelist] FindMediaWhitelistCount err:%v\", err), errCode)\n\t\treturn nil, err\n\t}\n\n\tresp = &types.QueryMediaWhitelistReponse{\n\t\tMedias: mediaWhitelist,\n\t\tTotal:  total,\n\t\tPage:   page,\n\t\tSize:   size,\n\t}\n\n\treturn resp, nil\n}",
    "sql_statement_list": [
      {
        "type": "param_dependent",
        "variants": [
          {
            "scenario": "包含name字段时的模糊查询",
            "sql": "SELECT * FROM IvcMediaWhitelistTable WHERE cluster_id = ? AND name LIKE ? ORDER BY id LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "不包含name字段时的精确查询",
            "sql": "SELECT * FROM IvcMediaWhitelistTable WHERE app_id = ? AND cluster_id = ? ORDER BY id LIMIT ? OFFSET ?;"
          }
        ]
      }
    ],
    "sql_types": [
      "PARAM_DEPENDENT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/types/types.go",
        "code_start_line": 774,
        "code_end_line": 785,
        "code_key": "MediaSource",
        "code_value": "type MediaSource struct {\n\tId            int    `json:\"Id\" gorm:\"column:id\"`\n\tName          string `json:\"Name\" gorm:\"column:name\"`\n\tUin           string `json:\"Uin\" gorm:\"column:uin\"`\n\tAppId         int    `json:\"AppId\" gorm:\"column:app_id\"`\n\tClusterId     string `json:\"ClusterId\" gorm:\"column:cluster_id\"`\n\tGBMediaAddr   string `json:\"GBMediaAddr\" gorm:\"column:gb_media_addr\"`\n\tRTMPMediaAddr string `json:\"RTMPMediaAddr\" gorm:\"column:rtmp_media_addr\"`\n\tDescribe      string `json:\"Describe\" gorm:\"column:describe\"`\n\tCreatedAt     int    `json:\"CreateAt\" gorm:\"column:create_at;default:NULL\"`\n\tUpdatedAt     int    `json:\"UpdateAt\" gorm:\"column:update_at;default:NULL\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "c9bb087a681a6287be10c9b6e8e232a6cfc363c7"
      }
    ],
    "sql_pattern_cnt": 2,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-urs.json",
    "matched_keywords": [
      "Scopes"
    ]
  },
  {
    "function_name": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/model/playerlicense.go:209:221:FindLicenses",
    "orm_code": "func (l *License) FindLicenses(filterSource map[string]interface{}, page, size int) ([]types.PlayerLicenseSource, error) {\n\tvar ls []types.PlayerLicenseSource\n\tcomment := l.CommentFunc(SELECT_COMMENT)\n\terr := base.GetInstance().IvcDriver().Clauses(comment).Table(IvcPlayerLicenseTable).Scopes(PaginateDB(page, size)).Where(\"delete_time is null\").\n\t\tWhere(filterSource).Find(&ls).Error\n\tif err != nil {\n\t\tif err == db.ErrRecordNotFound {\n\t\t\treturn ls, utils.RecordNotFoundError\n\t\t}\n\t\treturn nil, err\n\t}\n\treturn ls, nil\n}",
    "caller": "",
    "sql_statement_list": [
      {
        "type": "param_dependent",
        "variants": [
          {
            "scenario": "filterSource为空或nil",
            "sql": "SELECT id, appid, license_key, type, features, technologies, valid_days, disable_domain_restrictions, domain_whitelist, effective_time FROM ivc_player_license WHERE delete_time IS NULL LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "filterSource包含单个条件",
            "sql": "SELECT id, appid, license_key, type, features, technologies, valid_days, disable_domain_restrictions, domain_whitelist, effective_time FROM ivc_player_license WHERE delete_time IS NULL AND appid = ? LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "filterSource包含多个条件",
            "sql": "SELECT id, appid, license_key, type, features, technologies, valid_days, disable_domain_restrictions, domain_whitelist, effective_time FROM ivc_player_license WHERE delete_time IS NULL AND appid = ? AND type = ? AND license_key = ? LIMIT ? OFFSET ?;"
          }
        ]
      }
    ],
    "sql_types": [
      "PARAM_DEPENDENT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/types/types.go",
        "code_start_line": 878,
        "code_end_line": 889,
        "code_key": "PlayerLicenseSource",
        "code_value": "type PlayerLicenseSource struct {\n\tId                        string `json:\"Id\" gorm:\"column:id\"`\n\tAppId                     int    `json:\"AppId\" gorm:\"column:appid\"`\n\tLicenseKey                string `json:\"LicenseKey\" gorm:\"column:license_key\"`\n\tType                      string `json:\"Type\" gorm:\"column:type\"`\n\tFeatures                  int    `json:\"Features\" gorm:\"features\"`\n\tTechnologies              int    `json:\"Technologies\" gorm:\"technologies\"`\n\tValidDays                 int    `json:\"ValidDays\" gorm:\"column:valid_days\"`\n\tDisableDomainRestrictions int    `json:\"DisableDomainRestrictions\" gorm:\"column:disable_domain_restrictions\"`\n\tDomainWhitelist           string `json:\"DomainWhitelist\" gorm:\"column:domain_whitelist\"`\n\tEffectiveTime             int    `json:\"EffectiveTime\" gorm:\"column:effective_time\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "c9bb087a681a6287be10c9b6e8e232a6cfc363c7"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-urs.json",
    "matched_keywords": [
      "Scopes"
    ]
  },
  {
    "function_name": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/model/playerlicense.go:209:221:FindLicenses",
    "orm_code": "func (l *License) FindLicenses(filterSource map[string]interface{}, page, size int) ([]types.PlayerLicenseSource, error) {\n\tvar ls []types.PlayerLicenseSource\n\tcomment := l.CommentFunc(SELECT_COMMENT)\n\terr := base.GetInstance().IvcDriver().Clauses(comment).Table(IvcPlayerLicenseTable).Scopes(PaginateDB(page, size)).Where(\"delete_time is null\").\n\t\tWhere(filterSource).Find(&ls).Error\n\tif err != nil {\n\t\tif err == db.ErrRecordNotFound {\n\t\t\treturn ls, utils.RecordNotFoundError\n\t\t}\n\t\treturn nil, err\n\t}\n\treturn ls, nil\n}",
    "caller": "func (l *QueryPlayerLicenseLogic) QueryPlayerLicense(req *types.QueryPlayerLicenseRequest, log *log.IvcLog) (resp *types.QueryPlayerLicenseReponse, err error) {\n\tpageReq := req.PaginationRequest\n\tpage, size := model.ReqPagination(&pageReq)\n\tfilter := make(map[string]interface{})\n\tif req.AppId > 0 {\n\t\tfilter[\"app_id\"] = req.AppId\n\t} else if len(req.OwnerUin) > 0 {\n\t\terr := utils.CheckUinStr(req.OwnerUin)\n\t\tif err != nil {\n\t\t\tlog.ErrorV(fmt.Sprintf(\"[QueryCloudRecordTimelineWhitelist] CheckUinStr Param Invalid:%+v\", *req), utils.InvalidParamErr)\n\t\t\treturn nil, utils.InvalidParamError\n\t\t}\n\t\tfilter[\"uin\"] = req.OwnerUin\n\t}\n\tlicense := &model.License{\n\t\tComment: model.NewComment(req.RequestId, model.QueryPlayerLicenseFlow),\n\t}\n\n\ttotal, err := license.CountLicenses(filter)\n\n\tif err != nil {\n\t\tlog.ErrorV(fmt.Sprintf(\"[QueryPlayerLicense] CountLicenses err:%v\", err))\n\t\treturn nil, err\n\t}\n\n\tls, err := license.FindLicenses(filter, page, size)\n\tif err != nil {\n\t\tlog.ErrorV(fmt.Sprintf(\"[QueryPlayerLicense] FindLicenses err:%v\", err))\n\t\treturn nil, err\n\t}\n\tlist := make([]types.PlayerLicenselist, 0, len(ls))\n\n\tfor _, lic := range ls {\n\t\ttmpLicense := types.PlayerLicenselist{\n\t\t\tId:                        lic.Id,\n\t\t\tAppId:                     lic.AppId,\n\t\t\tLicenseKey:                utils.AnonymousString(lic.LicenseKey),\n\t\t\tType:                      lic.Type,\n\t\t\tFeatures:                  lic.Features,\n\t\t\tTechnologies:              lic.Technologies,\n\t\t\tValidDays:                 lic.ValidDays,\n\t\t\tDomainWhitelist:           lic.DomainWhitelist,\n\t\t\tDisableDomainRestrictions: lic.DisableDomainRestrictions,\n\t\t}\n\t\tif lic.EffectiveTime != 0 {\n\t\t\ttmpLicense.EffectiveTime = utils.UnixTimestampToString(int64(lic.EffectiveTime))\n\t\t}\n\t\tlist = append(list, tmpLicense)\n\t}\n\n\treturn &types.QueryPlayerLicenseReponse{\n\t\tTotal: total,\n\t\tList:  list,\n\t\tPage:  page,\n\t\tSize:  size,\n\t}, nil\n}",
    "sql_statement_list": [
      {
        "type": "param_dependent",
        "variants": [
          {
            "scenario": "按AppId查询",
            "sql": "SELECT `id`, `appid`, `license_key`, `type`, `features`, `technologies`, `valid_days`, `disable_domain_restrictions`, `domain_whitelist`, `effective_time` FROM `ivc_player_license` WHERE delete_time is null AND `appid` = ? LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "按Uin查询",
            "sql": "SELECT `id`, `appid`, `license_key`, `type`, `features`, `technologies`, `valid_days`, `disable_domain_restrictions`, `domain_whitelist`, `effective_time` FROM `ivc_player_license` WHERE delete_time is null AND `uin` = ? LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "无额外过滤条件",
            "sql": "SELECT `id`, `appid`, `license_key`, `type`, `features`, `technologies`, `valid_days`, `disable_domain_restrictions`, `domain_whitelist`, `effective_time` FROM `ivc_player_license` WHERE delete_time is null LIMIT ? OFFSET ?;"
          }
        ]
      }
    ],
    "sql_types": [
      "PARAM_DEPENDENT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/types/types.go",
        "code_start_line": 878,
        "code_end_line": 889,
        "code_key": "PlayerLicenseSource",
        "code_value": "type PlayerLicenseSource struct {\n\tId                        string `json:\"Id\" gorm:\"column:id\"`\n\tAppId                     int    `json:\"AppId\" gorm:\"column:appid\"`\n\tLicenseKey                string `json:\"LicenseKey\" gorm:\"column:license_key\"`\n\tType                      string `json:\"Type\" gorm:\"column:type\"`\n\tFeatures                  int    `json:\"Features\" gorm:\"features\"`\n\tTechnologies              int    `json:\"Technologies\" gorm:\"technologies\"`\n\tValidDays                 int    `json:\"ValidDays\" gorm:\"column:valid_days\"`\n\tDisableDomainRestrictions int    `json:\"DisableDomainRestrictions\" gorm:\"column:disable_domain_restrictions\"`\n\tDomainWhitelist           string `json:\"DomainWhitelist\" gorm:\"column:domain_whitelist\"`\n\tEffectiveTime             int    `json:\"EffectiveTime\" gorm:\"column:effective_time\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "c9bb087a681a6287be10c9b6e8e232a6cfc363c7"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-urs.json",
    "matched_keywords": [
      "Scopes"
    ]
  },
  {
    "function_name": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/model/intranet.go:21:46:FindIntranetWhitelists",
    "orm_code": "func (intra *Intranet) FindIntranetWhitelists(filterSource map[string]interface{}, page, size int) ([]types.IntranetSource, error) {\n\tintras := make([]types.IntranetSource, 0)\n\tvar err error\n\tcomment := intra.CommentFunc(SELECT_COMMENT)\n\tif name, ok := filterSource[\"name\"]; ok {\n\t\tfilter := make(map[string]interface{})\n\t\tfor k, v := range filterSource {\n\t\t\tif k == \"name\" {\n\t\t\t\tcontinue\n\t\t\t}\n\t\t\tfilter[k] = v\n\t\t}\n\t\terr = base.GetInstance().IvcDriver().Clauses(comment).Table(IvcIntranetWhitelistTable).Order(\"id\").Scopes(PaginateDB(page, size)).\n\t\t\tWhere(filter).Where(\"name like ?\", \"%\"+name.(string)+\"%\").Find(&intras).Error\n\t} else {\n\t\terr = base.GetInstance().IvcDriver().Clauses(comment).Table(IvcIntranetWhitelistTable).Order(\"id\").Scopes(PaginateDB(page, size)).\n\t\t\tWhere(filterSource).Find(&intras).Error\n\t}\n\tif err != nil {\n\t\tif err == db.ErrRecordNotFound {\n\t\t\treturn intras, utils.RecordNotFoundError\n\t\t}\n\t\treturn intras, err\n\t}\n\treturn intras, nil\n}",
    "caller": "",
    "sql_statement_list": [
      {
        "type": "param_dependent",
        "variants": [
          {
            "scenario": "filterSource包含name字段时",
            "sql": "SELECT id, name, uin, app_id, cluster_id, intranet_addr, describe, create_at, update_at FROM ivc_intranet_whitelist WHERE uin = ? AND app_id = ? AND name LIKE ? ORDER BY id LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "filterSource不包含name字段时",
            "sql": "SELECT id, name, uin, app_id, cluster_id, intranet_addr, describe, create_at, update_at FROM ivc_intranet_whitelist WHERE uin = ? AND app_id = ? AND cluster_id = ? ORDER BY id LIMIT ? OFFSET ?;"
          }
        ]
      }
    ],
    "sql_types": [
      "PARAM_DEPENDENT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/types/types.go",
        "code_start_line": 730,
        "code_end_line": 740,
        "code_key": "IntranetSource",
        "code_value": "type IntranetSource struct {\n\tId           int    `json:\"Id\" gorm:\"column:id\"`\n\tName         string `json:\"Name\" gorm:\"column:name\"`\n\tUin          string `json:\"Uin\" gorm:\"column:uin\"`\n\tAppId        int    `json:\"AppId\" gorm:\"column:app_id\"`\n\tClusterId    string `json:\"ClusterId\" gorm:\"column:cluster_id\"`\n\tIntranetAddr string `json:\"IntranetAddr\" gorm:\"column:intranet_addr\"`\n\tDescribe     string `json:\"Describe\" gorm:\"column:describe\"`\n\tCreatedAt    int    `json:\"CreateAt\" gorm:\"column:create_at;default:NULL\"`\n\tUpdatedAt    int    `json:\"UpdateAt\" gorm:\"column:update_at;default:NULL\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "c9bb087a681a6287be10c9b6e8e232a6cfc363c7"
      }
    ],
    "sql_pattern_cnt": 2,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-urs.json",
    "matched_keywords": [
      "Scopes"
    ]
  },
  {
    "function_name": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/model/intranet.go:21:46:FindIntranetWhitelists",
    "orm_code": "func (intra *Intranet) FindIntranetWhitelists(filterSource map[string]interface{}, page, size int) ([]types.IntranetSource, error) {\n\tintras := make([]types.IntranetSource, 0)\n\tvar err error\n\tcomment := intra.CommentFunc(SELECT_COMMENT)\n\tif name, ok := filterSource[\"name\"]; ok {\n\t\tfilter := make(map[string]interface{})\n\t\tfor k, v := range filterSource {\n\t\t\tif k == \"name\" {\n\t\t\t\tcontinue\n\t\t\t}\n\t\t\tfilter[k] = v\n\t\t}\n\t\terr = base.GetInstance().IvcDriver().Clauses(comment).Table(IvcIntranetWhitelistTable).Order(\"id\").Scopes(PaginateDB(page, size)).\n\t\t\tWhere(filter).Where(\"name like ?\", \"%\"+name.(string)+\"%\").Find(&intras).Error\n\t} else {\n\t\terr = base.GetInstance().IvcDriver().Clauses(comment).Table(IvcIntranetWhitelistTable).Order(\"id\").Scopes(PaginateDB(page, size)).\n\t\t\tWhere(filterSource).Find(&intras).Error\n\t}\n\tif err != nil {\n\t\tif err == db.ErrRecordNotFound {\n\t\t\treturn intras, utils.RecordNotFoundError\n\t\t}\n\t\treturn intras, err\n\t}\n\treturn intras, nil\n}",
    "caller": "func (l *QueryIntranetWhitelistLogic) QueryIntranetWhitelist(req *types.QueryIntranetWhitelistRequest, log *logger.IvcLog) (resp *types.QueryIntranetWhitelistReponse, err error) {\n\t// 1. 参数校验\n\tpageReq := req.PaginationRequest\n\tpage, size := model.ReqPagination(&pageReq)\n\tfilter := make(map[string]interface{})\n\tif req.AppId > 0 {\n\t\tfilter[\"app_id\"] = req.AppId\n\t} else if len(req.OwnerUin) > 0 {\n\t\terr := utils.CheckUinStr(req.OwnerUin)\n\t\tif err != nil {\n\t\t\tlog.ErrorV(fmt.Sprintf(\"[QueryIntranetWhitelist] CheckUinStr Param Invalid:%+v\", *req), utils.InvalidParamErr)\n\t\t\treturn nil, utils.InvalidParamError\n\t\t}\n\t\tfilter[\"uin\"] = req.OwnerUin\n\t} else if len(req.Name) > 0 {\n\t\terr := utils.CheckNameStr(req.Name)\n\t\tif err != nil {\n\t\t\tlog.ErrorV(fmt.Sprintf(\"[QueryIntranetWhitelist] CheckNameStr Param Invalid:%+v\", *req), utils.InvalidParamErr)\n\t\t\treturn nil, utils.InvalidParamError\n\t\t}\n\t\tfilter[\"name\"] = req.Name\n\t}\n\n\tif len(req.ClusterId) > 0 {\n\t\terr := utils.CheckUUID(req.ClusterId)\n\t\tif err != nil {\n\t\t\tlog.ErrorV(fmt.Sprintf(\"[QueryIntranetWhitelist] CheckUUIDClusterId Param Invalid:%+v\", *req), utils.InvalidParamErr)\n\t\t\treturn nil, utils.InvalidParamError\n\t\t}\n\t\tfilter[\"cluster_id\"] = req.ClusterId\n\t}\n\tcomment := model.NewComment(req.RequestId, QueryIntranetWhitelistFlow)\n\t// 2. 查找符合条件的媒体白名单列表\n\tintra := &model.Intranet{\n\t\tComment: comment,\n\t}\n\tins, err := intra.FindIntranetWhitelists(filter, page, size)\n\tif err != nil {\n\t\terrCode := utils.OperationErr\n\t\tif e, ok := err.(*utils.UrsError); ok {\n\t\t\terrCode = e.Id\n\t\t}\n\t\tlog.ErrorV(fmt.Sprintf(\"[QueryIntranetWhitelist] FindIntranetWhitelists err:%v\", err), errCode)\n\t\treturn nil, err\n\t}\n\n\t// 3. 查询集群列表\n\tc := &model.Cluster{\n\t\tComment: comment,\n\t}\n\tclusters, err := c.GetClusterIdList(log)\n\tif err != nil {\n\t\terrCode := utils.OperationErr\n\t\tif e, ok := err.(*utils.UrsError); ok {\n\t\t\terrCode = e.Id\n\t\t}\n\t\tlog.ErrorV(fmt.Sprintf(\"[QueryIntranetWhitelist] GetClusterIdList err:%v\", err), errCode)\n\t\treturn nil, err\n\t}\n\tclusterMap := make(map[string]string, 0)\n\tfor _, clu := range clusters {\n\t\tclusterMap[clu.ClusterId] = clu.ClusterName\n\t}\n\n\t// 4. 处理组合结果\n\tintranetWhitelist := MatchIntranetWhitelistResp(ins, clusterMap, log)\n\n\t// 5. 查询符合条件的媒体白名单总数\n\ttotal, err := intra.FindIntranetWhitelistCount(filter)\n\tif err != nil {\n\t\terrCode := utils.OperationErr\n\t\tif e, ok := err.(*utils.UrsError); ok {\n\t\t\terrCode = e.Id\n\t\t}\n\t\tlog.ErrorV(fmt.Sprintf(\"[QueryIntranetWhitelist] FindIntranetWhitelistCount err:%v\", err), errCode)\n\t\treturn nil, err\n\t}\n\n\tresp = &types.QueryIntranetWhitelistReponse{\n\t\tIntranets: intranetWhitelist,\n\t\tTotal:     total,\n\t\tPage:      page,\n\t\tSize:      size,\n\t}\n\n\treturn resp, nil\n}",
    "sql_statement_list": [
      {
        "type": "param_dependent",
        "variants": [
          {
            "scenario": "filterSource包含name字段时，使用LIKE模糊匹配name并精确匹配其他字段",
            "sql": "SELECT * FROM ivc_intranet_whitelist WHERE app_id = ? AND cluster_id = ? AND name LIKE ? ORDER BY id LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "filterSource不包含name字段时，所有字段都使用精确匹配",
            "sql": "SELECT * FROM ivc_intranet_whitelist WHERE app_id = ? AND uin = ? ORDER BY id LIMIT ? OFFSET ?;"
          }
        ]
      }
    ],
    "sql_types": [
      "PARAM_DEPENDENT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/types/types.go",
        "code_start_line": 730,
        "code_end_line": 740,
        "code_key": "IntranetSource",
        "code_value": "type IntranetSource struct {\n\tId           int    `json:\"Id\" gorm:\"column:id\"`\n\tName         string `json:\"Name\" gorm:\"column:name\"`\n\tUin          string `json:\"Uin\" gorm:\"column:uin\"`\n\tAppId        int    `json:\"AppId\" gorm:\"column:app_id\"`\n\tClusterId    string `json:\"ClusterId\" gorm:\"column:cluster_id\"`\n\tIntranetAddr string `json:\"IntranetAddr\" gorm:\"column:intranet_addr\"`\n\tDescribe     string `json:\"Describe\" gorm:\"column:describe\"`\n\tCreatedAt    int    `json:\"CreateAt\" gorm:\"column:create_at;default:NULL\"`\n\tUpdatedAt    int    `json:\"UpdateAt\" gorm:\"column:update_at;default:NULL\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "c9bb087a681a6287be10c9b6e8e232a6cfc363c7"
      }
    ],
    "sql_pattern_cnt": 2,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-urs.json",
    "matched_keywords": [
      "Scopes"
    ]
  },
  {
    "function_name": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/model/device.go:347:359:FindDevicesByAppIdBak",
    "orm_code": "func (d *Device) FindDevicesByAppIdBak(filter map[string]interface{}, page, size int) ([]types.DeviceSource, error) {\n\tds := make([]types.DeviceSource, 0)\n\tcomment := d.CommentFunc(SELECT_COMMENT)\n\terr := base.GetInstance().IvcDriver().Clauses(comment).Table(IvcDeviceTable).Order(\"id\").Scopes(PaginateDB(page, size)).\n\t\tWhere(filter).Where(\"deleted_at is null\").Find(&ds).Error\n\tif err != nil {\n\t\tif err == db.ErrRecordNotFound {\n\t\t\treturn ds, utils.RecordNotFoundError\n\t\t}\n\t\treturn ds, err\n\t}\n\treturn ds, nil\n}",
    "caller": "",
    "sql_statement_list": [
      {
        "type": "param_dependent",
        "variants": [
          {
            "scenario": "filter为空时",
            "sql": "SELECT id, name, code, access_protocol, type, status, cluster_id, cluster_name, region, created_at, updated_at FROM ivc_device_table WHERE deleted_at is null ORDER BY id LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "filter包含单个条件时",
            "sql": "SELECT id, name, code, access_protocol, type, status, cluster_id, cluster_name, region, created_at, updated_at FROM ivc_device_table WHERE status = ? AND deleted_at is null ORDER BY id LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "filter包含多个条件时",
            "sql": "SELECT id, name, code, access_protocol, type, status, cluster_id, cluster_name, region, created_at, updated_at FROM ivc_device_table WHERE status = ? AND type = ? AND cluster_id = ? AND deleted_at is null ORDER BY id LIMIT ? OFFSET ?;"
          }
        ]
      }
    ],
    "sql_types": [
      "PARAM_DEPENDENT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/types/types.go",
        "code_start_line": 599,
        "code_end_line": 611,
        "code_key": "DeviceSource",
        "code_value": "type DeviceSource struct {\n\tID             string `json:\"Id\" gorm:\"column:id\"`\n\tName           string `json:\"Name\" gorm:\"column:name\"`\n\tCode           string `json:\"Code\" gorm:\"column:code\"`\n\tAccessProtocol int    `json:\"AccessProtocol\" gorm:\"column:access_protocol\"`\n\tType           int    `json:\"Type\" gorm:\"column:type\"`\n\tStatus         int    `json:\"Status\" gorm:\"column:status\"`\n\tClusterId      string `json:\"ClusterId\" gorm:\"column:cluster_id\"`\n\tClusterName    string `json:\"ClusterName\" gorm:\"column:cluster_name\"`\n\tRegion         string `json:\"Region\" gorm:\"column:region\"`\n\tCreatedAt      int    `json:\"CreateAt\" gorm:\"column:created_at\"`\n\tUpdatedAt      int    `json:\"UpdateAt\" gorm:\"column:updated_at\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "c9bb087a681a6287be10c9b6e8e232a6cfc363c7"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-urs.json",
    "matched_keywords": [
      "Scopes"
    ]
  },
  {
    "function_name": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/model/device.go:537:570:FindChannelsByAppId",
    "orm_code": "func (d *Device) FindChannelsByAppId(filter map[string]interface{}, page, size int) ([]types.ChannelSource, error) {\n\tcs := make([]types.ChannelSource, 0)\n\tdbt := base.GetInstance().IvcDriver().Clauses(d.CommentFunc(SELECT_COMMENT)).Select(FindChannelColumn).\n\t\tTable(\"ivc_channel as c\").Joins(\"inner join ivc_device as d on c.device_id=d.id\").Where(\"d.deleted_at is null and c.deleted_at is null\")\n\tif d.DeviceQuery.AppId != 0 {\n\t\tdbt = dbt.Where(\"d.app_id=?\", d.DeviceQuery.AppId)\n\t}\n\tif deviceId, ok := filter[\"device_id\"]; ok {\n\t\tdbt = dbt.Where(\"d.id=?\", deviceId)\n\t}\n\tif accessType, ok := filter[\"access_protocol\"]; ok {\n\t\tdbt = dbt.Where(\"d.access_protocol=?\", accessType)\n\t}\n\tif status, ok := filter[\"status\"]; ok {\n\t\tdbt = dbt.Where(\"d.status=?\", status)\n\t}\n\tif state, ok := filter[\"state\"]; ok {\n\t\tdbt = dbt.Where(\"c.state=?\", state)\n\t}\n\tif id, ok := filter[\"id\"]; ok {\n\t\tdbt = dbt.Where(\"c.id=?\", id)\n\t}\n\tif name, ok := filter[\"name\"]; ok {\n\t\tdbt = dbt.Where(\"c.name like ?\", \"%\"+name.(string)+\"%\")\n\t}\n\terr := dbt.Order(\"c.id\").Scopes(PaginateDB(page, size)).Scan(&cs).Error\n\tif err != nil {\n\t\tif err == db.ErrRecordNotFound {\n\t\t\treturn cs, utils.RecordNotFoundError\n\t\t}\n\t\treturn cs, err\n\t}\n\treturn cs, nil\n}",
    "caller": "",
    "sql_statement_list": [
      {
        "type": "param_dependent",
        "variants": [
          {
            "scenario": "最基础查询（AppId=0，filter为空）",
            "sql": "SELECT c.id, c.device_id, c.code, c.name, c.state, c.ptz_type, d.device_code, d.device_name, d.status, d.access_protocol, c.created_at, c.updated_at FROM ivc_channel AS c INNER JOIN ivc_device AS d ON c.device_id = d.id WHERE d.deleted_at IS NULL AND c.deleted_at IS NULL ORDER BY c.id LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "包含AppId条件",
            "sql": "SELECT c.id, c.device_id, c.code, c.name, c.state, c.ptz_type, d.device_code, d.device_name, d.status, d.access_protocol, c.created_at, c.updated_at FROM ivc_channel AS c INNER JOIN ivc_device AS d ON c.device_id = d.id WHERE d.deleted_at IS NULL AND c.deleted_at IS NULL AND d.app_id = ? ORDER BY c.id LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "包含device_id过滤",
            "sql": "SELECT c.id, c.device_id, c.code, c.name, c.state, c.ptz_type, d.device_code, d.device_name, d.status, d.access_protocol, c.created_at, c.updated_at FROM ivc_channel AS c INNER JOIN ivc_device AS d ON c.device_id = d.id WHERE d.deleted_at IS NULL AND c.deleted_at IS NULL AND d.id = ? ORDER BY c.id LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "包含access_protocol过滤",
            "sql": "SELECT c.id, c.device_id, c.code, c.name, c.state, c.ptz_type, d.device_code, d.device_name, d.status, d.access_protocol, c.created_at, c.updated_at FROM ivc_channel AS c INNER JOIN ivc_device AS d ON c.device_id = d.id WHERE d.deleted_at IS NULL AND c.deleted_at IS NULL AND d.access_protocol = ? ORDER BY c.id LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "包含status过滤",
            "sql": "SELECT c.id, c.device_id, c.code, c.name, c.state, c.ptz_type, d.device_code, d.device_name, d.status, d.access_protocol, c.created_at, c.updated_at FROM ivc_channel AS c INNER JOIN ivc_device AS d ON c.device_id = d.id WHERE d.deleted_at IS NULL AND c.deleted_at IS NULL AND d.status = ? ORDER BY c.id LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "包含state过滤",
            "sql": "SELECT c.id, c.device_id, c.code, c.name, c.state, c.ptz_type, d.device_code, d.device_name, d.status, d.access_protocol, c.created_at, c.updated_at FROM ivc_channel AS c INNER JOIN ivc_device AS d ON c.device_id = d.id WHERE d.deleted_at IS NULL AND c.deleted_at IS NULL AND c.state = ? ORDER BY c.id LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "包含id过滤",
            "sql": "SELECT c.id, c.device_id, c.code, c.name, c.state, c.ptz_type, d.device_code, d.device_name, d.status, d.access_protocol, c.created_at, c.updated_at FROM ivc_channel AS c INNER JOIN ivc_device AS d ON c.device_id = d.id WHERE d.deleted_at IS NULL AND c.deleted_at IS NULL AND c.id = ? ORDER BY c.id LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "包含name模糊匹配过滤",
            "sql": "SELECT c.id, c.device_id, c.code, c.name, c.state, c.ptz_type, d.device_code, d.device_name, d.status, d.access_protocol, c.created_at, c.updated_at FROM ivc_channel AS c INNER JOIN ivc_device AS d ON c.device_id = d.id WHERE d.deleted_at IS NULL AND c.deleted_at IS NULL AND c.name LIKE ? ORDER BY c.id LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "AppId + 多个filter条件组合",
            "sql": "SELECT c.id, c.device_id, c.code, c.name, c.state, c.ptz_type, d.device_code, d.device_name, d.status, d.access_protocol, c.created_at, c.updated_at FROM ivc_channel AS c INNER JOIN ivc_device AS d ON c.device_id = d.id WHERE d.deleted_at IS NULL AND c.deleted_at IS NULL AND d.app_id = ? AND d.id = ? AND d.access_protocol = ? AND d.status = ? AND c.state = ? AND c.id = ? AND c.name LIKE ? ORDER BY c.id LIMIT ? OFFSET ?;"
          }
        ]
      }
    ],
    "sql_types": [
      "PARAM_DEPENDENT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/types/types.go",
        "code_start_line": 359,
        "code_end_line": 372,
        "code_key": "ChannelSource",
        "code_value": "type ChannelSource struct {\n\tChannelId      string `json:\"ChannelId\" gorm:\"column:id\"`\n\tDeviceID       string `json:\"DeviceId\" gorm:\"column:device_id\"`\n\tChannelCode    string `json:\"ChannelCode\" gorm:\"column:code\"`\n\tName           string `json:\"Name\" gorm:\"column:name\"`\n\tState          int    `json:\"State\" gorm:\"column:state\"`\n\tPTZType        int    `json:\"PTZType\" gorm:\"column:ptz_type\"`\n\tDeviceCode     string `json:\"DeviceCode\" gorm:\"column:device_code\"`\n\tDeviceName     string `json:\"DeviceName\" gorm:\"column:device_name\"`\n\tDeviceStatus   int    `json:\"DeviceStatus\" gorm:\"column:status\"`\n\tAccessProtocol int    `json:\"AccessProtocol\" gorm:\"column:access_protocol\"`\n\tCreatedAt      int    `json:\"CreateAt\" gorm:\"column:created_at\"`\n\tUpdatedAt      int    `json:\"UpdateAt\" gorm:\"column:updated_at\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "c9bb087a681a6287be10c9b6e8e232a6cfc363c7"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-urs.json",
    "matched_keywords": [
      "Scopes"
    ]
  },
  {
    "function_name": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/model/device.go:537:570:FindChannelsByAppId",
    "orm_code": "func (d *Device) FindChannelsByAppId(filter map[string]interface{}, page, size int) ([]types.ChannelSource, error) {\n\tcs := make([]types.ChannelSource, 0)\n\tdbt := base.GetInstance().IvcDriver().Clauses(d.CommentFunc(SELECT_COMMENT)).Select(FindChannelColumn).\n\t\tTable(\"ivc_channel as c\").Joins(\"inner join ivc_device as d on c.device_id=d.id\").Where(\"d.deleted_at is null and c.deleted_at is null\")\n\tif d.DeviceQuery.AppId != 0 {\n\t\tdbt = dbt.Where(\"d.app_id=?\", d.DeviceQuery.AppId)\n\t}\n\tif deviceId, ok := filter[\"device_id\"]; ok {\n\t\tdbt = dbt.Where(\"d.id=?\", deviceId)\n\t}\n\tif accessType, ok := filter[\"access_protocol\"]; ok {\n\t\tdbt = dbt.Where(\"d.access_protocol=?\", accessType)\n\t}\n\tif status, ok := filter[\"status\"]; ok {\n\t\tdbt = dbt.Where(\"d.status=?\", status)\n\t}\n\tif state, ok := filter[\"state\"]; ok {\n\t\tdbt = dbt.Where(\"c.state=?\", state)\n\t}\n\tif id, ok := filter[\"id\"]; ok {\n\t\tdbt = dbt.Where(\"c.id=?\", id)\n\t}\n\tif name, ok := filter[\"name\"]; ok {\n\t\tdbt = dbt.Where(\"c.name like ?\", \"%\"+name.(string)+\"%\")\n\t}\n\terr := dbt.Order(\"c.id\").Scopes(PaginateDB(page, size)).Scan(&cs).Error\n\tif err != nil {\n\t\tif err == db.ErrRecordNotFound {\n\t\t\treturn cs, utils.RecordNotFoundError\n\t\t}\n\t\treturn cs, err\n\t}\n\treturn cs, nil\n}",
    "caller": "func (l *ChannelListLogic) ChannelList(req *types.ChannelRequest, log *logger.IvcLog) (resp *types.ChannelListResp, err error) {\n\tcomment := model.NewComment(req.RequestId, model.ChannelListFlow)\n\tif !model.HasWritePermission(log, req.UserName, comment) {\n\t\treturn nil, utils.PermissionDeniedError\n\t}\n\tgeneralReq := req.GeneralRequest\n\tpageReq := req.PaginationRequest\n\tappId, err := getAppId(&generalReq, log, comment)\n\tif err != nil {\n\t\tlog.ErrorV(fmt.Sprintf(\"[ChannelList] getAppId:%+v err:%v\", *req, err))\n\t\treturn nil, err\n\t}\n\tpage, size := model.ReqPagination(&pageReq)\n\n\tchannelFilterReq := &QueryChannelFilterReq{\n\t\tID:           req.ID,\n\t\tName:         req.Name,\n\t\tAccessType:   req.AccessType,\n\t\tDeviceStatus: req.DeviceStatus,\n\t\tChannelState: req.ChannelState,\n\t\tDeviceId:     req.DeviceId,\n\t}\n\tfilter, err := buildChannelFilterMap(channelFilterReq, appId, log)\n\tif err != nil {\n\t\treturn nil, err\n\t}\n\n\tdevice := &model.Device{\n\t\tComment: comment,\n\t}\n\tdevice.AppId = appId\n\tchs, err := device.FindChannelsByAppId(filter, page, size)\n\tif err != nil {\n\t\terrCode := utils.OperationErr\n\t\tif e, ok := err.(*utils.UrsError); ok {\n\t\t\terrCode = e.Id\n\t\t}\n\t\tlog.ErrorV(fmt.Sprintf(\"[ChannelList] FindChannelsByAppId err:%v\", err), errCode)\n\t\treturn nil, err\n\t}\n\tchannelList := MatchChannelInfoList(chs)\n\n\ttotal, err := device.FindChannelCountByAppId(filter)\n\tif err != nil {\n\t\terrCode := utils.OperationErr\n\t\tif e, ok := err.(*utils.UrsError); ok {\n\t\t\terrCode = e.Id\n\t\t}\n\t\tlog.ErrorV(fmt.Sprintf(\"[ChannelList] FindChannelCountByAppId err:%v\", err), errCode)\n\t\treturn nil, err\n\t}\n\n\tresp = &types.ChannelListResp{\n\t\tChannels: channelList,\n\t\tTotal:    total,\n\t\tPage:     page,\n\t\tSize:     size,\n\t}\n\n\treturn resp, nil\n}",
    "sql_statement_list": [
      {
        "type": "param_dependent",
        "variants": [
          {
            "scenario": "只有AppId条件",
            "sql": "SELECT c.id, c.device_id, c.code, c.name, c.state, c.ptz_type, d.device_code, d.device_name, d.status, d.access_protocol, c.created_at, c.updated_at FROM ivc_channel as c INNER JOIN ivc_device as d ON c.device_id=d.id WHERE d.deleted_at IS NULL AND c.deleted_at IS NULL AND d.app_id=? ORDER BY c.id LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "AppId + device_id",
            "sql": "SELECT c.id, c.device_id, c.code, c.name, c.state, c.ptz_type, d.device_code, d.device_name, d.status, d.access_protocol, c.created_at, c.updated_at FROM ivc_channel as c INNER JOIN ivc_device as d ON c.device_id=d.id WHERE d.deleted_at IS NULL AND c.deleted_at IS NULL AND d.app_id=? AND d.id=? ORDER BY c.id LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "AppId + access_protocol",
            "sql": "SELECT c.id, c.device_id, c.code, c.name, c.state, c.ptz_type, d.device_code, d.device_name, d.status, d.access_protocol, c.created_at, c.updated_at FROM ivc_channel as c INNER JOIN ivc_device as d ON c.device_id=d.id WHERE d.deleted_at IS NULL AND c.deleted_at IS NULL AND d.app_id=? AND d.access_protocol=? ORDER BY c.id LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "AppId + status",
            "sql": "SELECT c.id, c.device_id, c.code, c.name, c.state, c.ptz_type, d.device_code, d.device_name, d.status, d.access_protocol, c.created_at, c.updated_at FROM ivc_channel as c INNER JOIN ivc_device as d ON c.device_id=d.id WHERE d.deleted_at IS NULL AND c.deleted_at IS NULL AND d.app_id=? AND d.status=? ORDER BY c.id LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "AppId + state",
            "sql": "SELECT c.id, c.device_id, c.code, c.name, c.state, c.ptz_type, d.device_code, d.device_name, d.status, d.access_protocol, c.created_at, c.updated_at FROM ivc_channel as c INNER JOIN ivc_device as d ON c.device_id=d.id WHERE d.deleted_at IS NULL AND c.deleted_at IS NULL AND d.app_id=? AND c.state=? ORDER BY c.id LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "AppId + id",
            "sql": "SELECT c.id, c.device_id, c.code, c.name, c.state, c.ptz_type, d.device_code, d.device_name, d.status, d.access_protocol, c.created_at, c.updated_at FROM ivc_channel as c INNER JOIN ivc_device as d ON c.device_id=d.id WHERE d.deleted_at IS NULL AND c.deleted_at IS NULL AND d.app_id=? AND c.id=? ORDER BY c.id LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "AppId + name",
            "sql": "SELECT c.id, c.device_id, c.code, c.name, c.state, c.ptz_type, d.device_code, d.device_name, d.status, d.access_protocol, c.created_at, c.updated_at FROM ivc_channel as c INNER JOIN ivc_device as d ON c.device_id=d.id WHERE d.deleted_at IS NULL AND c.deleted_at IS NULL AND d.app_id=? AND c.name LIKE ? ORDER BY c.id LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "AppId + 多个条件组合",
            "sql": "SELECT c.id, c.device_id, c.code, c.name, c.state, c.ptz_type, d.device_code, d.device_name, d.status, d.access_protocol, c.created_at, c.updated_at FROM ivc_channel as c INNER JOIN ivc_device as d ON c.device_id=d.id WHERE d.deleted_at IS NULL AND c.deleted_at IS NULL AND d.app_id=? AND d.id=? AND d.access_protocol=? AND d.status=? AND c.state=? AND c.id=? AND c.name LIKE ? ORDER BY c.id LIMIT ? OFFSET ?;"
          }
        ]
      }
    ],
    "sql_types": [
      "PARAM_DEPENDENT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/types/types.go",
        "code_start_line": 359,
        "code_end_line": 372,
        "code_key": "ChannelSource",
        "code_value": "type ChannelSource struct {\n\tChannelId      string `json:\"ChannelId\" gorm:\"column:id\"`\n\tDeviceID       string `json:\"DeviceId\" gorm:\"column:device_id\"`\n\tChannelCode    string `json:\"ChannelCode\" gorm:\"column:code\"`\n\tName           string `json:\"Name\" gorm:\"column:name\"`\n\tState          int    `json:\"State\" gorm:\"column:state\"`\n\tPTZType        int    `json:\"PTZType\" gorm:\"column:ptz_type\"`\n\tDeviceCode     string `json:\"DeviceCode\" gorm:\"column:device_code\"`\n\tDeviceName     string `json:\"DeviceName\" gorm:\"column:device_name\"`\n\tDeviceStatus   int    `json:\"DeviceStatus\" gorm:\"column:status\"`\n\tAccessProtocol int    `json:\"AccessProtocol\" gorm:\"column:access_protocol\"`\n\tCreatedAt      int    `json:\"CreateAt\" gorm:\"column:created_at\"`\n\tUpdatedAt      int    `json:\"UpdateAt\" gorm:\"column:updated_at\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "c9bb087a681a6287be10c9b6e8e232a6cfc363c7"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-urs.json",
    "matched_keywords": [
      "Scopes"
    ]
  },
  {
    "function_name": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/model/device.go:780:792:paginateQueryChannelListByAppId",
    "orm_code": "func (dm *DeviceChanManger) paginateQueryChannelListByAppId(wg *sync.WaitGroup, db *gorm.DB, page, size int) {\n\tcs := make([]types.ChannelSource, 0)\n\tdefer wg.Done()\n\terr := db.Order(\"c.id\").Scopes(PaginateDB(page, size)).Scan(&cs).Error\n\tif dm == nil || dm.DeviceChanInfoChan() == nil || dm.ErrQueryChan() == nil {\n\t\treturn\n\t}\n\tif err != nil && err == gorm.ErrRecordNotFound {\n\t\tdm.errChan <- err\n\t\treturn\n\t}\n\tdm.chanListChan <- cs\n}",
    "caller": "",
    "sql_statement_list": [
      {
        "type": "param_dependent",
        "variants": [
          {
            "scenario": "分页查询第1页，每页10条",
            "sql": "SELECT id, device_id, code, name, state, ptz_type, device_code, device_name, status, access_protocol, created_at, updated_at FROM channel_source c ORDER BY c.id LIMIT 10 OFFSET 0;"
          },
          {
            "scenario": "分页查询第2页，每页20条",
            "sql": "SELECT id, device_id, code, name, state, ptz_type, device_code, device_name, status, access_protocol, created_at, updated_at FROM channel_source c ORDER BY c.id LIMIT 20 OFFSET 20;"
          },
          {
            "scenario": "分页查询第3页，每页5条",
            "sql": "SELECT id, device_id, code, name, state, ptz_type, device_code, device_name, status, access_protocol, created_at, updated_at FROM channel_source c ORDER BY c.id LIMIT 5 OFFSET 10;"
          }
        ]
      }
    ],
    "sql_types": [
      "PARAM_DEPENDENT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/types/types.go",
        "code_start_line": 359,
        "code_end_line": 372,
        "code_key": "ChannelSource",
        "code_value": "type ChannelSource struct {\n\tChannelId      string `json:\"ChannelId\" gorm:\"column:id\"`\n\tDeviceID       string `json:\"DeviceId\" gorm:\"column:device_id\"`\n\tChannelCode    string `json:\"ChannelCode\" gorm:\"column:code\"`\n\tName           string `json:\"Name\" gorm:\"column:name\"`\n\tState          int    `json:\"State\" gorm:\"column:state\"`\n\tPTZType        int    `json:\"PTZType\" gorm:\"column:ptz_type\"`\n\tDeviceCode     string `json:\"DeviceCode\" gorm:\"column:device_code\"`\n\tDeviceName     string `json:\"DeviceName\" gorm:\"column:device_name\"`\n\tDeviceStatus   int    `json:\"DeviceStatus\" gorm:\"column:status\"`\n\tAccessProtocol int    `json:\"AccessProtocol\" gorm:\"column:access_protocol\"`\n\tCreatedAt      int    `json:\"CreateAt\" gorm:\"column:created_at\"`\n\tUpdatedAt      int    `json:\"UpdateAt\" gorm:\"column:updated_at\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "c9bb087a681a6287be10c9b6e8e232a6cfc363c7"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-urs.json",
    "matched_keywords": [
      "Scopes"
    ]
  },
  {
    "function_name": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/model/device.go:780:792:paginateQueryChannelListByAppId",
    "orm_code": "func (dm *DeviceChanManger) paginateQueryChannelListByAppId(wg *sync.WaitGroup, db *gorm.DB, page, size int) {\n\tcs := make([]types.ChannelSource, 0)\n\tdefer wg.Done()\n\terr := db.Order(\"c.id\").Scopes(PaginateDB(page, size)).Scan(&cs).Error\n\tif dm == nil || dm.DeviceChanInfoChan() == nil || dm.ErrQueryChan() == nil {\n\t\treturn\n\t}\n\tif err != nil && err == gorm.ErrRecordNotFound {\n\t\tdm.errChan <- err\n\t\treturn\n\t}\n\tdm.chanListChan <- cs\n}",
    "caller": "func (dm *DeviceChanManger) FindTotalChannelList(filter map[string]interface{}) {\n\ttempdb := base.GetInstance().IvcDriver().Clauses(dm.Dev.CommentFunc(SELECT_COMMENT)).Table(\"ivc_channel as c\").\n\t\tJoins(\"inner join ivc_device as d on c.device_id=d.id\").Where(\"d.deleted_at is null and c.deleted_at is null\")\n\tif dm.Dev.DeviceQuery.AppId != 0 {\n\t\ttempdb = tempdb.Where(\"d.app_id=?\", dm.Dev.DeviceQuery.AppId)\n\t}\n\tif deviceId, ok := filter[\"device_id\"]; ok {\n\t\ttempdb = tempdb.Where(\"d.id=?\", deviceId)\n\t}\n\tif accessType, ok := filter[\"access_protocol\"]; ok {\n\t\ttempdb = tempdb.Where(\"d.access_protocol=?\", accessType)\n\t}\n\tif status, ok := filter[\"status\"]; ok {\n\t\ttempdb = tempdb.Where(\"d.status=?\", status)\n\t}\n\tif state, ok := filter[\"state\"]; ok {\n\t\ttempdb = tempdb.Where(\"c.state=?\", state)\n\t}\n\tif id, ok := filter[\"id\"]; ok {\n\t\ttempdb = tempdb.Where(\"c.id=?\", id)\n\t}\n\tif name, ok := filter[\"name\"]; ok {\n\t\ttempdb = tempdb.Where(\"c.name like ?\", \"%\"+name.(string)+\"%\")\n\t}\n\tvar total int64\n\terr := tempdb.Count(&total).Error\n\ttempdb = tempdb.Select(FindTotalChannelListColumn)\n\ttempTotal := int(total)\n\tdm.TotalNum = &tempTotal\n\tif err != nil {\n\t\tdm.errChan <- err\n\t\treturn\n\t}\n\tvar wg sync.WaitGroup\n\tfor i := 0; i <= tempTotal/base.DefaultDownloadSize; i++ {\n\t\twg.Add(1)\n\t\tgo dm.paginateQueryChannelListByAppId(&wg, tempdb, i+1, base.DefaultDownloadSize)\n\t}\n\twg.Wait()\n}",
    "sql_statement_list": [
      {
        "type": "param_dependent",
        "variants": [
          {
            "scenario": "AppId不为0，无额外filter条件",
            "sql": "SELECT c.id, c.device_id, c.code, c.name, c.state, c.ptz_type, d.device_code, d.device_name, d.status, d.access_protocol, c.created_at, c.updated_at FROM ivc_channel as c INNER JOIN ivc_device as d ON c.device_id = d.id WHERE d.deleted_at IS NULL AND c.deleted_at IS NULL AND d.app_id = ? ORDER BY c.id LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "AppId不为0，包含device_id条件",
            "sql": "SELECT c.id, c.device_id, c.code, c.name, c.state, c.ptz_type, d.device_code, d.device_name, d.status, d.access_protocol, c.created_at, c.updated_at FROM ivc_channel as c INNER JOIN ivc_device as d ON c.device_id = d.id WHERE d.deleted_at IS NULL AND c.deleted_at IS NULL AND d.app_id = ? AND d.id = ? ORDER BY c.id LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "AppId不为0，包含access_protocol条件",
            "sql": "SELECT c.id, c.device_id, c.code, c.name, c.state, c.ptz_type, d.device_code, d.device_name, d.status, d.access_protocol, c.created_at, c.updated_at FROM ivc_channel as c INNER JOIN ivc_device as d ON c.device_id = d.id WHERE d.deleted_at IS NULL AND c.deleted_at IS NULL AND d.app_id = ? AND d.access_protocol = ? ORDER BY c.id LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "AppId不为0，包含status条件",
            "sql": "SELECT c.id, c.device_id, c.code, c.name, c.state, c.ptz_type, d.device_code, d.device_name, d.status, d.access_protocol, c.created_at, c.updated_at FROM ivc_channel as c INNER JOIN ivc_device as d ON c.device_id = d.id WHERE d.deleted_at IS NULL AND c.deleted_at IS NULL AND d.app_id = ? AND d.status = ? ORDER BY c.id LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "AppId不为0，包含state条件",
            "sql": "SELECT c.id, c.device_id, c.code, c.name, c.state, c.ptz_type, d.device_code, d.device_name, d.status, d.access_protocol, c.created_at, c.updated_at FROM ivc_channel as c INNER JOIN ivc_device as d ON c.device_id = d.id WHERE d.deleted_at IS NULL AND c.deleted_at IS NULL AND d.app_id = ? AND c.state = ? ORDER BY c.id LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "AppId不为0，包含id条件",
            "sql": "SELECT c.id, c.device_id, c.code, c.name, c.state, c.ptz_type, d.device_code, d.device_name, d.status, d.access_protocol, c.created_at, c.updated_at FROM ivc_channel as c INNER JOIN ivc_device as d ON c.device_id = d.id WHERE d.deleted_at IS NULL AND c.deleted_at IS NULL AND d.app_id = ? AND c.id = ? ORDER BY c.id LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "AppId不为0，包含name条件",
            "sql": "SELECT c.id, c.device_id, c.code, c.name, c.state, c.ptz_type, d.device_code, d.device_name, d.status, d.access_protocol, c.created_at, c.updated_at FROM ivc_channel as c INNER JOIN ivc_device as d ON c.device_id = d.id WHERE d.deleted_at IS NULL AND c.deleted_at IS NULL AND d.app_id = ? AND c.name LIKE ? ORDER BY c.id LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "AppId为0，无额外filter条件",
            "sql": "SELECT c.id, c.device_id, c.code, c.name, c.state, c.ptz_type, d.device_code, d.device_name, d.status, d.access_protocol, c.created_at, c.updated_at FROM ivc_channel as c INNER JOIN ivc_device as d ON c.device_id = d.id WHERE d.deleted_at IS NULL AND c.deleted_at IS NULL ORDER BY c.id LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "多条件组合示例：AppId不为0，包含device_id、status、name条件",
            "sql": "SELECT c.id, c.device_id, c.code, c.name, c.state, c.ptz_type, d.device_code, d.device_name, d.status, d.access_protocol, c.created_at, c.updated_at FROM ivc_channel as c INNER JOIN ivc_device as d ON c.device_id = d.id WHERE d.deleted_at IS NULL AND c.deleted_at IS NULL AND d.app_id = ? AND d.id = ? AND d.status = ? AND c.name LIKE ? ORDER BY c.id LIMIT ? OFFSET ?;"
          }
        ]
      }
    ],
    "sql_types": [
      "PARAM_DEPENDENT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/types/types.go",
        "code_start_line": 359,
        "code_end_line": 372,
        "code_key": "ChannelSource",
        "code_value": "type ChannelSource struct {\n\tChannelId      string `json:\"ChannelId\" gorm:\"column:id\"`\n\tDeviceID       string `json:\"DeviceId\" gorm:\"column:device_id\"`\n\tChannelCode    string `json:\"ChannelCode\" gorm:\"column:code\"`\n\tName           string `json:\"Name\" gorm:\"column:name\"`\n\tState          int    `json:\"State\" gorm:\"column:state\"`\n\tPTZType        int    `json:\"PTZType\" gorm:\"column:ptz_type\"`\n\tDeviceCode     string `json:\"DeviceCode\" gorm:\"column:device_code\"`\n\tDeviceName     string `json:\"DeviceName\" gorm:\"column:device_name\"`\n\tDeviceStatus   int    `json:\"DeviceStatus\" gorm:\"column:status\"`\n\tAccessProtocol int    `json:\"AccessProtocol\" gorm:\"column:access_protocol\"`\n\tCreatedAt      int    `json:\"CreateAt\" gorm:\"column:created_at\"`\n\tUpdatedAt      int    `json:\"UpdateAt\" gorm:\"column:updated_at\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "c9bb087a681a6287be10c9b6e8e232a6cfc363c7"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-urs.json",
    "matched_keywords": [
      "Scopes"
    ]
  },
  {
    "function_name": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/model/gbinvite.go:40:65:FindGBinviteWhitelists",
    "orm_code": "func (c *GBinvite) FindGBinviteWhitelists(filterSource map[string]interface{}, page, size int) ([]types.GBinviteSource, error) {\n\tbs := make([]types.GBinviteSource, 0)\n\tvar err error\n\tcomment := c.CommentFunc(SELECT_COMMENT)\n\tif name, ok := filterSource[\"name\"]; ok {\n\t\tfilter := make(map[string]interface{})\n\t\tfor k, v := range filterSource {\n\t\t\tif k == \"name\" {\n\t\t\t\tcontinue\n\t\t\t}\n\t\t\tfilter[k] = v\n\t\t}\n\t\terr = base.GetInstance().IvcDriver().Clauses(comment).Table(IvcGBinviteWhitelistTable).Order(\"id\").Scopes(PaginateDB(page, size)).\n\t\t\tWhere(\"name like ?\", \"%\"+name.(string)+\"%\").Find(&bs).Error\n\t} else {\n\t\terr = base.GetInstance().IvcDriver().Clauses(comment).Table(IvcGBinviteWhitelistTable).Order(\"id\").Scopes(PaginateDB(page, size)).\n\t\t\tWhere(filterSource).Find(&bs).Error\n\t}\n\tif err != nil {\n\t\tif err == db.ErrRecordNotFound {\n\t\t\treturn bs, utils.RecordNotFoundError\n\t\t}\n\t\treturn bs, err\n\t}\n\treturn bs, nil\n}",
    "caller": "",
    "sql_statement_list": [
      {
        "type": "param_dependent",
        "variants": [
          {
            "scenario": "filterSource包含name键时进行模糊查询",
            "sql": "SELECT * FROM ivc_gbinvite_whitelist WHERE name LIKE ? ORDER BY id LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "filterSource不包含name键但包含其他条件时进行等值查询",
            "sql": "SELECT * FROM ivc_gbinvite_whitelist WHERE app_id = ? AND uin = ? ORDER BY id LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "filterSource为空时进行无条件查询",
            "sql": "SELECT * FROM ivc_gbinvite_whitelist ORDER BY id LIMIT ? OFFSET ?;"
          }
        ]
      }
    ],
    "sql_types": [
      "PARAM_DEPENDENT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/types/types.go",
        "code_start_line": 669,
        "code_end_line": 675,
        "code_key": "GBinviteSource",
        "code_value": "type GBinviteSource struct {\n\tId       int    `json:\"Id\" gorm:\"column:id\"`\n\tName     string `json:\"Name\" gorm:\"column:name\"`\n\tUin      string `json:\"Uin\" gorm:\"column:uin\"`\n\tAppId    int    `json:\"AppId\" gorm:\"column:app_id\"`\n\tCreateAt int    `json:\"CreateAt\" gorm:\"column:created_at\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "c9bb087a681a6287be10c9b6e8e232a6cfc363c7"
      }
    ],
    "sql_pattern_cnt": 2,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-urs.json",
    "matched_keywords": [
      "Scopes"
    ]
  },
  {
    "function_name": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/model/gbinvite.go:40:65:FindGBinviteWhitelists",
    "orm_code": "func (c *GBinvite) FindGBinviteWhitelists(filterSource map[string]interface{}, page, size int) ([]types.GBinviteSource, error) {\n\tbs := make([]types.GBinviteSource, 0)\n\tvar err error\n\tcomment := c.CommentFunc(SELECT_COMMENT)\n\tif name, ok := filterSource[\"name\"]; ok {\n\t\tfilter := make(map[string]interface{})\n\t\tfor k, v := range filterSource {\n\t\t\tif k == \"name\" {\n\t\t\t\tcontinue\n\t\t\t}\n\t\t\tfilter[k] = v\n\t\t}\n\t\terr = base.GetInstance().IvcDriver().Clauses(comment).Table(IvcGBinviteWhitelistTable).Order(\"id\").Scopes(PaginateDB(page, size)).\n\t\t\tWhere(\"name like ?\", \"%\"+name.(string)+\"%\").Find(&bs).Error\n\t} else {\n\t\terr = base.GetInstance().IvcDriver().Clauses(comment).Table(IvcGBinviteWhitelistTable).Order(\"id\").Scopes(PaginateDB(page, size)).\n\t\t\tWhere(filterSource).Find(&bs).Error\n\t}\n\tif err != nil {\n\t\tif err == db.ErrRecordNotFound {\n\t\t\treturn bs, utils.RecordNotFoundError\n\t\t}\n\t\treturn bs, err\n\t}\n\treturn bs, nil\n}",
    "caller": "func (l *QueryGBinviteWhitelistLogic) QueryGBinviteWhitelist(req *types.QueryGBinviteWhitelistRequest, log *log.IvcLog) (resp *types.QueryGBinviteWhitelistReponse, err error) {\n\tpageReq := req.PaginationRequest\n\tpage, size := model.ReqPagination(&pageReq)\n\tfilter := make(map[string]interface{})\n\tif req.AppId > 0 {\n\t\tfilter[\"app_id\"] = req.AppId\n\t} else if len(req.OwnerUin) > 0 {\n\t\terr := utils.CheckUinStr(req.OwnerUin)\n\t\tif err != nil {\n\t\t\tlog.ErrorV(fmt.Sprintf(\"[QueryGBinviteWhitelist] CheckUinStr Param Invalid:%+v\", *req), utils.InvalidParamErr)\n\t\t\treturn nil, utils.InvalidParamError\n\t\t}\n\t\tfilter[\"uin\"] = req.OwnerUin\n\t} else if len(req.Name) > 0 {\n\t\terr := utils.CheckNameStr(req.Name)\n\t\tif err != nil {\n\t\t\tlog.ErrorV(fmt.Sprintf(\"[QueryGBinviteWhitelist] CheckNameStr Param Invalid:%+v\", *req), utils.InvalidParamErr)\n\t\t\treturn nil, utils.InvalidParamError\n\t\t}\n\t\tfilter[\"name\"] = req.Name\n\t}\n\n\t// 查找符合条件的云录像白名单列表\n\tgbinvite := &model.GBinvite{\n\t\tComment: model.NewComment(req.RequestId, model.QueryGBinviteWhitelistFlow),\n\t}\n\n\ttotal, err := gbinvite.CountGBinviteWhitelists(filter)\n\n\tif err != nil {\n\n\t\tlog.ErrorV(fmt.Sprintf(\"[QueryGBinviteWhitelist] CountGBinviteWhitelists err:%v\", err), utils.OperationErr)\n\t\treturn nil, err\n\t}\n\n\tcs, err := gbinvite.FindGBinviteWhitelists(filter, page, size)\n\tif err != nil {\n\t\terrCode := utils.OperationErr\n\t\tif e, ok := err.(*utils.UrsError); ok {\n\t\t\terrCode = e.Id\n\t\t}\n\t\tlog.ErrorV(fmt.Sprintf(\"[QueryGBinviteWhitelist] FindGBinviteWhitelists err:%v\", err), errCode)\n\t\treturn nil, err\n\t}\n\tgbinviteList := make([]types.GBinviteWhitelist, 0, len(cs))\n\n\tfor i := range cs {\n\t\tgbinviteList = append(gbinviteList, types.GBinviteWhitelist{\n\t\t\tId:       cs[i].Id,\n\t\t\tName:     cs[i].Name,\n\t\t\tUin:      cs[i].Uin,\n\t\t\tAppId:    cs[i].AppId,\n\t\t\tCreateAt: utils.UnixTimestampToString(int64(cs[i].CreateAt)),\n\t\t})\n\t}\n\tresp = &types.QueryGBinviteWhitelistReponse{\n\t\tList:  gbinviteList,\n\t\tTotal: total,\n\t\tPage:  page,\n\t\tSize:  size,\n\t}\n\n\treturn resp, nil\n}",
    "sql_statement_list": [
      {
        "type": "param_dependent",
        "variants": [
          {
            "scenario": "当filterSource包含name字段时，使用LIKE模糊查询",
            "sql": "SELECT * FROM ivc_gbinvite_whitelist WHERE name LIKE ? ORDER BY id LIMIT 10 OFFSET 0;"
          },
          {
            "scenario": "当filterSource不包含name字段时，使用精确匹配查询（如app_id条件）",
            "sql": "SELECT * FROM ivc_gbinvite_whitelist WHERE app_id = ? ORDER BY id LIMIT 10 OFFSET 0;"
          },
          {
            "scenario": "当filterSource不包含name字段时，使用精确匹配查询（如uin条件）",
            "sql": "SELECT * FROM ivc_gbinvite_whitelist WHERE uin = ? ORDER BY id LIMIT 10 OFFSET 0;"
          }
        ]
      }
    ],
    "sql_types": [
      "PARAM_DEPENDENT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/types/types.go",
        "code_start_line": 669,
        "code_end_line": 675,
        "code_key": "GBinviteSource",
        "code_value": "type GBinviteSource struct {\n\tId       int    `json:\"Id\" gorm:\"column:id\"`\n\tName     string `json:\"Name\" gorm:\"column:name\"`\n\tUin      string `json:\"Uin\" gorm:\"column:uin\"`\n\tAppId    int    `json:\"AppId\" gorm:\"column:app_id\"`\n\tCreateAt int    `json:\"CreateAt\" gorm:\"column:created_at\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "c9bb087a681a6287be10c9b6e8e232a6cfc363c7"
      }
    ],
    "sql_pattern_cnt": 2,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-urs.json",
    "matched_keywords": [
      "Scopes"
    ]
  },
  {
    "function_name": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/model/record.go:166:183:FindTemplatesByAppId",
    "orm_code": "func (r *Record) FindTemplatesByAppId(page, size int) ([]types.Template, error) {\n\ttms := make([]types.Template, 0)\n\tvar err error\n\tcomment := r.CommentFunc(SELECT_COMMENT)\n\tif r.AppId == 0 {\n\t\terr = base.GetInstance().IvcDriver().Clauses(comment).Table(RecordTemplateTable).Order(\"template_id\").Scopes(PaginateDB(page, size)).Find(&tms).Error\n\t} else {\n\t\terr = base.GetInstance().IvcDriver().Clauses(comment).Table(RecordTemplateTable).Order(\"template_id\").Scopes(PaginateDB(page, size)).\n\t\t\tWhere(map[string]interface{}{\"app_id\": r.AppId}).Find(&tms).Error\n\t}\n\tif err != nil {\n\t\tif err == db.ErrRecordNotFound {\n\t\t\treturn tms, utils.RecordNotFoundError\n\t\t}\n\t\treturn tms, err\n\t}\n\treturn tms, nil\n}",
    "caller": "",
    "sql_statement_list": [
      {
        "type": "param_dependent",
        "variants": [
          {
            "scenario": "r.AppId == 0 (无WHERE条件)",
            "sql": "SELECT template_id, template_name, describe, create_at, update_at, time_sections FROM RecordTemplateTable ORDER BY template_id LIMIT 10 OFFSET 0;"
          },
          {
            "scenario": "r.AppId != 0 (有WHERE条件)",
            "sql": "SELECT template_id, template_name, describe, create_at, update_at, time_sections FROM RecordTemplateTable WHERE app_id = ? ORDER BY template_id LIMIT 10 OFFSET 0;"
          }
        ]
      }
    ],
    "sql_types": [
      "PARAM_DEPENDENT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/types/types.go",
        "code_start_line": 1213,
        "code_end_line": 1220,
        "code_key": "Template",
        "code_value": "type Template struct {\n\tTemplateId   string `json:\"TemplateId\" gorm:\"column:template_id\"`\n\tTemplateName string `json:\"TemplateName\" gorm:\"column:template_name\"`\n\tDescribe     string `json:\"Describe\" gorm:\"column:describe\"`\n\tCreateAt     string `json:\"CreateAt\" gorm:\"column:create_at\"`\n\tUpdateAt     string `json:\"UpdateAt\" gorm:\"column:update_at\"`\n\tTimeSections string `json:\"TimeSections\" gorm:\"column:time_sections\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "c9bb087a681a6287be10c9b6e8e232a6cfc363c7"
      }
    ],
    "sql_pattern_cnt": 2,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-urs.json",
    "matched_keywords": [
      "Scopes"
    ]
  },
  {
    "function_name": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/model/record.go:166:183:FindTemplatesByAppId",
    "orm_code": "func (r *Record) FindTemplatesByAppId(page, size int) ([]types.Template, error) {\n\ttms := make([]types.Template, 0)\n\tvar err error\n\tcomment := r.CommentFunc(SELECT_COMMENT)\n\tif r.AppId == 0 {\n\t\terr = base.GetInstance().IvcDriver().Clauses(comment).Table(RecordTemplateTable).Order(\"template_id\").Scopes(PaginateDB(page, size)).Find(&tms).Error\n\t} else {\n\t\terr = base.GetInstance().IvcDriver().Clauses(comment).Table(RecordTemplateTable).Order(\"template_id\").Scopes(PaginateDB(page, size)).\n\t\t\tWhere(map[string]interface{}{\"app_id\": r.AppId}).Find(&tms).Error\n\t}\n\tif err != nil {\n\t\tif err == db.ErrRecordNotFound {\n\t\t\treturn tms, utils.RecordNotFoundError\n\t\t}\n\t\treturn tms, err\n\t}\n\treturn tms, nil\n}",
    "caller": "func (l *QueryTemplatesLogic) QueryTemplates(req *types.PaginationRequest, log *logger.IvcLog) (resp *types.TemplatesResponse, err error) {\n\t// 获取appId\n\tcomment := model.NewComment(req.RequestId, model.QueryTemplatesFlow)\n\tappId, err := getAppId(req, log, comment)\n\tif err != nil {\n\t\tlog.ErrorV(fmt.Sprintf(\"[QueryTemplates] getAppId req:%+v err:%v\", *req, err))\n\t\treturn nil, err\n\t}\n\n\trecord := &model.Record{\n\t\tAppId:   appId,\n\t\tComment: comment,\n\t}\n\t// 获取计划总数\n\ttotal, err := record.FindTotalTemplateByAppId()\n\tif err != nil {\n\t\tlog.ErrorV(fmt.Sprintf(\"[QueryTemplates] FindTotalTemplateByAppId req:%+v err:%v\", *req, err))\n\t\treturn nil, err\n\t}\n\t// 获取计划列表\n\tpage, size := model.ReqPagination(req)\n\ttms, err := record.FindTemplatesByAppId(page, size)\n\tif err != nil {\n\t\terrCode := utils.OperationErr\n\t\tif e, ok := err.(*utils.UrsError); ok {\n\t\t\terrCode = e.Id\n\t\t}\n\t\tlog.ErrorV(fmt.Sprintf(\"[QueryTemplates] FindTemplatesByAppId req:%+v err:%v\", *req, err), errCode)\n\t\treturn nil, err\n\t}\n\tresp = &types.TemplatesResponse{\n\t\tTemplates: tms,\n\t\tTotal:     total,\n\t\tPage:      page,\n\t\tSize:      size,\n\t}\n\n\treturn resp, nil\n}",
    "sql_statement_list": [
      "SELECT template_id, template_name, describe, create_at, update_at, time_sections FROM record_template WHERE app_id = ? ORDER BY template_id LIMIT ? OFFSET ?;"
    ],
    "sql_types": [
      "SELECT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/types/types.go",
        "code_start_line": 1213,
        "code_end_line": 1220,
        "code_key": "Template",
        "code_value": "type Template struct {\n\tTemplateId   string `json:\"TemplateId\" gorm:\"column:template_id\"`\n\tTemplateName string `json:\"TemplateName\" gorm:\"column:template_name\"`\n\tDescribe     string `json:\"Describe\" gorm:\"column:describe\"`\n\tCreateAt     string `json:\"CreateAt\" gorm:\"column:create_at\"`\n\tUpdateAt     string `json:\"UpdateAt\" gorm:\"column:update_at\"`\n\tTimeSections string `json:\"TimeSections\" gorm:\"column:time_sections\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "c9bb087a681a6287be10c9b6e8e232a6cfc363c7"
      }
    ],
    "sql_pattern_cnt": 2,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-urs.json",
    "matched_keywords": [
      "Scopes"
    ]
  },
  {
    "function_name": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/model/record.go:185:202:FindPlansByAppId",
    "orm_code": "func (r *Record) FindPlansByAppId(page, size int) ([]types.Plan, error) {\n\tpns := make([]types.Plan, 0)\n\tvar err error\n\tcomment := r.CommentFunc(SELECT_COMMENT)\n\tif r.AppId == 0 {\n\t\terr = base.GetInstance().IvcDriver().Clauses(comment).Table(RecordPlanTable).Order(\"plan_id\").Scopes(PaginateDB(page, size)).Find(&pns).Error\n\t} else {\n\t\terr = base.GetInstance().IvcDriver().Clauses(comment).Table(RecordPlanTable).Order(\"plan_id\").Scopes(PaginateDB(page, size)).\n\t\t\tWhere(map[string]interface{}{\"app_id\": r.AppId}).Find(&pns).Error\n\t}\n\tif err != nil {\n\t\tif err == db.ErrRecordNotFound {\n\t\t\treturn pns, utils.RecordNotFoundError\n\t\t}\n\t\treturn pns, err\n\t}\n\treturn pns, nil\n}",
    "caller": "",
    "sql_statement_list": [
      {
        "type": "param_dependent",
        "variants": [
          {
            "scenario": "AppId为0时查询所有记录",
            "sql": "SELECT plan_id, plan_name, status, stream_type, transition, expiration, describe, create_at, update_at FROM RecordPlanTable ORDER BY plan_id LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "AppId不为0时按app_id过滤查询",
            "sql": "SELECT plan_id, plan_name, status, stream_type, transition, expiration, describe, create_at, update_at FROM RecordPlanTable WHERE app_id = ? ORDER BY plan_id LIMIT ? OFFSET ?;"
          }
        ]
      }
    ],
    "sql_types": [
      "PARAM_DEPENDENT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/types/types.go",
        "code_start_line": 858,
        "code_end_line": 869,
        "code_key": "Plan",
        "code_value": "type Plan struct {\n\tPlanId      string `json:\"PlanId\" gorm:\"column:plan_id\"`\n\tPlanName    string `json:\"PlanName\" gorm:\"column:plan_name\"`\n\tStatus      int    `json:\"Status\" gorm:\"column:status\"`\n\tStreamType  string `json:\"StreamType\" gorm:\"column:stream_type\"`\n\tChannelNums int    `json:\"ChannelNums\" gorm:\"-\"`\n\tTransition  int    `json:\"Transition\" gorm:\"column:transition\"`\n\tExpiration  int    `json:\"Expiration\" gorm:\"column:expiration\"`\n\tDescribe    string `json:\"Describe\" gorm:\"column:describe\"`\n\tCreateAt    string `json:\"CreateAt\" gorm:\"column:create_at\"`\n\tUpdateAt    string `json:\"UpdateAt\" gorm:\"column:update_at\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "c9bb087a681a6287be10c9b6e8e232a6cfc363c7"
      }
    ],
    "sql_pattern_cnt": 2,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-urs.json",
    "matched_keywords": [
      "Scopes"
    ]
  },
  {
    "function_name": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/model/record.go:185:202:FindPlansByAppId",
    "orm_code": "func (r *Record) FindPlansByAppId(page, size int) ([]types.Plan, error) {\n\tpns := make([]types.Plan, 0)\n\tvar err error\n\tcomment := r.CommentFunc(SELECT_COMMENT)\n\tif r.AppId == 0 {\n\t\terr = base.GetInstance().IvcDriver().Clauses(comment).Table(RecordPlanTable).Order(\"plan_id\").Scopes(PaginateDB(page, size)).Find(&pns).Error\n\t} else {\n\t\terr = base.GetInstance().IvcDriver().Clauses(comment).Table(RecordPlanTable).Order(\"plan_id\").Scopes(PaginateDB(page, size)).\n\t\t\tWhere(map[string]interface{}{\"app_id\": r.AppId}).Find(&pns).Error\n\t}\n\tif err != nil {\n\t\tif err == db.ErrRecordNotFound {\n\t\t\treturn pns, utils.RecordNotFoundError\n\t\t}\n\t\treturn pns, err\n\t}\n\treturn pns, nil\n}",
    "caller": "func (l *QueryPlansLogic) QueryPlans(req *types.PaginationRequest, log *logger.IvcLog) (resp *types.PlansResponse, err error) {\n\t// 获取appId\n\tcomment := model.NewComment(req.RequestId, model.QueryPlansFlow)\n\tappId, err := getAppId(req, log, comment)\n\tif err != nil {\n\t\tlog.ErrorV(fmt.Sprintf(\"[QueryPlans] getAppId req:%+v err:%v\", *req, err))\n\t\treturn nil, err\n\t}\n\n\trecord := &model.Record{\n\t\tAppId:   appId,\n\t\tComment: comment,\n\t}\n\t// 获取计划总数\n\ttotal, err := record.FindTotalPlanByAppId()\n\tif err != nil {\n\t\tlog.ErrorV(fmt.Sprintf(\"[QueryPlans] FindTotalPlanByAppId req:%+v err:%v\", *req, err))\n\t\treturn nil, err\n\t}\n\t// 获取计划列表\n\tpage, size := model.ReqPagination(req)\n\tpns, err := record.FindPlansByAppId(page, size)\n\tif err != nil {\n\t\terrCode := utils.OperationErr\n\t\tif e, ok := err.(*utils.UrsError); ok {\n\t\t\terrCode = e.Id\n\t\t}\n\t\tlog.ErrorV(fmt.Sprintf(\"[QueryPlans] FindPlansByAppId req:%+v err:%v\", *req, err), errCode)\n\t\treturn nil, err\n\t}\n\t// 获取各计划下的通道数\n\tpcs, err := record.FindPlanChannelsByAppId()\n\tif err != nil {\n\t\tlog.ErrorV(fmt.Sprintf(\"[QueryPlans] FindPlanChannelsByAppId req:%+v err:%v\", *req, err))\n\t\treturn nil, err\n\t}\n\tplans := MatchPlan(pcs, pns)\n\tresp = &types.PlansResponse{\n\t\tPlans: plans,\n\t\tTotal: total,\n\t\tPage:  page,\n\t\tSize:  size,\n\t}\n\n\treturn resp, nil\n}",
    "sql_statement_list": [
      "SELECT * FROM RecordPlanTable WHERE app_id = ? ORDER BY plan_id LIMIT ? OFFSET ?;"
    ],
    "sql_types": [
      "SELECT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/types/types.go",
        "code_start_line": 858,
        "code_end_line": 869,
        "code_key": "Plan",
        "code_value": "type Plan struct {\n\tPlanId      string `json:\"PlanId\" gorm:\"column:plan_id\"`\n\tPlanName    string `json:\"PlanName\" gorm:\"column:plan_name\"`\n\tStatus      int    `json:\"Status\" gorm:\"column:status\"`\n\tStreamType  string `json:\"StreamType\" gorm:\"column:stream_type\"`\n\tChannelNums int    `json:\"ChannelNums\" gorm:\"-\"`\n\tTransition  int    `json:\"Transition\" gorm:\"column:transition\"`\n\tExpiration  int    `json:\"Expiration\" gorm:\"column:expiration\"`\n\tDescribe    string `json:\"Describe\" gorm:\"column:describe\"`\n\tCreateAt    string `json:\"CreateAt\" gorm:\"column:create_at\"`\n\tUpdateAt    string `json:\"UpdateAt\" gorm:\"column:update_at\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "c9bb087a681a6287be10c9b6e8e232a6cfc363c7"
      }
    ],
    "sql_pattern_cnt": 2,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-urs.json",
    "matched_keywords": [
      "Scopes"
    ]
  },
  {
    "function_name": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/model/record.go:204:221:FindTasksByAppId",
    "orm_code": "func (r *Record) FindTasksByAppId(page, size int) ([]types.Task, error) {\n\ttks := make([]types.Task, 0)\n\tvar err error\n\tcomment := r.CommentFunc(SELECT_COMMENT)\n\tif r.AppId == 0 {\n\t\terr = base.GetInstance().IvcDriver().Clauses(comment).Table(RecordTaskTable).Order(\"task_id\").Scopes(PaginateDB(page, size)).Find(&tks).Error\n\t} else {\n\t\terr = base.GetInstance().IvcDriver().Clauses(comment).Table(RecordTaskTable).Order(\"task_id\").Scopes(PaginateDB(page, size)).\n\t\t\tWhere(map[string]interface{}{\"app_id\": r.AppId}).Find(&tks).Error\n\t}\n\tif err != nil {\n\t\tif err == db.ErrRecordNotFound {\n\t\t\treturn tks, utils.RecordNotFoundError\n\t\t}\n\t\treturn tks, err\n\t}\n\treturn tks, nil\n}",
    "caller": "",
    "sql_statement_list": [
      {
        "type": "param_dependent",
        "variants": [
          {
            "scenario": "当AppId为0时，查询所有记录",
            "sql": "SELECT task_id, task_name, status, mod, start_time, end_time, expiration, capacity, describe, create_at, update_at FROM record_task ORDER BY task_id LIMIT 10 OFFSET 0;"
          },
          {
            "scenario": "当AppId不为0时，按AppId过滤查询",
            "sql": "SELECT task_id, task_name, status, mod, start_time, end_time, expiration, capacity, describe, create_at, update_at FROM record_task WHERE app_id = ? ORDER BY task_id LIMIT 10 OFFSET 0;"
          }
        ]
      }
    ],
    "sql_types": [
      "PARAM_DEPENDENT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/types/types.go",
        "code_start_line": 1191,
        "code_end_line": 1204,
        "code_key": "Task",
        "code_value": "type Task struct {\n\tTaskId      string `json:\"TaskId\" gorm:\"column:task_id\"`\n\tTaskName    string `json:\"TaskName\" gorm:\"column:task_name\"`\n\tStatus      int    `json:\"Status\" gorm:\"column:status\"`\n\tMod         int    `json:\"Mod\" gorm:\"column:mod\"`\n\tStartTime   int    `json:\"StartTime\" gorm:\"column:start_time\"`\n\tEndTime     int    `json:\"EndTime\" gorm:\"column:end_time\"`\n\tExpiration  int    `json:\"Expiration\" gorm:\"column:expiration\"`\n\tChannelNums int    `json:\"ChannelNums\" gorm:\"-\"`\n\tCapacity    int    `json:\"Capacity\" gorm:\"column:capacity\"`\n\tDescribe    string `json:\"Describe\" gorm:\"column:describe\"`\n\tCreateAt    string `json:\"CreateAt\" gorm:\"column:create_at\"`\n\tUpdateAt    string `json:\"UpdateAt\" gorm:\"column:update_at\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "c9bb087a681a6287be10c9b6e8e232a6cfc363c7"
      }
    ],
    "sql_pattern_cnt": 2,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-urs.json",
    "matched_keywords": [
      "Scopes"
    ]
  },
  {
    "function_name": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/model/record.go:204:221:FindTasksByAppId",
    "orm_code": "func (r *Record) FindTasksByAppId(page, size int) ([]types.Task, error) {\n\ttks := make([]types.Task, 0)\n\tvar err error\n\tcomment := r.CommentFunc(SELECT_COMMENT)\n\tif r.AppId == 0 {\n\t\terr = base.GetInstance().IvcDriver().Clauses(comment).Table(RecordTaskTable).Order(\"task_id\").Scopes(PaginateDB(page, size)).Find(&tks).Error\n\t} else {\n\t\terr = base.GetInstance().IvcDriver().Clauses(comment).Table(RecordTaskTable).Order(\"task_id\").Scopes(PaginateDB(page, size)).\n\t\t\tWhere(map[string]interface{}{\"app_id\": r.AppId}).Find(&tks).Error\n\t}\n\tif err != nil {\n\t\tif err == db.ErrRecordNotFound {\n\t\t\treturn tks, utils.RecordNotFoundError\n\t\t}\n\t\treturn tks, err\n\t}\n\treturn tks, nil\n}",
    "caller": "func (l *QueryTasksLogic) QueryTasks(req *types.PaginationRequest, log *logger.IvcLog) (resp *types.TasksResponse, err error) {\n\t// 获取appId\n\tcomment := model.NewComment(req.RequestId, model.QueryTasksFlow)\n\tappId, err := getAppId(req, log, comment)\n\tif err != nil {\n\t\tlog.ErrorV(fmt.Sprintf(\"[QueryTasks] getAppId req:%+v err:%v\", *req, err))\n\t\treturn nil, err\n\t}\n\n\trecord := &model.Record{\n\t\tAppId:   appId,\n\t\tComment: comment,\n\t}\n\t// 获取计划总数\n\ttotal, err := record.FindTotalTaskByAppId()\n\tif err != nil {\n\t\tlog.ErrorV(fmt.Sprintf(\"[QueryTasks] FindTotalTaskByAppId req:%+v err:%v\", *req, err))\n\t\treturn nil, err\n\t}\n\t// 获取计划列表\n\tpage, size := model.ReqPagination(req)\n\ttks, err := record.FindTasksByAppId(page, size)\n\tif err != nil {\n\t\terrCode := utils.OperationErr\n\t\tif e, ok := err.(*utils.UrsError); ok {\n\t\t\terrCode = e.Id\n\t\t}\n\t\tlog.ErrorV(fmt.Sprintf(\"[QueryTasks] FindTasksByAppId req:%+v err:%v\", *req, err), errCode)\n\t\treturn nil, err\n\t}\n\t// 获取各计划下的通道数\n\ttcs, err := record.FindTaskChannelsByAppId()\n\tif err != nil {\n\t\tlog.ErrorV(fmt.Sprintf(\"[QueryTasks] FindTaskChannelsByAppId req:%+v err:%v\", *req, err))\n\t\treturn nil, err\n\t}\n\ttasks := MatchTask(tcs, tks)\n\tresp = &types.TasksResponse{\n\t\tTasks: tasks,\n\t\tTotal: total,\n\t\tPage:  page,\n\t\tSize:  size,\n\t}\n\n\treturn resp, nil\n}",
    "sql_statement_list": [
      {
        "type": "param_dependent",
        "variants": [
          {
            "scenario": "当AppId为0时，查询所有任务",
            "sql": "SELECT task_id, task_name, status, mod, start_time, end_time, expiration, capacity, describe, create_at, update_at FROM record_task_table ORDER BY task_id LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "当AppId不为0时，查询指定应用的任务",
            "sql": "SELECT task_id, task_name, status, mod, start_time, end_time, expiration, capacity, describe, create_at, update_at FROM record_task_table WHERE app_id = ? ORDER BY task_id LIMIT ? OFFSET ?;"
          }
        ]
      }
    ],
    "sql_types": [
      "PARAM_DEPENDENT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/types/types.go",
        "code_start_line": 1191,
        "code_end_line": 1204,
        "code_key": "Task",
        "code_value": "type Task struct {\n\tTaskId      string `json:\"TaskId\" gorm:\"column:task_id\"`\n\tTaskName    string `json:\"TaskName\" gorm:\"column:task_name\"`\n\tStatus      int    `json:\"Status\" gorm:\"column:status\"`\n\tMod         int    `json:\"Mod\" gorm:\"column:mod\"`\n\tStartTime   int    `json:\"StartTime\" gorm:\"column:start_time\"`\n\tEndTime     int    `json:\"EndTime\" gorm:\"column:end_time\"`\n\tExpiration  int    `json:\"Expiration\" gorm:\"column:expiration\"`\n\tChannelNums int    `json:\"ChannelNums\" gorm:\"-\"`\n\tCapacity    int    `json:\"Capacity\" gorm:\"column:capacity\"`\n\tDescribe    string `json:\"Describe\" gorm:\"column:describe\"`\n\tCreateAt    string `json:\"CreateAt\" gorm:\"column:create_at\"`\n\tUpdateAt    string `json:\"UpdateAt\" gorm:\"column:update_at\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "c9bb087a681a6287be10c9b6e8e232a6cfc363c7"
      }
    ],
    "sql_pattern_cnt": 2,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-urs.json",
    "matched_keywords": [
      "Scopes"
    ]
  },
  {
    "function_name": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/model/blockeruser.go:33:51:FindBlockerUsers",
    "orm_code": "func (b *Blockeruser) FindBlockerUsers(filterSource map[string]interface{}, page, size int) ([]types.BlockerUserSource, error) {\n\tvar ret []types.BlockerUserSource\n\tvar err error\n\tcomment := b.CommentFunc(SELECT_COMMENT)\n\tif name, ok := filterSource[\"name\"]; ok {\n\t\terr = base.GetInstance().IvcDriver().Clauses(comment).Table(IvcBlockUserTable).Order(\"id\").Scopes(PaginateDB(page, size)).\n\t\t\tWhere(\"name like ?\", \"%\"+name.(string)+\"%\").Find(&ret).Error\n\t} else if appId, ok := filterSource[\"app_id\"]; ok {\n\t\terr = base.GetInstance().IvcDriver().Clauses(comment).Table(IvcBlockUserTable).Order(\"id\").Scopes(PaginateDB(page, size)).\n\t\t\tWhere(\"app_id = ?\", appId).Find(&ret).Error\n\t} else if uin, ok := filterSource[\"uin\"]; ok {\n\t\terr = base.GetInstance().IvcDriver().Clauses(comment).Table(IvcBlockUserTable).Order(\"id\").Scopes(PaginateDB(page, size)).\n\t\t\tWhere(\"uin = ?\", uin).Find(&ret).Error\n\t} else {\n\t\terr = base.GetInstance().IvcDriver().Clauses(comment).Table(IvcBlockUserTable).Order(\"id\").Scopes(PaginateDB(page, size)).\n\t\t\tFind(&ret).Error\n\t}\n\treturn ret, err\n}",
    "caller": "",
    "sql_statement_list": [
      {
        "type": "param_dependent",
        "variants": [
          {
            "scenario": "按name字段模糊查询",
            "sql": "SELECT * FROM IvcBlockUserTable WHERE name LIKE ? ORDER BY id LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "按app_id字段精确查询",
            "sql": "SELECT * FROM IvcBlockUserTable WHERE app_id = ? ORDER BY id LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "按uin字段精确查询",
            "sql": "SELECT * FROM IvcBlockUserTable WHERE uin = ? ORDER BY id LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "无过滤条件查询全部",
            "sql": "SELECT * FROM IvcBlockUserTable ORDER BY id LIMIT ? OFFSET ?;"
          }
        ]
      }
    ],
    "sql_types": [
      "PARAM_DEPENDENT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/types/types.go",
        "code_start_line": 253,
        "code_end_line": 260,
        "code_key": "BlockerUserSource",
        "code_value": "type BlockerUserSource struct {\n\tId       int    `json:\"Id\" gorm:\"column:id\"`\n\tAppId    int    `json:\"AppId\" gorm:\"column:app_id\"`\n\tUin      string `json:\"Uin\" gorm:\"column:uin\"`\n\tName     string `json:\"Name\" gorm:\"column:name\"`\n\tDescribe string `json:\"Describe\" gorm:\"describe\"`\n\tCreateAt int    `json:\"CreateAt\" gorm:\"column:created_at\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "c9bb087a681a6287be10c9b6e8e232a6cfc363c7"
      }
    ],
    "sql_pattern_cnt": 4,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-urs.json",
    "matched_keywords": [
      "Scopes"
    ]
  },
  {
    "function_name": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/model/blockeruser.go:33:51:FindBlockerUsers",
    "orm_code": "func (b *Blockeruser) FindBlockerUsers(filterSource map[string]interface{}, page, size int) ([]types.BlockerUserSource, error) {\n\tvar ret []types.BlockerUserSource\n\tvar err error\n\tcomment := b.CommentFunc(SELECT_COMMENT)\n\tif name, ok := filterSource[\"name\"]; ok {\n\t\terr = base.GetInstance().IvcDriver().Clauses(comment).Table(IvcBlockUserTable).Order(\"id\").Scopes(PaginateDB(page, size)).\n\t\t\tWhere(\"name like ?\", \"%\"+name.(string)+\"%\").Find(&ret).Error\n\t} else if appId, ok := filterSource[\"app_id\"]; ok {\n\t\terr = base.GetInstance().IvcDriver().Clauses(comment).Table(IvcBlockUserTable).Order(\"id\").Scopes(PaginateDB(page, size)).\n\t\t\tWhere(\"app_id = ?\", appId).Find(&ret).Error\n\t} else if uin, ok := filterSource[\"uin\"]; ok {\n\t\terr = base.GetInstance().IvcDriver().Clauses(comment).Table(IvcBlockUserTable).Order(\"id\").Scopes(PaginateDB(page, size)).\n\t\t\tWhere(\"uin = ?\", uin).Find(&ret).Error\n\t} else {\n\t\terr = base.GetInstance().IvcDriver().Clauses(comment).Table(IvcBlockUserTable).Order(\"id\").Scopes(PaginateDB(page, size)).\n\t\t\tFind(&ret).Error\n\t}\n\treturn ret, err\n}",
    "caller": "func (l *QueryBlockerUserLogic) QueryBlockerUser(req *types.QueryBlockerUserRequest, log *logger.IvcLog) (resp *types.QueryBlockerUserReponse, err error) {\n\t// todo: add your logic here and delete this line\n\tpageReq := req.PaginationRequest\n\tpage, size := model.ReqPagination(&pageReq)\n\tfilter := make(map[string]interface{})\n\tif req.AppId > 0 {\n\t\tfilter[\"app_id\"] = req.AppId\n\t} else if len(req.OwnerUin) > 0 {\n\t\terr := utils.CheckUinStr(req.OwnerUin)\n\t\tif err != nil {\n\t\t\tlog.ErrorV(fmt.Sprintf(\"[QueryDailyReportWhitelist] CheckUinStr Param Invalid:%+v\", *req), utils.InvalidParamErr)\n\t\t\treturn nil, utils.InvalidParamError\n\t\t}\n\t\tfilter[\"uin\"] = req.OwnerUin\n\t} else if len(req.Name) > 0 {\n\t\terr := utils.CheckNameStr(req.Name)\n\t\tif err != nil {\n\t\t\tlog.ErrorV(fmt.Sprintf(\"[QueryDailyReportWhitelist] CheckNameStr Param Invalid:%+v\", *req), utils.InvalidParamErr)\n\t\t\treturn nil, utils.InvalidParamError\n\t\t}\n\t\tfilter[\"name\"] = req.Name\n\t}\n\n\t// 查找符合条件的云录像白名单列表\n\tblocker := &model.Blockeruser{\n\t\tComment: model.NewComment(req.RequestId, model.QueryBlockerUserFlow),\n\t}\n\n\ttotal, err := blocker.CountBlockerUsers(filter)\n\n\tif err != nil {\n\t\tlog.ErrorV(fmt.Sprintf(\"[QueryDailyReportWhitelist] CountBlockerUsers Param Invalid:%+v err:%v\", *req, err), utils.InvalidParamErr)\n\t\treturn nil, utils.RecordNotFoundError\n\t}\n\n\tbs, err := blocker.FindBlockerUsers(filter, page, size)\n\tif err != nil {\n\t\tlog.ErrorV(fmt.Sprintf(\"[QueryDailyReportWhitelist] FindBlockerUsers Param Invalid:%+v err:%v\", *req, err), utils.InvalidParamErr)\n\t\treturn nil, utils.RecordNotFoundError\n\t}\n\n\tlist := make([]types.BlockerUser, 0, len(bs))\n\tfor i := range bs {\n\t\tlist = append(list, types.BlockerUser{\n\t\t\tId:       bs[i].Id,\n\t\t\tName:     bs[i].Name,\n\t\t\tUin:      bs[i].Uin,\n\t\t\tAppId:    bs[i].AppId,\n\t\t\tDescribe: bs[i].Describe,\n\t\t\tCreateAt: utils.UnixTimestampToString(int64(bs[i].CreateAt)),\n\t\t})\n\t}\n\n\treturn &types.QueryBlockerUserReponse{\n\t\tTotal: total,\n\t\tPage:  page,\n\t\tSize:  size,\n\t\tList:  list,\n\t}, nil\n}",
    "sql_statement_list": [
      {
        "type": "param_dependent",
        "variants": [
          {
            "scenario": "按name模糊匹配过滤",
            "sql": "SELECT * FROM IvcBlockUserTable WHERE name LIKE ? ORDER BY id LIMIT ?;"
          },
          {
            "scenario": "按app_id精确匹配过滤",
            "sql": "SELECT * FROM IvcBlockUserTable WHERE app_id = ? ORDER BY id LIMIT ?;"
          },
          {
            "scenario": "按uin精确匹配过滤",
            "sql": "SELECT * FROM IvcBlockUserTable WHERE uin = ? ORDER BY id LIMIT ?;"
          },
          {
            "scenario": "无过滤条件查询全部",
            "sql": "SELECT * FROM IvcBlockUserTable ORDER BY id LIMIT ?;"
          }
        ]
      }
    ],
    "sql_types": [
      "PARAM_DEPENDENT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/types/types.go",
        "code_start_line": 253,
        "code_end_line": 260,
        "code_key": "BlockerUserSource",
        "code_value": "type BlockerUserSource struct {\n\tId       int    `json:\"Id\" gorm:\"column:id\"`\n\tAppId    int    `json:\"AppId\" gorm:\"column:app_id\"`\n\tUin      string `json:\"Uin\" gorm:\"column:uin\"`\n\tName     string `json:\"Name\" gorm:\"column:name\"`\n\tDescribe string `json:\"Describe\" gorm:\"describe\"`\n\tCreateAt int    `json:\"CreateAt\" gorm:\"column:created_at\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "c9bb087a681a6287be10c9b6e8e232a6cfc363c7"
      }
    ],
    "sql_pattern_cnt": 4,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-urs.json",
    "matched_keywords": [
      "Scopes"
    ]
  },
  {
    "function_name": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/model/overview.go:416:454:FindUserListByFilter",
    "orm_code": "func (o *Overview) FindUserListByFilter(page, size int) ([]types.UserOverview, error) {\n\tusers := make([]types.UserOverview, 0)\n\tfilter := make(map[string]interface{})\n\tif o.IndustryId > 0 {\n\t\tfilter[\"income_industry_id\"] = o.IndustryId\n\t}\n\tif o.AppId > 0 {\n\t\tfilter[\"app_id\"] = o.AppId\n\t}\n\tfilter[\"status\"] = 0\n\tif o.CustomerType > 0 {\n\t\tswitch o.CustomerType {\n\t\tcase External:\n\t\t\tfilter[\"internal\"] = 0\n\t\tcase Internal:\n\t\t\tfilter[\"internal\"] = 1\n\t\tcase Big:\n\t\t\tfilter[\"big_customer\"] = 1\n\t\tcase Small:\n\t\t\tfilter[\"big_customer\"] = 0\n\t\tcase Corporate:\n\t\t\tfilter[\"corporate\"] = 1\n\t\tcase Personal:\n\t\t\tfilter[\"corporate\"] = 0\n\t\tdefault:\n\t\t\treturn nil, utils.UnSupportedCustomerTypeError\n\t\t}\n\t}\n\tcomment := o.CommentFunc(SELECT_COMMENT)\n\terr := base.GetInstance().BillingDriver().Clauses(comment).Table(UserInfoTable).Select(\"name,app_id,uin,income_industry_id,income_industry_name,internal\").\n\t\tOrder(\"uin\").Scopes(PaginateDB(page, size)).Where(filter).Scan(&users).Error\n\tif err != nil {\n\t\tif err == db.ErrRecordNotFound {\n\t\t\treturn users, utils.RecordNotFoundError\n\t\t}\n\t\treturn users, err\n\t}\n\treturn users, nil\n}",
    "caller": "",
    "sql_statement_list": [
      {
        "type": "param_dependent",
        "variants": [
          {
            "scenario": "最小条件（只有固定status条件）",
            "sql": "SELECT name,app_id,uin,income_industry_id,income_industry_name,internal FROM UserInfoTable WHERE status = 0 ORDER BY uin LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "包含IndustryId条件",
            "sql": "SELECT name,app_id,uin,income_industry_id,income_industry_name,internal FROM UserInfoTable WHERE income_industry_id = ? AND status = 0 ORDER BY uin LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "包含AppId条件",
            "sql": "SELECT name,app_id,uin,income_industry_id,income_industry_name,internal FROM UserInfoTable WHERE app_id = ? AND status = 0 ORDER BY uin LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "包含External客户类型",
            "sql": "SELECT name,app_id,uin,income_industry_id,income_industry_name,internal FROM UserInfoTable WHERE internal = 0 AND status = 0 ORDER BY uin LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "包含Internal客户类型",
            "sql": "SELECT name,app_id,uin,income_industry_id,income_industry_name,internal FROM UserInfoTable WHERE internal = 1 AND status = 0 ORDER BY uin LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "包含Big客户类型",
            "sql": "SELECT name,app_id,uin,income_industry_id,income_industry_name,internal FROM UserInfoTable WHERE big_customer = 1 AND status = 0 ORDER BY uin LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "包含Small客户类型",
            "sql": "SELECT name,app_id,uin,income_industry_id,income_industry_name,internal FROM UserInfoTable WHERE big_customer = 0 AND status = 0 ORDER BY uin LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "包含Corporate客户类型",
            "sql": "SELECT name,app_id,uin,income_industry_id,income_industry_name,internal FROM UserInfoTable WHERE corporate = 1 AND status = 0 ORDER BY uin LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "包含Personal客户类型",
            "sql": "SELECT name,app_id,uin,income_industry_id,income_industry_name,internal FROM UserInfoTable WHERE corporate = 0 AND status = 0 ORDER BY uin LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "IndustryId + AppId组合",
            "sql": "SELECT name,app_id,uin,income_industry_id,income_industry_name,internal FROM UserInfoTable WHERE app_id = ? AND income_industry_id = ? AND status = 0 ORDER BY uin LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "IndustryId + CustomerType组合",
            "sql": "SELECT name,app_id,uin,income_industry_id,income_industry_name,internal FROM UserInfoTable WHERE income_industry_id = ? AND internal = ? AND status = 0 ORDER BY uin LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "AppId + CustomerType组合",
            "sql": "SELECT name,app_id,uin,income_industry_id,income_industry_name,internal FROM UserInfoTable WHERE app_id = ? AND internal = ? AND status = 0 ORDER BY uin LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "IndustryId + AppId + CustomerType全组合",
            "sql": "SELECT name,app_id,uin,income_industry_id,income_industry_name,internal FROM UserInfoTable WHERE app_id = ? AND income_industry_id = ? AND internal = ? AND status = 0 ORDER BY uin LIMIT ? OFFSET ?;"
          }
        ]
      }
    ],
    "sql_types": [
      "PARAM_DEPENDENT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/types/types.go",
        "code_start_line": 1297,
        "code_end_line": 1308,
        "code_key": "UserOverview",
        "code_value": "type UserOverview struct {\n\tUin              string `json:\"Uin\" gorm:\"column:uin\"`\n\tAppId            int    `json:\"AppId\" gorm:\"column:app_id\"`\n\tName             string `json:\"Name\" gorm:\"column:name\"`\n\tIndustryId       int    `json:\"IndustryId\" gorm:\"column:income_industry_id\"`\n\tIndustryName     string `json:\"IndustryName\" gorm:\"column:income_industry_name\"`\n\tInternal         int    `json:\"Internal\" gorm:\"column:internal\"`\n\tConsume          string `json:\"Consume\" gorm:\"column:consume\"`\n\tActualReceipt    string `json:\"ActualReceipt\" gorm:\"-\"`\n\tPrepaidDeduction string `json:\"PrepaidDeduction\" gorm:\"-\"`\n\tPostpaid         string `json:\"Postpaid\" gorm:\"-\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "c9bb087a681a6287be10c9b6e8e232a6cfc363c7"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-urs.json",
    "matched_keywords": [
      "Scopes"
    ]
  },
  {
    "function_name": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/model/overview.go:416:454:FindUserListByFilter",
    "orm_code": "func (o *Overview) FindUserListByFilter(page, size int) ([]types.UserOverview, error) {\n\tusers := make([]types.UserOverview, 0)\n\tfilter := make(map[string]interface{})\n\tif o.IndustryId > 0 {\n\t\tfilter[\"income_industry_id\"] = o.IndustryId\n\t}\n\tif o.AppId > 0 {\n\t\tfilter[\"app_id\"] = o.AppId\n\t}\n\tfilter[\"status\"] = 0\n\tif o.CustomerType > 0 {\n\t\tswitch o.CustomerType {\n\t\tcase External:\n\t\t\tfilter[\"internal\"] = 0\n\t\tcase Internal:\n\t\t\tfilter[\"internal\"] = 1\n\t\tcase Big:\n\t\t\tfilter[\"big_customer\"] = 1\n\t\tcase Small:\n\t\t\tfilter[\"big_customer\"] = 0\n\t\tcase Corporate:\n\t\t\tfilter[\"corporate\"] = 1\n\t\tcase Personal:\n\t\t\tfilter[\"corporate\"] = 0\n\t\tdefault:\n\t\t\treturn nil, utils.UnSupportedCustomerTypeError\n\t\t}\n\t}\n\tcomment := o.CommentFunc(SELECT_COMMENT)\n\terr := base.GetInstance().BillingDriver().Clauses(comment).Table(UserInfoTable).Select(\"name,app_id,uin,income_industry_id,income_industry_name,internal\").\n\t\tOrder(\"uin\").Scopes(PaginateDB(page, size)).Where(filter).Scan(&users).Error\n\tif err != nil {\n\t\tif err == db.ErrRecordNotFound {\n\t\t\treturn users, utils.RecordNotFoundError\n\t\t}\n\t\treturn users, err\n\t}\n\treturn users, nil\n}",
    "caller": "func (l *UserOverviewListLogic) UserOverviewList(req *types.UserOverviewRequest, log *logger.IvcLog) (resp *types.UserOverviewListResponse, err error) {\n\t// 1. 校验参数\n\tpageReq := req.PaginationRequest\n\tgeneralReq := req.GeneralRequest\n\tcomment := model.NewComment(req.RequestId, model.UserOverviewListFlow)\n\tappId, err := getAppId(&generalReq, log, comment)\n\tif err != nil {\n\t\tlog.ErrorV(fmt.Sprintf(\"[UserOverviewList] getAppId:%+v err:%v\", *req, err))\n\t\treturn nil, err\n\t}\n\ttimeIntervals, err := CheckUserOverviewParam(req, log)\n\tif err != nil {\n\t\tlog.ErrorV(fmt.Sprintf(\"[UserOverviewList] CheckUserOverviewParam:%+v err:%v\", *req, err))\n\t\treturn nil, err\n\t}\n\tpage, size := model.ReqPagination(&pageReq)\n\t// 2. 查询用户列表\n\tov := &model.Overview{\n\t\tCustomerType: req.CustomerType,\n\t\tIndustryId:   req.IndustryId,\n\t\tAppId:        appId,\n\t\tComment:      comment,\n\t}\n\tusers, err := ov.FindUserListByFilter(page, size)\n\tif err != nil {\n\t\tlog.ErrorV(fmt.Sprintf(\"[UserOverviewList] FindUserListByFilter err:%v\", err))\n\t\treturn nil, err\n\t}\n\tvar endTime int64\n\tappIds, err := ov.FindUserAppIdListByCustomerType(endTime)\n\tif err != nil {\n\t\tlog.ErrorV(fmt.Sprintf(\"[UserOverviewList] FindUserAppIdListByCustomerType err:%v\", err))\n\t\treturn nil, err\n\t}\n\t// 3. 获取用户消耗列表\n\tconsumeMap, err := ov.FindUserBillingConsumeListByFilter(timeIntervals[0], timeIntervals[len(timeIntervals)-1])\n\tif err != nil {\n\t\tlog.ErrorV(fmt.Sprintf(\"[UserOverviewList] FindUserBillingConsumeListByFilter err:%v\", err))\n\t\treturn nil, err\n\t}\n\t// 4. 获取用户实际应收列表\n\tincomeMap, err := ov.FindUserBillingIncomeList(timeIntervals[0], timeIntervals[len(timeIntervals)-1])\n\tif err != nil {\n\t\tlog.ErrorV(fmt.Sprintf(\"[UserOverviewList] FindUserBillingIncomeList err:%v\", err))\n\t\treturn nil, err\n\t}\n\n\tuserList := make([]types.UserOverview, 0)\n\tfor _, u := range users {\n\t\tvar prepaid float64\n\t\tif income, ok := incomeMap[u.AppId]; ok {\n\t\t\tu.ActualReceipt = fmt.Sprintf(\"%.2f\", income.ActualIncome)\n\t\t\tu.PrepaidDeduction = fmt.Sprintf(\"%.2f\", income.PrepaidIncome)\n\t\t\tu.Postpaid = fmt.Sprintf(\"%.2f\", income.ActualIncome-income.PrepaidIncome)\n\t\t\tprepaid = income.PrepaidIncome\n\t\t}\n\t\t// 刊例价 = 后付费消耗 + 预付费折扣\n\t\tif consume, ok := consumeMap[u.AppId]; ok {\n\t\t\tu.Consume = fmt.Sprintf(\"%.2f\", consume+prepaid)\n\t\t} else {\n\t\t\tu.Consume = fmt.Sprintf(\"%.2f\", prepaid)\n\t\t}\n\t\tuserList = append(userList, u)\n\t}\n\tresp = &types.UserOverviewListResponse{\n\t\tTotal:         len(appIds),\n\t\tPage:          page,\n\t\tSize:          size,\n\t\tUserOverviews: userList,\n\t}\n\treturn resp, nil\n}",
    "sql_statement_list": [
      {
        "type": "param_dependent",
        "variants": [
          {
            "scenario": "基础条件：IndustryId=0, AppId=0, CustomerType=0",
            "sql": "SELECT name,app_id,uin,income_industry_id,income_industry_name,internal FROM UserInfoTable WHERE status = ? ORDER BY uin LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "包含IndustryId条件：IndustryId>0, AppId=0, CustomerType=0",
            "sql": "SELECT name,app_id,uin,income_industry_id,income_industry_name,internal FROM UserInfoTable WHERE income_industry_id = ? AND status = ? ORDER BY uin LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "包含AppId条件：IndustryId=0, AppId>0, CustomerType=0",
            "sql": "SELECT name,app_id,uin,income_industry_id,income_industry_name,internal FROM UserInfoTable WHERE app_id = ? AND status = ? ORDER BY uin LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "包含External客户类型：CustomerType=External",
            "sql": "SELECT name,app_id,uin,income_industry_id,income_industry_name,internal FROM UserInfoTable WHERE internal = ? AND status = ? ORDER BY uin LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "包含Internal客户类型：CustomerType=Internal",
            "sql": "SELECT name,app_id,uin,income_industry_id,income_industry_name,internal FROM UserInfoTable WHERE internal = ? AND status = ? ORDER BY uin LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "包含Big客户类型：CustomerType=Big",
            "sql": "SELECT name,app_id,uin,income_industry_id,income_industry_name,internal FROM UserInfoTable WHERE big_customer = ? AND status = ? ORDER BY uin LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "包含Small客户类型：CustomerType=Small",
            "sql": "SELECT name,app_id,uin,income_industry_id,income_industry_name,internal FROM UserInfoTable WHERE big_customer = ? AND status = ? ORDER BY uin LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "包含Corporate客户类型：CustomerType=Corporate",
            "sql": "SELECT name,app_id,uin,income_industry_id,income_industry_name,internal FROM UserInfoTable WHERE corporate = ? AND status = ? ORDER BY uin LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "包含Personal客户类型：CustomerType=Personal",
            "sql": "SELECT name,app_id,uin,income_industry_id,income_industry_name,internal FROM UserInfoTable WHERE corporate = ? AND status = ? ORDER BY uin LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "多条件组合：IndustryId>0, AppId>0, CustomerType=External",
            "sql": "SELECT name,app_id,uin,income_industry_id,income_industry_name,internal FROM UserInfoTable WHERE app_id = ? AND income_industry_id = ? AND internal = ? AND status = ? ORDER BY uin LIMIT ? OFFSET ?;"
          }
        ]
      }
    ],
    "sql_types": [
      "PARAM_DEPENDENT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/types/types.go",
        "code_start_line": 1297,
        "code_end_line": 1308,
        "code_key": "UserOverview",
        "code_value": "type UserOverview struct {\n\tUin              string `json:\"Uin\" gorm:\"column:uin\"`\n\tAppId            int    `json:\"AppId\" gorm:\"column:app_id\"`\n\tName             string `json:\"Name\" gorm:\"column:name\"`\n\tIndustryId       int    `json:\"IndustryId\" gorm:\"column:income_industry_id\"`\n\tIndustryName     string `json:\"IndustryName\" gorm:\"column:income_industry_name\"`\n\tInternal         int    `json:\"Internal\" gorm:\"column:internal\"`\n\tConsume          string `json:\"Consume\" gorm:\"column:consume\"`\n\tActualReceipt    string `json:\"ActualReceipt\" gorm:\"-\"`\n\tPrepaidDeduction string `json:\"PrepaidDeduction\" gorm:\"-\"`\n\tPostpaid         string `json:\"Postpaid\" gorm:\"-\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "c9bb087a681a6287be10c9b6e8e232a6cfc363c7"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-urs.json",
    "matched_keywords": [
      "Scopes"
    ]
  },
  {
    "function_name": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/model/recordtimeline.go:61:86:FindCloudRecordTimelineWhitelists",
    "orm_code": "func (c *Cloud) FindCloudRecordTimelineWhitelists(filterSource map[string]interface{}, page, size int) ([]types.CloudRecordTimelineSource, error) {\n\tbs := make([]types.CloudRecordTimelineSource, 0)\n\tvar err error\n\tcomment := c.CommentFunc(SELECT_COMMENT)\n\tif name, ok := filterSource[\"name\"]; ok {\n\t\tfilter := make(map[string]interface{})\n\t\tfor k, v := range filterSource {\n\t\t\tif k == \"name\" {\n\t\t\t\tcontinue\n\t\t\t}\n\t\t\tfilter[k] = v\n\t\t}\n\t\terr = base.GetInstance().IvcDriver().Clauses(comment).Table(IvcCloudRecordTimelineWhitelistTable).Order(\"id\").Scopes(PaginateDB(page, size)).\n\t\t\tWhere(filter).Where(\"name like ?\", \"%\"+name.(string)+\"%\").Find(&bs).Error\n\t} else {\n\t\terr = base.GetInstance().IvcDriver().Clauses(comment).Table(IvcCloudRecordTimelineWhitelistTable).Order(\"id\").Scopes(PaginateDB(page, size)).\n\t\t\tWhere(filterSource).Find(&bs).Error\n\t}\n\tif err != nil {\n\t\tif err == db.ErrRecordNotFound {\n\t\t\treturn bs, utils.RecordNotFoundError\n\t\t}\n\t\treturn bs, err\n\t}\n\treturn bs, nil\n}",
    "caller": "",
    "sql_statement_list": [
      {
        "type": "param_dependent",
        "variants": [
          {
            "scenario": "filterSource包含name键时的模糊查询",
            "sql": "SELECT id, name, uin, app_id, created_at, updated_at FROM IvcCloudRecordTimelineWhitelistTable WHERE uin = ? AND app_id = ? AND name LIKE ? ORDER BY id LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "filterSource不包含name键时的精确查询",
            "sql": "SELECT id, name, uin, app_id, created_at, updated_at FROM IvcCloudRecordTimelineWhitelistTable WHERE uin = ? AND app_id = ? ORDER BY id LIMIT ? OFFSET ?;"
          }
        ]
      }
    ],
    "sql_types": [
      "PARAM_DEPENDENT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/types/types.go",
        "code_start_line": 379,
        "code_end_line": 386,
        "code_key": "CloudRecordTimelineSource",
        "code_value": "type CloudRecordTimelineSource struct {\n\tId       int    `json:\"Id\" gorm:\"column:id\"`\n\tName     string `json:\"Name\" gorm:\"column:name\"`\n\tUin      string `json:\"Uin\" gorm:\"column:uin\"`\n\tAppId    int    `json:\"AppId\" gorm:\"column:app_id\"`\n\tCreateAt int    `json:\"CreateAt\" gorm:\"column:created_at\"`\n\tUpdateAt int    `json:\"UpdateAt\" gorm:\"column:updated_at\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "c9bb087a681a6287be10c9b6e8e232a6cfc363c7"
      }
    ],
    "sql_pattern_cnt": 2,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-urs.json",
    "matched_keywords": [
      "Scopes"
    ]
  },
  {
    "function_name": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/model/recordtimeline.go:61:86:FindCloudRecordTimelineWhitelists",
    "orm_code": "func (c *Cloud) FindCloudRecordTimelineWhitelists(filterSource map[string]interface{}, page, size int) ([]types.CloudRecordTimelineSource, error) {\n\tbs := make([]types.CloudRecordTimelineSource, 0)\n\tvar err error\n\tcomment := c.CommentFunc(SELECT_COMMENT)\n\tif name, ok := filterSource[\"name\"]; ok {\n\t\tfilter := make(map[string]interface{})\n\t\tfor k, v := range filterSource {\n\t\t\tif k == \"name\" {\n\t\t\t\tcontinue\n\t\t\t}\n\t\t\tfilter[k] = v\n\t\t}\n\t\terr = base.GetInstance().IvcDriver().Clauses(comment).Table(IvcCloudRecordTimelineWhitelistTable).Order(\"id\").Scopes(PaginateDB(page, size)).\n\t\t\tWhere(filter).Where(\"name like ?\", \"%\"+name.(string)+\"%\").Find(&bs).Error\n\t} else {\n\t\terr = base.GetInstance().IvcDriver().Clauses(comment).Table(IvcCloudRecordTimelineWhitelistTable).Order(\"id\").Scopes(PaginateDB(page, size)).\n\t\t\tWhere(filterSource).Find(&bs).Error\n\t}\n\tif err != nil {\n\t\tif err == db.ErrRecordNotFound {\n\t\t\treturn bs, utils.RecordNotFoundError\n\t\t}\n\t\treturn bs, err\n\t}\n\treturn bs, nil\n}",
    "caller": "func (l *QueryCloudRecordTimelineWhitelistLogic) QueryCloudRecordTimelineWhitelist(req *types.QueryCloudRecordTimelineWhitelistRequest, log *logger.IvcLog) (resp *types.QueryCloudRecordTimelineWhitelistReponse, err error) {\n\t// todo: add your logic here and delete this line\n\tpageReq := req.PaginationRequest\n\tpage, size := model.ReqPagination(&pageReq)\n\tfilter := make(map[string]interface{})\n\tif req.AppId > 0 {\n\t\tfilter[\"app_id\"] = req.AppId\n\t} else if len(req.OwnerUin) > 0 {\n\t\terr := utils.CheckUinStr(req.OwnerUin)\n\t\tif err != nil {\n\t\t\tlog.ErrorV(fmt.Sprintf(\"[QueryCloudRecordTimelineWhitelist] CheckUinStr Param Invalid:%+v\", *req), utils.InvalidParamErr)\n\t\t\treturn nil, utils.InvalidParamError\n\t\t}\n\t\tfilter[\"uin\"] = req.OwnerUin\n\t} else if len(req.Name) > 0 {\n\t\terr := utils.CheckNameStr(req.Name)\n\t\tif err != nil {\n\t\t\tlog.ErrorV(fmt.Sprintf(\"[QueryCloudRecordTimelineWhitelist] CheckNameStr Param Invalid:%+v\", *req), utils.InvalidParamErr)\n\t\t\treturn nil, utils.InvalidParamError\n\t\t}\n\t\tfilter[\"name\"] = req.Name\n\t}\n\n\t// 查找符合条件的云录像白名单列表\n\tcloud := &model.Cloud{\n\t\tComment: model.NewComment(req.RequestId, model.QueryCloudRecordTimelineWhitelistFlow),\n\t}\n\n\ttotal, err := cloud.CountCloudRecordTimelineWhitelists(filter)\n\tif err != nil {\n\t\tlog.ErrorV(fmt.Sprintf(\"[QueryCloudRecordTimelineWhitelist] CountCloudRecordTimelineWhitelists err:%v\", err), utils.OperationErr)\n\t\treturn nil, err\n\t}\n\tcs, err := cloud.FindCloudRecordTimelineWhitelists(filter, page, size)\n\tif err != nil {\n\t\terrCode := utils.OperationErr\n\t\tif e, ok := err.(*utils.UrsError); ok {\n\t\t\terrCode = e.Id\n\t\t}\n\t\tlog.ErrorV(fmt.Sprintf(\"[QueryCloudRecordTimelineWhitelist] FindCloudRecordTimelineWhitelists err:%v\", err), errCode)\n\t\treturn nil, err\n\t}\n\tCloudList := make([]types.CloudRecordTimelineWhitelist, 0, len(cs))\n\n\tfor i := range cs {\n\t\tCloudList = append(CloudList, types.CloudRecordTimelineWhitelist{\n\t\t\tId:       cs[i].Id,\n\t\t\tName:     cs[i].Name,\n\t\t\tUin:      cs[i].Uin,\n\t\t\tAppId:    cs[i].AppId,\n\t\t\tCreateAt: utils.UnixTimestampToString(int64(cs[i].CreateAt)),\n\t\t\tUpdateAt: utils.UnixTimestampToString(int64(cs[i].UpdateAt)),\n\t\t})\n\t}\n\tresp = &types.QueryCloudRecordTimelineWhitelistReponse{\n\t\tTimelineList: CloudList,\n\t\tTotal:        total,\n\t\tPage:         page,\n\t\tSize:         size,\n\t}\n\n\treturn resp, nil\n}",
    "sql_statement_list": [
      {
        "type": "param_dependent",
        "variants": [
          {
            "scenario": "filter包含name键且有其他条件",
            "sql": "SELECT * FROM ivc_cloud_record_timeline_whitelist WHERE app_id = ? AND name LIKE ? ORDER BY id LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "filter包含name键但无其他条件",
            "sql": "SELECT * FROM ivc_cloud_record_timeline_whitelist WHERE name LIKE ? ORDER BY id LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "filter包含app_id但不包含name",
            "sql": "SELECT * FROM ivc_cloud_record_timeline_whitelist WHERE app_id = ? ORDER BY id LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "filter包含uin但不包含name",
            "sql": "SELECT * FROM ivc_cloud_record_timeline_whitelist WHERE uin = ? ORDER BY id LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "filter为空",
            "sql": "SELECT * FROM ivc_cloud_record_timeline_whitelist ORDER BY id LIMIT ? OFFSET ?;"
          }
        ]
      }
    ],
    "sql_types": [
      "PARAM_DEPENDENT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/types/types.go",
        "code_start_line": 379,
        "code_end_line": 386,
        "code_key": "CloudRecordTimelineSource",
        "code_value": "type CloudRecordTimelineSource struct {\n\tId       int    `json:\"Id\" gorm:\"column:id\"`\n\tName     string `json:\"Name\" gorm:\"column:name\"`\n\tUin      string `json:\"Uin\" gorm:\"column:uin\"`\n\tAppId    int    `json:\"AppId\" gorm:\"column:app_id\"`\n\tCreateAt int    `json:\"CreateAt\" gorm:\"column:created_at\"`\n\tUpdateAt int    `json:\"UpdateAt\" gorm:\"column:updated_at\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "c9bb087a681a6287be10c9b6e8e232a6cfc363c7"
      }
    ],
    "sql_pattern_cnt": 2,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-urs.json",
    "matched_keywords": [
      "Scopes"
    ]
  },
  {
    "function_name": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/model/daily.go:61:86:FindDailyReportWhitelists",
    "orm_code": "func (c *Daily) FindDailyReportWhitelists(filterSource map[string]interface{}, page, size int) ([]types.DailyReportSource, error) {\n\tbs := make([]types.DailyReportSource, 0)\n\tvar err error\n\tcomment := c.CommentFunc(SELECT_COMMENT)\n\tif name, ok := filterSource[\"name\"]; ok {\n\t\tfilter := make(map[string]interface{})\n\t\tfor k, v := range filterSource {\n\t\t\tif k == \"name\" {\n\t\t\t\tcontinue\n\t\t\t}\n\t\t\tfilter[k] = v\n\t\t}\n\t\terr = base.GetInstance().IvcDriver().Clauses(comment).Table(IvcDailyReportWhitelistTable).Order(\"id\").Scopes(PaginateDB(page, size)).\n\t\t\tWhere(\"name like ?\", \"%\"+name.(string)+\"%\").Find(&bs).Error\n\t} else {\n\t\terr = base.GetInstance().IvcDriver().Clauses(comment).Table(IvcDailyReportWhitelistTable).Order(\"id\").Scopes(PaginateDB(page, size)).\n\t\t\tWhere(filterSource).Find(&bs).Error\n\t}\n\tif err != nil {\n\t\tif err == db.ErrRecordNotFound {\n\t\t\treturn bs, utils.RecordNotFoundError\n\t\t}\n\t\treturn bs, err\n\t}\n\treturn bs, nil\n}",
    "caller": "",
    "sql_statement_list": [
      {
        "type": "param_dependent",
        "variants": [
          {
            "scenario": "filterSource包含name键时进行模糊查询",
            "sql": "SELECT id, name, uin, app_id, altername, created_at, updated_at FROM ivc_daily_report_whitelist WHERE name LIKE ? ORDER BY id LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "filterSource不包含name键时进行精确查询",
            "sql": "SELECT id, name, uin, app_id, altername, created_at, updated_at FROM ivc_daily_report_whitelist WHERE uin = ? AND app_id = ? ORDER BY id LIMIT ? OFFSET ?;"
          }
        ]
      }
    ],
    "sql_types": [
      "PARAM_DEPENDENT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/types/types.go",
        "code_start_line": 428,
        "code_end_line": 436,
        "code_key": "DailyReportSource",
        "code_value": "type DailyReportSource struct {\n\tId        int    `json:\"Id\" gorm:\"column:id\"`\n\tName      string `json:\"Name\" gorm:\"column:name\"`\n\tUin       string `json:\"Uin\" gorm:\"column:uin\"`\n\tAppId     int    `json:\"AppId\" gorm:\"column:app_id\"`\n\tAltername string `json:\"Altername\" gorm:\"altername\"`\n\tCreateAt  int    `json:\"CreateAt\" gorm:\"column:created_at\"`\n\tUpdateAt  int    `json:\"UpdateAt\" gorm:\"column:updated_at\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "c9bb087a681a6287be10c9b6e8e232a6cfc363c7"
      }
    ],
    "sql_pattern_cnt": 2,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-urs.json",
    "matched_keywords": [
      "Scopes"
    ]
  },
  {
    "function_name": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/model/daily.go:61:86:FindDailyReportWhitelists",
    "orm_code": "func (c *Daily) FindDailyReportWhitelists(filterSource map[string]interface{}, page, size int) ([]types.DailyReportSource, error) {\n\tbs := make([]types.DailyReportSource, 0)\n\tvar err error\n\tcomment := c.CommentFunc(SELECT_COMMENT)\n\tif name, ok := filterSource[\"name\"]; ok {\n\t\tfilter := make(map[string]interface{})\n\t\tfor k, v := range filterSource {\n\t\t\tif k == \"name\" {\n\t\t\t\tcontinue\n\t\t\t}\n\t\t\tfilter[k] = v\n\t\t}\n\t\terr = base.GetInstance().IvcDriver().Clauses(comment).Table(IvcDailyReportWhitelistTable).Order(\"id\").Scopes(PaginateDB(page, size)).\n\t\t\tWhere(\"name like ?\", \"%\"+name.(string)+\"%\").Find(&bs).Error\n\t} else {\n\t\terr = base.GetInstance().IvcDriver().Clauses(comment).Table(IvcDailyReportWhitelistTable).Order(\"id\").Scopes(PaginateDB(page, size)).\n\t\t\tWhere(filterSource).Find(&bs).Error\n\t}\n\tif err != nil {\n\t\tif err == db.ErrRecordNotFound {\n\t\t\treturn bs, utils.RecordNotFoundError\n\t\t}\n\t\treturn bs, err\n\t}\n\treturn bs, nil\n}",
    "caller": "func (l *QueryDailyReportWhitelistLogic) QueryDailyReportWhitelist(req *types.QueryDailyReportWhitelistRequest, log *logger.IvcLog) (resp *types.QueryDailyReportWhitelistReponse, err error) {\n\t// todo: add your logic here and delete this line\n\tpageReq := req.PaginationRequest\n\tpage, size := model.ReqPagination(&pageReq)\n\tfilter := make(map[string]interface{})\n\tif req.AppId > 0 {\n\t\tfilter[\"app_id\"] = req.AppId\n\t} else if len(req.OwnerUin) > 0 {\n\t\terr := utils.CheckUinStr(req.OwnerUin)\n\t\tif err != nil {\n\t\t\tlog.ErrorV(fmt.Sprintf(\"[QueryDailyReportWhitelist] CheckUinStr Param Invalid:%+v\", *req), utils.InvalidParamErr)\n\t\t\treturn nil, utils.InvalidParamError\n\t\t}\n\t\tfilter[\"uin\"] = req.OwnerUin\n\t} else if len(req.Name) > 0 {\n\t\terr := utils.CheckNameStr(req.Name)\n\t\tif err != nil {\n\t\t\tlog.ErrorV(fmt.Sprintf(\"[QueryDailyReportWhitelist] CheckNameStr Param Invalid:%+v\", *req), utils.InvalidParamErr)\n\t\t\treturn nil, utils.InvalidParamError\n\t\t}\n\t\tfilter[\"name\"] = req.Name\n\t}\n\n\t// 查找符合条件的云录像白名单列表\n\tdaily := &model.Daily{\n\t\tComment: model.NewComment(req.RequestId, model.QueryDailyReportWhitelistFlow),\n\t}\n\n\ttotal, err := daily.CountDailyReportWhitelists(filter)\n\n\tif err != nil {\n\t\terrCode := utils.OperationErr\n\t\tif e, ok := err.(*utils.UrsError); ok {\n\t\t\terrCode = e.Id\n\t\t}\n\t\tlog.ErrorV(fmt.Sprintf(\"[QueryDailyReportWhitelist] CountDailyReportWhitelists err:%v\", err), errCode)\n\t\treturn nil, err\n\t}\n\n\tcs, err := daily.FindDailyReportWhitelists(filter, page, size)\n\tif err != nil {\n\t\terrCode := utils.OperationErr\n\t\tif e, ok := err.(*utils.UrsError); ok {\n\t\t\terrCode = e.Id\n\t\t}\n\t\tlog.ErrorV(fmt.Sprintf(\"[QueryDailyReportWhitelist] FindDailyReportWhitelists err:%v\", err), errCode)\n\t\treturn nil, err\n\t}\n\tDailyList := make([]types.DailyReportWhitelist, 0, len(cs))\n\n\tfor i := range cs {\n\t\tDailyList = append(DailyList, types.DailyReportWhitelist{\n\t\t\tId:        cs[i].Id,\n\t\t\tName:      cs[i].Name,\n\t\t\tUin:       cs[i].Uin,\n\t\t\tAppId:     cs[i].AppId,\n\t\t\tAltername: cs[i].Altername,\n\t\t\tCreateAt:  utils.UnixTimestampToString(int64(cs[i].CreateAt)),\n\t\t\tUpdateAt:  utils.UnixTimestampToString(int64(cs[i].UpdateAt)),\n\t\t})\n\t}\n\tresp = &types.QueryDailyReportWhitelistReponse{\n\t\tDailyReportList: DailyList,\n\t\tTotal:           total,\n\t\tPage:            page,\n\t\tSize:            size,\n\t}\n\n\treturn resp, nil\n}",
    "sql_statement_list": [
      {
        "type": "param_dependent",
        "variants": [
          {
            "scenario": "当filter包含name键时，使用LIKE模糊查询",
            "sql": "SELECT * FROM IvcDailyReportWhitelistTable WHERE name LIKE ? ORDER BY id LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "当filter包含app_id键时，使用等值查询",
            "sql": "SELECT * FROM IvcDailyReportWhitelistTable WHERE app_id = ? ORDER BY id LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "当filter包含uin键时，使用等值查询",
            "sql": "SELECT * FROM IvcDailyReportWhitelistTable WHERE uin = ? ORDER BY id LIMIT ? OFFSET ?;"
          },
          {
            "scenario": "当filter为空时，查询全表",
            "sql": "SELECT * FROM IvcDailyReportWhitelistTable ORDER BY id LIMIT ? OFFSET ?;"
          }
        ]
      }
    ],
    "sql_types": [
      "PARAM_DEPENDENT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/IVC__ivc-urs/internal/types/types.go",
        "code_start_line": 428,
        "code_end_line": 436,
        "code_key": "DailyReportSource",
        "code_value": "type DailyReportSource struct {\n\tId        int    `json:\"Id\" gorm:\"column:id\"`\n\tName      string `json:\"Name\" gorm:\"column:name\"`\n\tUin       string `json:\"Uin\" gorm:\"column:uin\"`\n\tAppId     int    `json:\"AppId\" gorm:\"column:app_id\"`\n\tAltername string `json:\"Altername\" gorm:\"altername\"`\n\tCreateAt  int    `json:\"CreateAt\" gorm:\"column:created_at\"`\n\tUpdateAt  int    `json:\"UpdateAt\" gorm:\"column:updated_at\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "c9bb087a681a6287be10c9b6e8e232a6cfc363c7"
      }
    ],
    "sql_pattern_cnt": 2,
    "source_file": "/data/shawn/venus_api/orm2sql/ivc_temp/IVC__ivc-urs.json",
    "matched_keywords": [
      "Scopes"
    ]
  },
  {
    "function_name": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/dnspod__dnspod_backend/backend/common/bussiness/user/api.go:34:39:GetUserInfo",
    "orm_code": "func (s *userImpl) GetUserInfo(ctx context.Context, options ...func(option *gorm.DB) *gorm.DB) (*mysql.User, error) {\n\tvar user *mysql.User\n\tresult := s.DB.WithContext(ctx).Scopes(options...).First(&user)\n\n\treturn user, result.Error\n}",
    "caller": "",
    "sql_statement_list": [
      {
        "type": "param_dependent",
        "variants": [
          {
            "scenario": "无额外条件（options为空）",
            "sql": "SELECT * FROM users LIMIT 1;"
          },
          {
            "scenario": "带WHERE条件的option",
            "sql": "SELECT * FROM users WHERE status = ? LIMIT 1;"
          },
          {
            "scenario": "带ORDER BY的option",
            "sql": "SELECT * FROM users ORDER BY id DESC LIMIT 1;"
          },
          {
            "scenario": "带SELECT字段限制的option",
            "sql": "SELECT id, email, status FROM users LIMIT 1;"
          },
          {
            "scenario": "复合条件option（WHERE + ORDER BY）",
            "sql": "SELECT * FROM users WHERE status = ? ORDER BY id DESC LIMIT 1;"
          }
        ]
      }
    ],
    "sql_types": [
      "PARAM_DEPENDENT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/dnspod__dnspod_backend/backend/common/bussiness/user/api.go",
        "code_start_line": 13,
        "code_end_line": 16,
        "code_key": "User",
        "code_value": "type User interface {\n\tGetUserInfo(ctx context.Context, options ...func(option *gorm.DB) *gorm.DB) (*mysql.User, error)\n\tUin(uin string) Option\n}",
        "code_label": null,
        "code_type": 3,
        "code_version": "2c9bc9914615f326b709cc019502dda7730f6f91"
      },
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/dnspod__dnspod_backend/backend/application/slavedns/repo/user/user.go",
        "code_start_line": 12,
        "code_end_line": 14,
        "code_key": "User",
        "code_value": "type User interface {\n\tGetUserByID(ctx context.Context, userID uint) (mysql.User, error)\n}",
        "code_label": null,
        "code_type": 3,
        "code_version": "2c9bc9914615f326b709cc019502dda7730f6f91"
      },
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/dnspod__dnspod_backend/backend/application/ccdb/entity/mysql/users.go",
        "code_start_line": 4,
        "code_end_line": 15,
        "code_key": "User",
        "code_value": "type User struct {\n\tID        uint   `gorm:\"column:id;int unsigned;autoIncrement\" json:\"id\"`\n\tEmail     string `gorm:\"column:email;varchar\" json:\"email\"`\n\tPassword  string `gorm:\"column:password;varchar\" json:\"password\"`\n\tStatus    string `gorm:\"column:status;enum\" json:\"status\"`\n\tVersion   int8   `gorm:\"column:version;tinyint\" json:\"version\"`\n\tSecretKey string `gorm:\"column:secret_key;char\" json:\"secret_key\"`\n\tQq        int64  `gorm:\"column:qq;bigint\" json:\"qq\"`\n\tQcloudUin int64  `gorm:\"column:qcloud_uin;bigint\" json:\"qcloud_uin\"`\n\tAppID     int64  `gorm:\"column:app_id;bigint\" json:\"app_id\"`\n\tIsOldUser int8   `gorm:\"column:is_old_user;tinyint\" json:\"is_old_user\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "2c9bc9914615f326b709cc019502dda7730f6f91"
      },
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/dnspod__dnspod_backend/backend/application/ccdb/entity/mysql/users.go",
        "code_start_line": 18,
        "code_end_line": 20,
        "code_key": "TableName",
        "code_value": "func (User) TableName() string {\n\treturn \"users\"\n}",
        "code_label": null,
        "code_type": 2,
        "code_version": "2c9bc9914615f326b709cc019502dda7730f6f91"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/gorm_orm_code/dnspod__dnspod_backend.json",
    "matched_keywords": [
      "Scopes"
    ]
  },
  {
    "function_name": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/dnspod__dnspod_backend/backend/common/bussiness/user/api.go:34:39:GetUserInfo",
    "orm_code": "func (s *userImpl) GetUserInfo(ctx context.Context, options ...func(option *gorm.DB) *gorm.DB) (*mysql.User, error) {\n\tvar user *mysql.User\n\tresult := s.DB.WithContext(ctx).Scopes(options...).First(&user)\n\n\treturn user, result.Error\n}",
    "caller": "func ServerFilter() filter.ServerFilter {\n\treturn func(ctx context.Context, req interface{}, handle filter.ServerHandleFunc) (rsp interface{}, err error) {\n\n\t\tmsg := codec.Message(ctx)\n\t\tmeta := msg.ServerMetaData().Clone()\n\t\townerUin := string(meta[\"OwnerUin\"])\n\t\tslaveDB, err := tgorm.NewClientProxy(slaveDBServiceName)\n\t\tif err != nil {\n\t\t\treturn nil, errors.New(\"error to create slave db client\")\n\t\t}\n\t\ti := user.New(slaveDB)\n\n\t\tu, err := i.GetUserInfo(ctx, i.Uin(ownerUin))\n\t\tif err != nil {\n\t\t\treturn nil, err\n\t\t}\n\t\tif u.ID == 0 {\n\t\t\treturn nil, errors.New(\"error uin\")\n\t\t}\n\t\t//metadata.SetOwnerUin()\n\t\treturn nil, err\n\t}\n\n}",
    "sql_statement_list": [
      "SELECT id, email, password, status, version, secret_key, qq, qcloud_uin, app_id, is_old_user FROM users WHERE qcloud_uin = ? ORDER BY id LIMIT 1;"
    ],
    "sql_types": [
      "SELECT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/dnspod__dnspod_backend/backend/common/bussiness/user/api.go",
        "code_start_line": 13,
        "code_end_line": 16,
        "code_key": "User",
        "code_value": "type User interface {\n\tGetUserInfo(ctx context.Context, options ...func(option *gorm.DB) *gorm.DB) (*mysql.User, error)\n\tUin(uin string) Option\n}",
        "code_label": null,
        "code_type": 3,
        "code_version": "2c9bc9914615f326b709cc019502dda7730f6f91"
      },
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/dnspod__dnspod_backend/backend/application/slavedns/repo/user/user.go",
        "code_start_line": 12,
        "code_end_line": 14,
        "code_key": "User",
        "code_value": "type User interface {\n\tGetUserByID(ctx context.Context, userID uint) (mysql.User, error)\n}",
        "code_label": null,
        "code_type": 3,
        "code_version": "2c9bc9914615f326b709cc019502dda7730f6f91"
      },
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/dnspod__dnspod_backend/backend/application/ccdb/entity/mysql/users.go",
        "code_start_line": 4,
        "code_end_line": 15,
        "code_key": "User",
        "code_value": "type User struct {\n\tID        uint   `gorm:\"column:id;int unsigned;autoIncrement\" json:\"id\"`\n\tEmail     string `gorm:\"column:email;varchar\" json:\"email\"`\n\tPassword  string `gorm:\"column:password;varchar\" json:\"password\"`\n\tStatus    string `gorm:\"column:status;enum\" json:\"status\"`\n\tVersion   int8   `gorm:\"column:version;tinyint\" json:\"version\"`\n\tSecretKey string `gorm:\"column:secret_key;char\" json:\"secret_key\"`\n\tQq        int64  `gorm:\"column:qq;bigint\" json:\"qq\"`\n\tQcloudUin int64  `gorm:\"column:qcloud_uin;bigint\" json:\"qcloud_uin\"`\n\tAppID     int64  `gorm:\"column:app_id;bigint\" json:\"app_id\"`\n\tIsOldUser int8   `gorm:\"column:is_old_user;tinyint\" json:\"is_old_user\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "2c9bc9914615f326b709cc019502dda7730f6f91"
      },
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/dnspod__dnspod_backend/backend/application/ccdb/entity/mysql/users.go",
        "code_start_line": 18,
        "code_end_line": 20,
        "code_key": "TableName",
        "code_value": "func (User) TableName() string {\n\treturn \"users\"\n}",
        "code_label": null,
        "code_type": 2,
        "code_version": "2c9bc9914615f326b709cc019502dda7730f6f91"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/gorm_orm_code/dnspod__dnspod_backend.json",
    "matched_keywords": [
      "Scopes"
    ]
  },
  {
    "function_name": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/dnspod__dnspod_backend/backend/common/bussiness/user/api.go:34:39:GetUserInfo",
    "orm_code": "func (s *userImpl) GetUserInfo(ctx context.Context, options ...func(option *gorm.DB) *gorm.DB) (*mysql.User, error) {\n\tvar user *mysql.User\n\tresult := s.DB.WithContext(ctx).Scopes(options...).First(&user)\n\n\treturn user, result.Error\n}",
    "caller": "func ServerFilter() filter.ServerFilter {\n\treturn func(ctx context.Context, req interface{}, next filter.ServerHandleFunc) (rsp interface{}, err error) {\n\t\tvar (\n\t\t\tmsg      = trpc.Message(ctx)\n\t\t\tremoteIP string\n\t\t\tserverIP string\n\t\t)\n\t\tif msg.LocalAddr() != nil {\n\t\t\tlocalAddr := msg.LocalAddr().String()\n\t\t\tla := strings.Split(localAddr, \":\")\n\t\t\tserverIP = la[0]\n\t\t}\n\t\tif msg.RemoteAddr() != nil {\n\t\t\tremoteAddr := msg.RemoteAddr().String()\n\t\t\tra := strings.Split(remoteAddr, \":\")\n\t\t\tremoteIP = ra[0]\n\t\t}\n\n\t\tlog.WithContextFields(ctx, \"ServerIP\", serverIP, \"RemoteIP\", remoteIP)\n\n\t\trsp, err = next(ctx, req)\n\n\t\treturn rsp, err\n\t}\n}",
    "sql_statement_list": [
      "SELECT id, email, password, status, version, secret_key, qq, qcloud_uin, app_id, is_old_user FROM users LIMIT 1;"
    ],
    "sql_types": [
      "SELECT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/dnspod__dnspod_backend/backend/common/bussiness/user/api.go",
        "code_start_line": 13,
        "code_end_line": 16,
        "code_key": "User",
        "code_value": "type User interface {\n\tGetUserInfo(ctx context.Context, options ...func(option *gorm.DB) *gorm.DB) (*mysql.User, error)\n\tUin(uin string) Option\n}",
        "code_label": null,
        "code_type": 3,
        "code_version": "2c9bc9914615f326b709cc019502dda7730f6f91"
      },
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/dnspod__dnspod_backend/backend/application/slavedns/repo/user/user.go",
        "code_start_line": 12,
        "code_end_line": 14,
        "code_key": "User",
        "code_value": "type User interface {\n\tGetUserByID(ctx context.Context, userID uint) (mysql.User, error)\n}",
        "code_label": null,
        "code_type": 3,
        "code_version": "2c9bc9914615f326b709cc019502dda7730f6f91"
      },
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/dnspod__dnspod_backend/backend/application/ccdb/entity/mysql/users.go",
        "code_start_line": 4,
        "code_end_line": 15,
        "code_key": "User",
        "code_value": "type User struct {\n\tID        uint   `gorm:\"column:id;int unsigned;autoIncrement\" json:\"id\"`\n\tEmail     string `gorm:\"column:email;varchar\" json:\"email\"`\n\tPassword  string `gorm:\"column:password;varchar\" json:\"password\"`\n\tStatus    string `gorm:\"column:status;enum\" json:\"status\"`\n\tVersion   int8   `gorm:\"column:version;tinyint\" json:\"version\"`\n\tSecretKey string `gorm:\"column:secret_key;char\" json:\"secret_key\"`\n\tQq        int64  `gorm:\"column:qq;bigint\" json:\"qq\"`\n\tQcloudUin int64  `gorm:\"column:qcloud_uin;bigint\" json:\"qcloud_uin\"`\n\tAppID     int64  `gorm:\"column:app_id;bigint\" json:\"app_id\"`\n\tIsOldUser int8   `gorm:\"column:is_old_user;tinyint\" json:\"is_old_user\"`\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "2c9bc9914615f326b709cc019502dda7730f6f91"
      },
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/dnspod__dnspod_backend/backend/application/ccdb/entity/mysql/users.go",
        "code_start_line": 18,
        "code_end_line": 20,
        "code_key": "TableName",
        "code_value": "func (User) TableName() string {\n\treturn \"users\"\n}",
        "code_label": null,
        "code_type": 2,
        "code_version": "2c9bc9914615f326b709cc019502dda7730f6f91"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/gorm_orm_code/dnspod__dnspod_backend.json",
    "matched_keywords": [
      "Scopes"
    ]
  },
  {
    "function_name": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/dnspod__dnspod_backend/backend/application/oplog/repo/oplog/oplog.go:30:33:AddDomainOpLog",
    "orm_code": "func (db *opLogImpl) AddDomainOpLog(ctx context.Context, l *DomainOperationLogs, suffix int64) error {\n\tresult := db.Scopes(DomainOpLogTable(suffix)).Create(l)\n\treturn result.Error\n}",
    "caller": "",
    "sql_statement_list": [
      "INSERT INTO domain_operation_logs (domain_id, operate_on, uin, real_client_ip, content, created_at) VALUES (?, ?, ?, ?, ?, ?);"
    ],
    "sql_types": [
      "INSERT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/dnspod__dnspod_backend/backend/application/oplog/repo/oplog/entity.go",
        "code_start_line": 10,
        "code_end_line": 18,
        "code_key": "DomainOperationLogs",
        "code_value": "type DomainOperationLogs struct {\n\tID           int64     `gorm:\"column:id;bigint;autoIncrement\" json:\"id\"`\n\tDomainID     int64     `gorm:\"column:domain_id;bigint\" json:\"domain_id\"`\n\tOperateOn    time.Time `gorm:\"column:operate_on;timestamp;\" json:\"operate_on\"`               //操作时间\n\tUin          int64     `gorm:\"column:uin;bigint\" json:\"uin\"`                                 //操作帐号UIN\n\tRealClientIP int64     `gorm:\"column:real_client_ip;bigint\" json:\"real_client_ip\"`           //客户IP\n\tContent      string    `gorm:\"column:content;varchar\" json:\"content\"`                        //操作内容\n\tCreatedAt    time.Time `gorm:\"column:created_at;timestamp;autoCreateTime\" json:\"created_at\"` //创建时间\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "2c9bc9914615f326b709cc019502dda7730f6f91"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/gorm_orm_code/dnspod__dnspod_backend.json",
    "matched_keywords": [
      "Scopes"
    ]
  },
  {
    "function_name": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/dnspod__dnspod_backend/backend/application/oplog/repo/oplog/oplog.go:30:33:AddDomainOpLog",
    "orm_code": "func (db *opLogImpl) AddDomainOpLog(ctx context.Context, l *DomainOperationLogs, suffix int64) error {\n\tresult := db.Scopes(DomainOpLogTable(suffix)).Create(l)\n\treturn result.Error\n}",
    "caller": "func (s *sdnsLogImpl) AddLog(conf *mysql.Config, content string) error {\n\tl := &mysql.Log{\n\t\tDomainID:  conf.DomainID,\n\t\tDomain:    conf.Domain,\n\t\tContent:   content,\n\t\tOperateOn: time.Now(),\n\t}\n\tres := s.Create(&l)\n\tif res.Error != nil {\n\t\t// 日志写入错误，\n\t\tlog.Errorf(\"revNotify send soa write db error. table:slave_logs, error:%s\", res.Error.Error())\n\t\treturn res.Error\n\t}\n\treturn nil\n}",
    "sql_statement_list": [
      "INSERT INTO domain_operation_logs (domain_id, operate_on, uin, real_client_ip, content, created_at) VALUES (?, ?, ?, ?, ?, ?);"
    ],
    "sql_types": [
      "INSERT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/dnspod__dnspod_backend/backend/application/oplog/repo/oplog/entity.go",
        "code_start_line": 10,
        "code_end_line": 18,
        "code_key": "DomainOperationLogs",
        "code_value": "type DomainOperationLogs struct {\n\tID           int64     `gorm:\"column:id;bigint;autoIncrement\" json:\"id\"`\n\tDomainID     int64     `gorm:\"column:domain_id;bigint\" json:\"domain_id\"`\n\tOperateOn    time.Time `gorm:\"column:operate_on;timestamp;\" json:\"operate_on\"`               //操作时间\n\tUin          int64     `gorm:\"column:uin;bigint\" json:\"uin\"`                                 //操作帐号UIN\n\tRealClientIP int64     `gorm:\"column:real_client_ip;bigint\" json:\"real_client_ip\"`           //客户IP\n\tContent      string    `gorm:\"column:content;varchar\" json:\"content\"`                        //操作内容\n\tCreatedAt    time.Time `gorm:\"column:created_at;timestamp;autoCreateTime\" json:\"created_at\"` //创建时间\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "2c9bc9914615f326b709cc019502dda7730f6f91"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/gorm_orm_code/dnspod__dnspod_backend.json",
    "matched_keywords": [
      "Scopes"
    ]
  },
  {
    "function_name": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/dnspod__dnspod_backend/backend/application/oplog/repo/oplog/oplog.go:30:33:AddDomainOpLog",
    "orm_code": "func (db *opLogImpl) AddDomainOpLog(ctx context.Context, l *DomainOperationLogs, suffix int64) error {\n\tresult := db.Scopes(DomainOpLogTable(suffix)).Create(l)\n\treturn result.Error\n}",
    "caller": "func (d *DomainImpl) AddLog(ctx context.Context, value []byte) error {\n\tv := &domainOpLog{}\n\terr := json.Unmarshal(value, v)\n\tif err != nil {\n\t\treturn errors.New(\"[domainOpLog] json unmarshal failed, error:\" + err.Error() + \", value:\" + string(value))\n\t}\n\tOperateOn, err := time.Parse(\"2006-01-02 15:04:05\", v.OperateOn)\n\tif err != nil {\n\t\treturn errors.New(\"[domainOpLog] operateOn is not Time format, error:\" + err.Error() + \", operateOn:\" + v.OperateOn)\n\t}\n\t//d := l.(*domainOpLog)\n\tl := &oplog.DomainOperationLogs{\n\t\tDomainID:     v.DomainID,\n\t\tOperateOn:    OperateOn,\n\t\tUin:          v.Uin,\n\t\tRealClientIP: v.RealClientIP,\n\t\tContent:      v.Content,\n\t}\n\tsuffix := v.DomainID % tableCount\n\toplog.NewOpLogImpl().AddDomainOpLog(ctx, l, suffix)\n\treturn nil\n}",
    "sql_statement_list": [
      {
        "type": "param_dependent",
        "variants": [
          {
            "scenario": "插入域名操作日志记录到分表",
            "sql": "INSERT INTO `domain_operation_logs_0` (`domain_id`,`operate_on`,`uin`,`real_client_ip`,`content`,`created_at`) VALUES (?,?,?,?,?,?);"
          }
        ]
      }
    ],
    "sql_types": [
      "PARAM_DEPENDENT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/dnspod__dnspod_backend/backend/application/oplog/repo/oplog/entity.go",
        "code_start_line": 10,
        "code_end_line": 18,
        "code_key": "DomainOperationLogs",
        "code_value": "type DomainOperationLogs struct {\n\tID           int64     `gorm:\"column:id;bigint;autoIncrement\" json:\"id\"`\n\tDomainID     int64     `gorm:\"column:domain_id;bigint\" json:\"domain_id\"`\n\tOperateOn    time.Time `gorm:\"column:operate_on;timestamp;\" json:\"operate_on\"`               //操作时间\n\tUin          int64     `gorm:\"column:uin;bigint\" json:\"uin\"`                                 //操作帐号UIN\n\tRealClientIP int64     `gorm:\"column:real_client_ip;bigint\" json:\"real_client_ip\"`           //客户IP\n\tContent      string    `gorm:\"column:content;varchar\" json:\"content\"`                        //操作内容\n\tCreatedAt    time.Time `gorm:\"column:created_at;timestamp;autoCreateTime\" json:\"created_at\"` //创建时间\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "2c9bc9914615f326b709cc019502dda7730f6f91"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/gorm_orm_code/dnspod__dnspod_backend.json",
    "matched_keywords": [
      "Scopes"
    ]
  },
  {
    "function_name": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/dnspod__dnspod_backend/backend/application/oplog/repo/oplog/oplog.go:30:33:AddDomainOpLog",
    "orm_code": "func (db *opLogImpl) AddDomainOpLog(ctx context.Context, l *DomainOperationLogs, suffix int64) error {\n\tresult := db.Scopes(DomainOpLogTable(suffix)).Create(l)\n\treturn result.Error\n}",
    "caller": "func (d *UserImpl) AddLog(ctx context.Context, value []byte) error {\n\tv := &userOpLog{}\n\terr := json.Unmarshal(value, v)\n\tif err != nil {\n\t\treturn errors.New(\"[userDomainLog] json unmarshal failed, error:\" + err.Error() + \", value:\" + string(value))\n\t}\n\tOperateOn, err := time.Parse(\"2006-01-02 15:04:05\", v.OperateOn)\n\tif err != nil {\n\t\treturn errors.New(\"[userDomainLog] operateOn is not Time format, error:\" + err.Error() + \", operateOn:\" + v.OperateOn)\n\t}\n\t//d := l.(*domainOpLog)\n\tl := &oplog.UserOperationLogs{\n\t\tUserID:       v.UserID,\n\t\tOperateOn:    OperateOn,\n\t\tUin:          v.Uin,\n\t\tRealClientIP: v.RealClientIP,\n\t\tContent:      v.Content,\n\t}\n\tsuffix := v.UserID % tableCount\n\n\toplog.NewOpLogImpl().AddUserOpLog(ctx, l, suffix)\n\treturn nil\n}",
    "sql_statement_list": [],
    "sql_types": [],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/dnspod__dnspod_backend/backend/application/oplog/repo/oplog/entity.go",
        "code_start_line": 10,
        "code_end_line": 18,
        "code_key": "DomainOperationLogs",
        "code_value": "type DomainOperationLogs struct {\n\tID           int64     `gorm:\"column:id;bigint;autoIncrement\" json:\"id\"`\n\tDomainID     int64     `gorm:\"column:domain_id;bigint\" json:\"domain_id\"`\n\tOperateOn    time.Time `gorm:\"column:operate_on;timestamp;\" json:\"operate_on\"`               //操作时间\n\tUin          int64     `gorm:\"column:uin;bigint\" json:\"uin\"`                                 //操作帐号UIN\n\tRealClientIP int64     `gorm:\"column:real_client_ip;bigint\" json:\"real_client_ip\"`           //客户IP\n\tContent      string    `gorm:\"column:content;varchar\" json:\"content\"`                        //操作内容\n\tCreatedAt    time.Time `gorm:\"column:created_at;timestamp;autoCreateTime\" json:\"created_at\"` //创建时间\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "2c9bc9914615f326b709cc019502dda7730f6f91"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/gorm_orm_code/dnspod__dnspod_backend.json",
    "matched_keywords": [
      "Scopes"
    ]
  },
  {
    "function_name": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/dnspod__dnspod_backend/backend/application/oplog/repo/oplog/oplog.go:30:33:AddDomainOpLog",
    "orm_code": "func (db *opLogImpl) AddDomainOpLog(ctx context.Context, l *DomainOperationLogs, suffix int64) error {\n\tresult := db.Scopes(DomainOpLogTable(suffix)).Create(l)\n\treturn result.Error\n}",
    "caller": "func (d *DomainRemoveImpl) AddLog(ctx context.Context, value []byte) error {\n\tv := &domainRemoveLog{}\n\terr := json.Unmarshal(value, v)\n\tif err != nil {\n\t\treturn errors.New(\"[domainRemoveLog] json unmarshal failed, error:\" + err.Error() + \", value:\" + string(value))\n\t}\n\tOperateOn, err := time.Parse(\"2006-01-02 15:04:05\", v.OperateOn)\n\tif err != nil {\n\t\treturn errors.New(\"[domainRemoveLog] operateOn is not Time format, error:\" + err.Error() + \", operateOn:\" + v.OperateOn)\n\t}\n\t//d := l.(*domainOpLog)\n\tl := &oplog.DomainRemoveLogs{\n\t\tDomainID:     v.DomainID,\n\t\tDomain:       v.Domain,\n\t\tOperateOn:    OperateOn,\n\t\tOperator:     v.Operator,\n\t\tRealClientIP: v.RealClientIP,\n\t\tContent:      v.Content,\n\t}\n\n\toplog.NewOpLogImpl().AddDomainRemoveLog(ctx, l)\n\treturn nil\n}",
    "sql_statement_list": [
      {
        "type": "param_dependent",
        "variants": [
          {
            "scenario": "插入域名操作日志记录到动态表名",
            "sql": "INSERT INTO domain_operation_logs_? (domain_id, operate_on, uin, real_client_ip, content, created_at) VALUES (?, ?, ?, ?, ?, ?);"
          }
        ]
      }
    ],
    "sql_types": [
      "PARAM_DEPENDENT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/dnspod__dnspod_backend/backend/application/oplog/repo/oplog/entity.go",
        "code_start_line": 10,
        "code_end_line": 18,
        "code_key": "DomainOperationLogs",
        "code_value": "type DomainOperationLogs struct {\n\tID           int64     `gorm:\"column:id;bigint;autoIncrement\" json:\"id\"`\n\tDomainID     int64     `gorm:\"column:domain_id;bigint\" json:\"domain_id\"`\n\tOperateOn    time.Time `gorm:\"column:operate_on;timestamp;\" json:\"operate_on\"`               //操作时间\n\tUin          int64     `gorm:\"column:uin;bigint\" json:\"uin\"`                                 //操作帐号UIN\n\tRealClientIP int64     `gorm:\"column:real_client_ip;bigint\" json:\"real_client_ip\"`           //客户IP\n\tContent      string    `gorm:\"column:content;varchar\" json:\"content\"`                        //操作内容\n\tCreatedAt    time.Time `gorm:\"column:created_at;timestamp;autoCreateTime\" json:\"created_at\"` //创建时间\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "2c9bc9914615f326b709cc019502dda7730f6f91"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/gorm_orm_code/dnspod__dnspod_backend.json",
    "matched_keywords": [
      "Scopes"
    ]
  },
  {
    "function_name": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/dnspod__dnspod_backend/backend/application/oplog/repo/oplog/oplog.go:40:43:AddUserOpLog",
    "orm_code": "func (db *opLogImpl) AddUserOpLog(ctx context.Context, l *UserOperationLogs, suffix int64) error {\n\tresult := db.Scopes(UserOpLogTable(suffix)).Create(l)\n\treturn result.Error\n}",
    "caller": "",
    "sql_statement_list": [
      "INSERT INTO `user_operation_logs` (`user_id`,`operate_on`,`uin`,`real_client_ip`,`content`,`created_at`) VALUES (?,?,?,?,?,?);"
    ],
    "sql_types": [
      "INSERT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/dnspod__dnspod_backend/backend/application/oplog/repo/oplog/entity.go",
        "code_start_line": 29,
        "code_end_line": 37,
        "code_key": "UserOperationLogs",
        "code_value": "type UserOperationLogs struct {\n\tID           int64     `gorm:\"column:id;bigint;autoIncrement\" json:\"id\"`\n\tUserID       int64     `gorm:\"column:user_id;bigint\" json:\"user_id\"`\n\tOperateOn    time.Time `gorm:\"column:operate_on;timestamp;\" json:\"operate_on\"`               //操作时间\n\tUin          int64     `gorm:\"column:uin;bigint\" json:\"uin\"`                                 //操作帐号UIN\n\tRealClientIP int64     `gorm:\"column:real_client_ip;bigint\" json:\"real_client_ip\"`           //客户IP\n\tContent      string    `gorm:\"column:content;varchar\" json:\"content\"`                        //操作内容\n\tCreatedAt    time.Time `gorm:\"column:created_at;timestamp;autoCreateTime\" json:\"created_at\"` //创建时间\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "2c9bc9914615f326b709cc019502dda7730f6f91"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/gorm_orm_code/dnspod__dnspod_backend.json",
    "matched_keywords": [
      "Scopes"
    ]
  },
  {
    "function_name": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/dnspod__dnspod_backend/backend/application/oplog/repo/oplog/oplog.go:40:43:AddUserOpLog",
    "orm_code": "func (db *opLogImpl) AddUserOpLog(ctx context.Context, l *UserOperationLogs, suffix int64) error {\n\tresult := db.Scopes(UserOpLogTable(suffix)).Create(l)\n\treturn result.Error\n}",
    "caller": "func (s *sdnsLogImpl) AddLog(conf *mysql.Config, content string) error {\n\tl := &mysql.Log{\n\t\tDomainID:  conf.DomainID,\n\t\tDomain:    conf.Domain,\n\t\tContent:   content,\n\t\tOperateOn: time.Now(),\n\t}\n\tres := s.Create(&l)\n\tif res.Error != nil {\n\t\t// 日志写入错误，\n\t\tlog.Errorf(\"revNotify send soa write db error. table:slave_logs, error:%s\", res.Error.Error())\n\t\treturn res.Error\n\t}\n\treturn nil\n}",
    "sql_statement_list": [
      "INSERT INTO user_operation_logs_? (user_id, operate_on, uin, real_client_ip, content, created_at) VALUES (?, ?, ?, ?, ?, ?);"
    ],
    "sql_types": [
      "INSERT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/dnspod__dnspod_backend/backend/application/oplog/repo/oplog/entity.go",
        "code_start_line": 29,
        "code_end_line": 37,
        "code_key": "UserOperationLogs",
        "code_value": "type UserOperationLogs struct {\n\tID           int64     `gorm:\"column:id;bigint;autoIncrement\" json:\"id\"`\n\tUserID       int64     `gorm:\"column:user_id;bigint\" json:\"user_id\"`\n\tOperateOn    time.Time `gorm:\"column:operate_on;timestamp;\" json:\"operate_on\"`               //操作时间\n\tUin          int64     `gorm:\"column:uin;bigint\" json:\"uin\"`                                 //操作帐号UIN\n\tRealClientIP int64     `gorm:\"column:real_client_ip;bigint\" json:\"real_client_ip\"`           //客户IP\n\tContent      string    `gorm:\"column:content;varchar\" json:\"content\"`                        //操作内容\n\tCreatedAt    time.Time `gorm:\"column:created_at;timestamp;autoCreateTime\" json:\"created_at\"` //创建时间\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "2c9bc9914615f326b709cc019502dda7730f6f91"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/gorm_orm_code/dnspod__dnspod_backend.json",
    "matched_keywords": [
      "Scopes"
    ]
  },
  {
    "function_name": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/dnspod__dnspod_backend/backend/application/oplog/repo/oplog/oplog.go:40:43:AddUserOpLog",
    "orm_code": "func (db *opLogImpl) AddUserOpLog(ctx context.Context, l *UserOperationLogs, suffix int64) error {\n\tresult := db.Scopes(UserOpLogTable(suffix)).Create(l)\n\treturn result.Error\n}",
    "caller": "func (d *DomainImpl) AddLog(ctx context.Context, value []byte) error {\n\tv := &domainOpLog{}\n\terr := json.Unmarshal(value, v)\n\tif err != nil {\n\t\treturn errors.New(\"[domainOpLog] json unmarshal failed, error:\" + err.Error() + \", value:\" + string(value))\n\t}\n\tOperateOn, err := time.Parse(\"2006-01-02 15:04:05\", v.OperateOn)\n\tif err != nil {\n\t\treturn errors.New(\"[domainOpLog] operateOn is not Time format, error:\" + err.Error() + \", operateOn:\" + v.OperateOn)\n\t}\n\t//d := l.(*domainOpLog)\n\tl := &oplog.DomainOperationLogs{\n\t\tDomainID:     v.DomainID,\n\t\tOperateOn:    OperateOn,\n\t\tUin:          v.Uin,\n\t\tRealClientIP: v.RealClientIP,\n\t\tContent:      v.Content,\n\t}\n\tsuffix := v.DomainID % tableCount\n\toplog.NewOpLogImpl().AddDomainOpLog(ctx, l, suffix)\n\treturn nil\n}",
    "sql_statement_list": [],
    "sql_types": [],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/dnspod__dnspod_backend/backend/application/oplog/repo/oplog/entity.go",
        "code_start_line": 29,
        "code_end_line": 37,
        "code_key": "UserOperationLogs",
        "code_value": "type UserOperationLogs struct {\n\tID           int64     `gorm:\"column:id;bigint;autoIncrement\" json:\"id\"`\n\tUserID       int64     `gorm:\"column:user_id;bigint\" json:\"user_id\"`\n\tOperateOn    time.Time `gorm:\"column:operate_on;timestamp;\" json:\"operate_on\"`               //操作时间\n\tUin          int64     `gorm:\"column:uin;bigint\" json:\"uin\"`                                 //操作帐号UIN\n\tRealClientIP int64     `gorm:\"column:real_client_ip;bigint\" json:\"real_client_ip\"`           //客户IP\n\tContent      string    `gorm:\"column:content;varchar\" json:\"content\"`                        //操作内容\n\tCreatedAt    time.Time `gorm:\"column:created_at;timestamp;autoCreateTime\" json:\"created_at\"` //创建时间\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "2c9bc9914615f326b709cc019502dda7730f6f91"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/gorm_orm_code/dnspod__dnspod_backend.json",
    "matched_keywords": [
      "Scopes"
    ]
  },
  {
    "function_name": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/dnspod__dnspod_backend/backend/application/oplog/repo/oplog/oplog.go:40:43:AddUserOpLog",
    "orm_code": "func (db *opLogImpl) AddUserOpLog(ctx context.Context, l *UserOperationLogs, suffix int64) error {\n\tresult := db.Scopes(UserOpLogTable(suffix)).Create(l)\n\treturn result.Error\n}",
    "caller": "func (d *UserImpl) AddLog(ctx context.Context, value []byte) error {\n\tv := &userOpLog{}\n\terr := json.Unmarshal(value, v)\n\tif err != nil {\n\t\treturn errors.New(\"[userDomainLog] json unmarshal failed, error:\" + err.Error() + \", value:\" + string(value))\n\t}\n\tOperateOn, err := time.Parse(\"2006-01-02 15:04:05\", v.OperateOn)\n\tif err != nil {\n\t\treturn errors.New(\"[userDomainLog] operateOn is not Time format, error:\" + err.Error() + \", operateOn:\" + v.OperateOn)\n\t}\n\t//d := l.(*domainOpLog)\n\tl := &oplog.UserOperationLogs{\n\t\tUserID:       v.UserID,\n\t\tOperateOn:    OperateOn,\n\t\tUin:          v.Uin,\n\t\tRealClientIP: v.RealClientIP,\n\t\tContent:      v.Content,\n\t}\n\tsuffix := v.UserID % tableCount\n\n\toplog.NewOpLogImpl().AddUserOpLog(ctx, l, suffix)\n\treturn nil\n}",
    "sql_statement_list": [
      "INSERT INTO user_operation_logs (user_id, operate_on, uin, real_client_ip, content, created_at) VALUES (?, ?, ?, ?, ?, ?);"
    ],
    "sql_types": [
      "INSERT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/dnspod__dnspod_backend/backend/application/oplog/repo/oplog/entity.go",
        "code_start_line": 29,
        "code_end_line": 37,
        "code_key": "UserOperationLogs",
        "code_value": "type UserOperationLogs struct {\n\tID           int64     `gorm:\"column:id;bigint;autoIncrement\" json:\"id\"`\n\tUserID       int64     `gorm:\"column:user_id;bigint\" json:\"user_id\"`\n\tOperateOn    time.Time `gorm:\"column:operate_on;timestamp;\" json:\"operate_on\"`               //操作时间\n\tUin          int64     `gorm:\"column:uin;bigint\" json:\"uin\"`                                 //操作帐号UIN\n\tRealClientIP int64     `gorm:\"column:real_client_ip;bigint\" json:\"real_client_ip\"`           //客户IP\n\tContent      string    `gorm:\"column:content;varchar\" json:\"content\"`                        //操作内容\n\tCreatedAt    time.Time `gorm:\"column:created_at;timestamp;autoCreateTime\" json:\"created_at\"` //创建时间\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "2c9bc9914615f326b709cc019502dda7730f6f91"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/gorm_orm_code/dnspod__dnspod_backend.json",
    "matched_keywords": [
      "Scopes"
    ]
  },
  {
    "function_name": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/dnspod__dnspod_backend/backend/application/oplog/repo/oplog/oplog.go:40:43:AddUserOpLog",
    "orm_code": "func (db *opLogImpl) AddUserOpLog(ctx context.Context, l *UserOperationLogs, suffix int64) error {\n\tresult := db.Scopes(UserOpLogTable(suffix)).Create(l)\n\treturn result.Error\n}",
    "caller": "func (d *DomainRemoveImpl) AddLog(ctx context.Context, value []byte) error {\n\tv := &domainRemoveLog{}\n\terr := json.Unmarshal(value, v)\n\tif err != nil {\n\t\treturn errors.New(\"[domainRemoveLog] json unmarshal failed, error:\" + err.Error() + \", value:\" + string(value))\n\t}\n\tOperateOn, err := time.Parse(\"2006-01-02 15:04:05\", v.OperateOn)\n\tif err != nil {\n\t\treturn errors.New(\"[domainRemoveLog] operateOn is not Time format, error:\" + err.Error() + \", operateOn:\" + v.OperateOn)\n\t}\n\t//d := l.(*domainOpLog)\n\tl := &oplog.DomainRemoveLogs{\n\t\tDomainID:     v.DomainID,\n\t\tDomain:       v.Domain,\n\t\tOperateOn:    OperateOn,\n\t\tOperator:     v.Operator,\n\t\tRealClientIP: v.RealClientIP,\n\t\tContent:      v.Content,\n\t}\n\n\toplog.NewOpLogImpl().AddDomainRemoveLog(ctx, l)\n\treturn nil\n}",
    "sql_statement_list": [],
    "sql_types": [],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/dnspod__dnspod_backend/backend/application/oplog/repo/oplog/entity.go",
        "code_start_line": 29,
        "code_end_line": 37,
        "code_key": "UserOperationLogs",
        "code_value": "type UserOperationLogs struct {\n\tID           int64     `gorm:\"column:id;bigint;autoIncrement\" json:\"id\"`\n\tUserID       int64     `gorm:\"column:user_id;bigint\" json:\"user_id\"`\n\tOperateOn    time.Time `gorm:\"column:operate_on;timestamp;\" json:\"operate_on\"`               //操作时间\n\tUin          int64     `gorm:\"column:uin;bigint\" json:\"uin\"`                                 //操作帐号UIN\n\tRealClientIP int64     `gorm:\"column:real_client_ip;bigint\" json:\"real_client_ip\"`           //客户IP\n\tContent      string    `gorm:\"column:content;varchar\" json:\"content\"`                        //操作内容\n\tCreatedAt    time.Time `gorm:\"column:created_at;timestamp;autoCreateTime\" json:\"created_at\"` //创建时间\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "2c9bc9914615f326b709cc019502dda7730f6f91"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/gorm_orm_code/dnspod__dnspod_backend.json",
    "matched_keywords": [
      "Scopes"
    ]
  },
  {
    "function_name": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/dnspod__dnspod_backend/backend/application/oplog/repo/oplog/oplog.go:35:38:BatchAddDomainOpLog",
    "orm_code": "func (db *opLogImpl) BatchAddDomainOpLog(ctx context.Context, l *[]DomainOperationLogs, suffix int64) error {\n\tresult := db.Scopes(DomainOpLogTable(suffix)).Create(l)\n\treturn result.Error\n}",
    "caller": "",
    "sql_statement_list": [
      {
        "type": "param_dependent",
        "variants": [
          {
            "scenario": "批量插入单条记录",
            "sql": "INSERT INTO `domain_operation_logs_123` (`domain_id`,`operate_on`,`uin`,`real_client_ip`,`content`,`created_at`) VALUES (?,?,?,?,?,?);"
          },
          {
            "scenario": "批量插入多条记录",
            "sql": "INSERT INTO `domain_operation_logs_123` (`domain_id`,`operate_on`,`uin`,`real_client_ip`,`content`,`created_at`) VALUES (?,?,?,?,?,?),(?,?,?,?,?,?),(?,?,?,?,?,?);"
          }
        ]
      }
    ],
    "sql_types": [
      "PARAM_DEPENDENT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/dnspod__dnspod_backend/backend/application/oplog/repo/oplog/entity.go",
        "code_start_line": 10,
        "code_end_line": 18,
        "code_key": "DomainOperationLogs",
        "code_value": "type DomainOperationLogs struct {\n\tID           int64     `gorm:\"column:id;bigint;autoIncrement\" json:\"id\"`\n\tDomainID     int64     `gorm:\"column:domain_id;bigint\" json:\"domain_id\"`\n\tOperateOn    time.Time `gorm:\"column:operate_on;timestamp;\" json:\"operate_on\"`               //操作时间\n\tUin          int64     `gorm:\"column:uin;bigint\" json:\"uin\"`                                 //操作帐号UIN\n\tRealClientIP int64     `gorm:\"column:real_client_ip;bigint\" json:\"real_client_ip\"`           //客户IP\n\tContent      string    `gorm:\"column:content;varchar\" json:\"content\"`                        //操作内容\n\tCreatedAt    time.Time `gorm:\"column:created_at;timestamp;autoCreateTime\" json:\"created_at\"` //创建时间\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "2c9bc9914615f326b709cc019502dda7730f6f91"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/gorm_orm_code/dnspod__dnspod_backend.json",
    "matched_keywords": [
      "Scopes"
    ]
  },
  {
    "function_name": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/dnspod__dnspod_backend/backend/application/oplog/repo/oplog/oplog.go:45:48:BatchAddUserOpLog",
    "orm_code": "func (db *opLogImpl) BatchAddUserOpLog(ctx context.Context, l *[]UserOperationLogs, suffix int64) error {\n\tresult := db.Scopes(UserOpLogTable(suffix)).Create(l)\n\treturn result.Error\n}",
    "caller": "",
    "sql_statement_list": [
      {
        "type": "param_dependent",
        "variants": [
          {
            "scenario": "动态表名插入用户操作日志",
            "sql": "INSERT INTO `user_operation_logs_${suffix}` (`user_id`,`operate_on`,`uin`,`real_client_ip`,`content`,`created_at`) VALUES (?,?,?,?,?,?);"
          }
        ]
      }
    ],
    "sql_types": [
      "PARAM_DEPENDENT"
    ],
    "code_meta_data": [
      {
        "code_file": "/Users/ymhuan/code/git-development/aid-main/aid/risk_sql/code/scripts/dnspod__dnspod_backend/backend/application/oplog/repo/oplog/entity.go",
        "code_start_line": 29,
        "code_end_line": 37,
        "code_key": "UserOperationLogs",
        "code_value": "type UserOperationLogs struct {\n\tID           int64     `gorm:\"column:id;bigint;autoIncrement\" json:\"id\"`\n\tUserID       int64     `gorm:\"column:user_id;bigint\" json:\"user_id\"`\n\tOperateOn    time.Time `gorm:\"column:operate_on;timestamp;\" json:\"operate_on\"`               //操作时间\n\tUin          int64     `gorm:\"column:uin;bigint\" json:\"uin\"`                                 //操作帐号UIN\n\tRealClientIP int64     `gorm:\"column:real_client_ip;bigint\" json:\"real_client_ip\"`           //客户IP\n\tContent      string    `gorm:\"column:content;varchar\" json:\"content\"`                        //操作内容\n\tCreatedAt    time.Time `gorm:\"column:created_at;timestamp;autoCreateTime\" json:\"created_at\"` //创建时间\n}",
        "code_label": 3,
        "code_type": 3,
        "code_version": "2c9bc9914615f326b709cc019502dda7730f6f91"
      }
    ],
    "sql_pattern_cnt": 1,
    "source_file": "/data/shawn/venus_api/orm2sql/gorm_orm_code/dnspod__dnspod_backend.json",
    "matched_keywords": [
      "Scopes"
    ]
  }
]